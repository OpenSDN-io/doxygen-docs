<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenSDN source code: sandesh_session.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenSDN source code
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('de/db4/sandesh__session_8cc_source.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">sandesh_session.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../de/db4/sandesh__session_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (c) 2013 Juniper Networks, Inc. All rights reserved.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// sandesh_session.cc</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// Sandesh session</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;boost/bind.hpp&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;boost/assign.hpp&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;boost/algorithm/string.hpp&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="../../d1/d66/parse__object_8h.html">base/parse_object.h</a>&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;sandesh/common/vns_types.h&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;sandesh/common/vns_constants.h&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;sandesh/transport/TBufferTransports.h&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;sandesh/protocol/TXMLProtocol.h&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;sandesh/protocol/TJSONProtocol.h&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;sandesh/sandesh_types.h&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;sandesh/sandesh.h&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/dfa/sandesh__connection_8h.html">sandesh_connection.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d85/sandesh__session_8h.html">sandesh_session.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../d8/dcc/namespacestd.html">std</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../dc/dde/namespacecontrail_1_1sandesh_1_1protocol.html">contrail::sandesh::protocol</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../d4/dbb/namespacecontrail_1_1sandesh_1_1transport.html">contrail::sandesh::transport</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">using</span> boost::asio::mutable_buffer;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">using</span> boost::asio::buffer_cast;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">const</span> std::string <a class="code" href="../../d0/d8f/classSandeshWriter.html#a10b5d73b7957933c5088204b8a83fd45">SandeshWriter::sandesh_open_</a> = <a class="code" href="../../d2/d85/sandesh__session_8h.html#a5ab26593b785e6449896608d5f49466c">sXML_SANDESH_OPEN</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">const</span> std::string <a class="code" href="../../d0/d8f/classSandeshWriter.html#af94d2aac87c3a58d0f5a1de383caa293">SandeshWriter::sandesh_open_attr_length_</a> =</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="../../d2/d85/sandesh__session_8h.html#aedbbe920e334e4ed8e07a3f24b7a3938">sXML_SANDESH_OPEN_ATTR_LENGTH</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">const</span> std::string <a class="code" href="../../d0/d8f/classSandeshWriter.html#abba63b1efaaef5af5f2353d49b329a31">SandeshWriter::sandesh_close_</a> = <a class="code" href="../../d2/d85/sandesh__session_8h.html#ab31bc165aaad01f2a44070b97e083f71">sXML_SANDESH_CLOSE</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// SandeshWriter</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="../../d0/d8f/classSandeshWriter.html#a6466a57d1dc5520523d04aaf5616a365">   44</a></span>&#160;<a class="code" href="../../d0/d8f/classSandeshWriter.html#a6466a57d1dc5520523d04aaf5616a365">SandeshWriter::SandeshWriter</a>(<a class="code" href="../../d1/dfd/classSandeshSession.html">SandeshSession</a> *session)</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    : session_(session),</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    ready_to_send_(true),</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    send_buf_(new uint8_t[kDefaultSendSize]),</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    send_buf_offset_(0) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="../../d0/d8f/classSandeshWriter.html#a3af5002a2ca2312452a672f09f32e4ca">   51</a></span>&#160;<a class="code" href="../../d0/d8f/classSandeshWriter.html#a3af5002a2ca2312452a672f09f32e4ca">SandeshWriter::~SandeshWriter</a>() {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keyword">delete</span> [] <a class="code" href="../../d0/d8f/classSandeshWriter.html#ae1de346b909b944015d83fdd0eaa5859">send_buf_</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="../../d0/d8f/classSandeshWriter.html#a661f9f5117cf1d800860dfb71d3d2c4b">   55</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d8f/classSandeshWriter.html#a661f9f5117cf1d800860dfb71d3d2c4b">SandeshWriter::WriteReady</a>(<span class="keyword">const</span> boost::system::error_code &amp;ec) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (ec) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <a class="code" href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a>(ERROR, <span class="stringliteral">&quot;SandeshSession Write error value: &quot;</span> &lt;&lt; ec.value()</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; category: &quot;</span> &lt;&lt; ec.category().name()</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; message: &quot;</span> &lt;&lt; ec.message());</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="../../d0/d8f/classSandeshWriter.html#a87ec724c716203971fdd6d4e0d711ba5">session_</a>-&gt;<a class="code" href="../../d1/dfd/classSandeshSession.html#a3a87471a603c88d30a7f805a680c0a21">increment_write_ready_cb_error</a>();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        tbb::mutex::scoped_lock lock(<a class="code" href="../../d0/d8f/classSandeshWriter.html#a4eeff7bd464a750ede91a921f7dc8cf5">send_mutex_</a>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="../../d0/d8f/classSandeshWriter.html#a254bae36474a74a508f242f57483ae30">ready_to_send_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// We may want to start the Runner for the send_queue</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="../../d0/d8f/classSandeshWriter.html#a87ec724c716203971fdd6d4e0d711ba5">session_</a>-&gt;<a class="code" href="../../d1/dfd/classSandeshSession.html#aad7309ebbbc4ab1f16ee4fecfd489652">send_queue</a>()-&gt;<a class="code" href="../../d4/d0c/classWorkQueue.html#af732cae3f686d952b71def5b5771ea9e">MayBeStartRunner</a>();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;}</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="../../d0/d8f/classSandeshWriter.html#a571e16e09b7667e345cf10a221fb31c0">   73</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d8f/classSandeshWriter.html#a571e16e09b7667e345cf10a221fb31c0">SandeshWriter::SendMsg</a>(<a class="code" href="../../de/d75/classSandesh.html">Sandesh</a> *<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>, <span class="keywordtype">bool</span> more) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    SandeshHeader header;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    uint8_t *buffer;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    int32_t xfer = 0, ret;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    uint32_t offset;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    boost::shared_ptr&lt;TMemoryBuffer&gt; btrans(</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    <span class="keyword">new</span> <a class="code" href="../../d9/d10/classcontrail_1_1sandesh_1_1transport_1_1TMemoryBuffer.html">TMemoryBuffer</a>(<a class="code" href="../../d0/d8f/classSandeshWriter.html#aa62d0e8304a43b28c6626619555faabb">kEncodeBufferSize</a>));</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    boost::shared_ptr&lt;TXMLProtocol&gt; prot(</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                    <span class="keyword">new</span> <a class="code" href="../../de/d75/classcontrail_1_1sandesh_1_1protocol_1_1TXMLProtocol.html">TXMLProtocol</a>(btrans));</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// Populate the header</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    header.set_Namespace(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;scope());</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    header.set_Timestamp(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;timestamp());</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    header.set_Module(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;module());</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    header.set_Source(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;source());</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    header.set_Context(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;context());</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    header.set_SequenceNum(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;seqnum());</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    header.set_VersionSig(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;versionsig());</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    header.set_Type(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;type());</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    header.set_Hints(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;hints());</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    header.set_Level(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;level());</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    header.set_Category(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;category());</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    header.set_NodeType(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;node_type());</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    header.set_InstanceId(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;instance_id());</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// Write the sandesh open envelope.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    buffer = btrans-&gt;getWritePtr(<a class="code" href="../../d0/d8f/classSandeshWriter.html#a10b5d73b7957933c5088204b8a83fd45">sandesh_open_</a>.length());</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    memcpy(buffer, <a class="code" href="../../d0/d8f/classSandeshWriter.html#a10b5d73b7957933c5088204b8a83fd45">sandesh_open_</a>.c_str(), <a class="code" href="../../d0/d8f/classSandeshWriter.html#a10b5d73b7957933c5088204b8a83fd45">sandesh_open_</a>.length());</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    btrans-&gt;wroteBytes(<a class="code" href="../../d0/d8f/classSandeshWriter.html#a10b5d73b7957933c5088204b8a83fd45">sandesh_open_</a>.length());</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// Write the sandesh header</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> ((ret = header.write(prot)) &lt; 0) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a>(ERROR, __func__ &lt;&lt; <span class="stringliteral">&quot;: Sandesh header write FAILED: &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;Name() &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;source() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;module() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;instance_id() &lt;&lt;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="stringliteral">&quot; Sequence Number:&quot;</span> &lt;&lt; <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;seqnum());</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="../../d0/d8f/classSandeshWriter.html#a87ec724c716203971fdd6d4e0d711ba5">session_</a>-&gt;<a class="code" href="../../d1/dfd/classSandeshSession.html#aaa9ffe0db354351aa404d43c02597fce">increment_send_msg_fail</a>();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="../../de/d75/classSandesh.html#a0d9dd4649dcc88784f7f7e57247a0a4e">Sandesh::UpdateTxMsgFailStats</a>(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;Name(), 0,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            SandeshTxDropReason::HeaderWriteFailed);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;Release();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    xfer += ret;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// Write the sandesh</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">if</span> ((ret = <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;Write(prot)) &lt; 0) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <a class="code" href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a>(ERROR, __func__ &lt;&lt; <span class="stringliteral">&quot;: Sandesh write FAILED: &quot;</span>&lt;&lt;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;Name() &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;source() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;module() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;instance_id() &lt;&lt;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="stringliteral">&quot; Sequence Number:&quot;</span> &lt;&lt; <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;seqnum());</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <a class="code" href="../../d0/d8f/classSandeshWriter.html#a87ec724c716203971fdd6d4e0d711ba5">session_</a>-&gt;<a class="code" href="../../d1/dfd/classSandeshSession.html#aaa9ffe0db354351aa404d43c02597fce">increment_send_msg_fail</a>();</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <a class="code" href="../../de/d75/classSandesh.html#a0d9dd4649dcc88784f7f7e57247a0a4e">Sandesh::UpdateTxMsgFailStats</a>(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;Name(), 0,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            SandeshTxDropReason::WriteFailed);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;Release();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    xfer += ret;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// Write the sandesh close envelope</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    buffer = btrans-&gt;getWritePtr(<a class="code" href="../../d0/d8f/classSandeshWriter.html#abba63b1efaaef5af5f2353d49b329a31">sandesh_close_</a>.length());</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    memcpy(buffer, <a class="code" href="../../d0/d8f/classSandeshWriter.html#abba63b1efaaef5af5f2353d49b329a31">sandesh_close_</a>.c_str(), <a class="code" href="../../d0/d8f/classSandeshWriter.html#abba63b1efaaef5af5f2353d49b329a31">sandesh_close_</a>.length());</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    btrans-&gt;wroteBytes(<a class="code" href="../../d0/d8f/classSandeshWriter.html#abba63b1efaaef5af5f2353d49b329a31">sandesh_close_</a>.length());</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// Get the buffer</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    btrans-&gt;getBuffer(&amp;buffer, &amp;offset);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// Sanity</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    assert(<a class="code" href="../../d0/d8f/classSandeshWriter.html#a10b5d73b7957933c5088204b8a83fd45">sandesh_open_</a>.length() + xfer + <a class="code" href="../../d0/d8f/classSandeshWriter.html#abba63b1efaaef5af5f2353d49b329a31">sandesh_close_</a>.length() ==</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            offset);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// Update the sandesh open envelope length;</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">char</span> prev = ss.fill(<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// Adjust for &#39;&quot;&gt;&#39;</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    ss.width(<a class="code" href="../../d0/d8f/classSandeshWriter.html#a10b5d73b7957933c5088204b8a83fd45">sandesh_open_</a>.length() - <a class="code" href="../../d0/d8f/classSandeshWriter.html#af94d2aac87c3a58d0f5a1de383caa293">sandesh_open_attr_length_</a>.length() - 2);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    ss &lt;&lt; offset;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    ss.fill(prev);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    memcpy(buffer + <a class="code" href="../../d0/d8f/classSandeshWriter.html#af94d2aac87c3a58d0f5a1de383caa293">sandesh_open_attr_length_</a>.length(), ss.str().c_str(),</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            ss.str().length());</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// Update sandesh stats</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="../../de/d75/classSandesh.html#a58e35aa0cc5c3d705b19ab8388ddcacf">Sandesh::UpdateTxMsgStats</a>(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;Name(), offset);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="../../d0/d8f/classSandeshWriter.html#a87ec724c716203971fdd6d4e0d711ba5">session_</a>-&gt;<a class="code" href="../../d1/dfd/classSandeshSession.html#ad962e2f7d5d3be9756f38fdefc17976f">increment_send_msg</a>();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8f/classSandeshWriter.html#adc4b6d55b5da0cab860acca9319b0fab">send_buf</a>()) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">if</span> (more) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="comment">// There are more messages in the send_queue_.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="comment">// Try to package as many sandesh messages as possible</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="comment">// (== kEncodeBufferSize) before transporting to the</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="comment">// receiver.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <a class="code" href="../../d0/d8f/classSandeshWriter.html#abf21e13dcb2f5e220beb599c17b565ad">SendMsgMore</a>(btrans);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="comment">// send_queue_ is empty. Flush sandesh-&gt;send_buf_ and this message.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <a class="code" href="../../d0/d8f/classSandeshWriter.html#abc2811f33401937c2902a24eee8f1995">SendMsgAll</a>(btrans);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="comment">// Send the message</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <a class="code" href="../../d0/d8f/classSandeshWriter.html#a70ebb48baaac20b81570507e38684c47">SendInternal</a>(btrans);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;Release();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;}</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">// Package as many sandesh messages as possible [not more than</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">// kEncodeBufferSize] before transporting it to the receiver.</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">// send_buf_ =&gt; unsent data (partial/complete message).</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">// buf =&gt; new message</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">// buf_len =&gt; buf&#39;s len</span></div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="../../d0/d8f/classSandeshWriter.html#abf21e13dcb2f5e220beb599c17b565ad">  174</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d8f/classSandeshWriter.html#abf21e13dcb2f5e220beb599c17b565ad">SandeshWriter::SendMsgMore</a>(boost::shared_ptr&lt;TMemoryBuffer&gt;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                                            send_buffer) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    uint8_t *buf;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    uint32_t buf_len;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    send_buffer-&gt;getBuffer(&amp;buf, &amp;buf_len);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8f/classSandeshWriter.html#a749abee764012bb594fd84343ca4f452">send_buf_offset</a>()) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="comment">// We have some unsent data.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordtype">size_t</span> bulk_msg_len = <a class="code" href="../../d0/d8f/classSandeshWriter.html#a749abee764012bb594fd84343ca4f452">send_buf_offset</a>() + buf_len;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">if</span> (bulk_msg_len &lt; <a class="code" href="../../d0/d8f/classSandeshWriter.html#a5574290db5e5cc8d082a6fe1f1783cf5">kDefaultSendSize</a>) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="comment">// We still have space for more data. Don&#39;t send the message yet.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="comment">// Add the message to the existing data.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <a class="code" href="../../d0/d8f/classSandeshWriter.html#a49ceac02ceec6b9e16d2bec4db937cd8">append_send_buf</a>(buf, buf_len);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            uint8_t *buffer;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="comment">// (send_buf_offset() + buf_len) &gt;= kDefaultSendSize</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            boost::shared_ptr&lt;TMemoryBuffer&gt; bulk_msg(</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                    <span class="keyword">new</span> <a class="code" href="../../d9/d10/classcontrail_1_1sandesh_1_1transport_1_1TMemoryBuffer.html">TMemoryBuffer</a>(<a class="code" href="../../d0/d8f/classSandeshWriter.html#a749abee764012bb594fd84343ca4f452">send_buf_offset</a>()));</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            buffer = bulk_msg-&gt;getWritePtr(<a class="code" href="../../d0/d8f/classSandeshWriter.html#a749abee764012bb594fd84343ca4f452">send_buf_offset</a>());</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="comment">// Copy unsent data</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            memcpy(buffer, <a class="code" href="../../d0/d8f/classSandeshWriter.html#adc4b6d55b5da0cab860acca9319b0fab">send_buf</a>(), <a class="code" href="../../d0/d8f/classSandeshWriter.html#a749abee764012bb594fd84343ca4f452">send_buf_offset</a>());</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            bulk_msg-&gt;wroteBytes(<a class="code" href="../../d0/d8f/classSandeshWriter.html#a749abee764012bb594fd84343ca4f452">send_buf_offset</a>());</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="comment">// Send it</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <a class="code" href="../../d0/d8f/classSandeshWriter.html#a70ebb48baaac20b81570507e38684c47">SendInternal</a>(bulk_msg);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="comment">// Cleanup send_buf</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <a class="code" href="../../d0/d8f/classSandeshWriter.html#a6edb3847946749d4cb95aa6e404fe6dc">reset_send_buf</a>();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="comment">// Next send the new message</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <a class="code" href="../../d0/d8f/classSandeshWriter.html#a70ebb48baaac20b81570507e38684c47">SendInternal</a>(send_buffer);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="comment">// We don&#39;t have any unsent data.</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">if</span> (buf_len &gt;= <a class="code" href="../../d0/d8f/classSandeshWriter.html#a5574290db5e5cc8d082a6fe1f1783cf5">kDefaultSendSize</a>) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="comment">// We don&#39;t have room to accommodate anything more.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="comment">// Send the message now.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <a class="code" href="../../d0/d8f/classSandeshWriter.html#a70ebb48baaac20b81570507e38684c47">SendInternal</a>(send_buffer);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="comment">// We have room to accommodate more data.</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="comment">// Save this message.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="comment">// Note: The memcpy here can be avoided by passing send_buf_</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="comment">// to TMemoryBuffer so that the message is encoded in</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="comment">// send_buf_ itself.</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <a class="code" href="../../d0/d8f/classSandeshWriter.html#a9d64f820713dc01cd9cca39330fb2311">set_send_buf</a>(buf, buf_len);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">// sandesh-&gt;send_queue_ is empty.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">// Flush unsent data (if any) and this message.</span></div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="../../d0/d8f/classSandeshWriter.html#abc2811f33401937c2902a24eee8f1995">  223</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d8f/classSandeshWriter.html#abc2811f33401937c2902a24eee8f1995">SandeshWriter::SendMsgAll</a>(boost::shared_ptr&lt;TMemoryBuffer&gt; send_buffer) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    uint8_t *buf;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    uint32_t buf_len;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    send_buffer-&gt;getBuffer(&amp;buf, &amp;buf_len);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8f/classSandeshWriter.html#a749abee764012bb594fd84343ca4f452">send_buf_offset</a>()) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="comment">// We have some unsent data.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordtype">size_t</span> bulk_msg_len = <a class="code" href="../../d0/d8f/classSandeshWriter.html#a749abee764012bb594fd84343ca4f452">send_buf_offset</a>() + buf_len;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">if</span> (bulk_msg_len &lt;= <a class="code" href="../../d0/d8f/classSandeshWriter.html#a5574290db5e5cc8d082a6fe1f1783cf5">kDefaultSendSize</a>) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            uint8_t *buffer;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="comment">// We have enough room to send all the pending data in one message.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            boost::shared_ptr&lt;TMemoryBuffer&gt; bulk_msg(<span class="keyword">new</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                    <a class="code" href="../../d9/d10/classcontrail_1_1sandesh_1_1transport_1_1TMemoryBuffer.html">TMemoryBuffer</a>(bulk_msg_len));</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            buffer = bulk_msg-&gt;getWritePtr(bulk_msg_len);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            memcpy(buffer, <a class="code" href="../../d0/d8f/classSandeshWriter.html#adc4b6d55b5da0cab860acca9319b0fab">send_buf</a>(), <a class="code" href="../../d0/d8f/classSandeshWriter.html#a749abee764012bb594fd84343ca4f452">send_buf_offset</a>());</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            memcpy(buffer + <a class="code" href="../../d0/d8f/classSandeshWriter.html#a749abee764012bb594fd84343ca4f452">send_buf_offset</a>(), buf, buf_len);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            bulk_msg-&gt;wroteBytes(bulk_msg_len);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="comment">// send the message</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <a class="code" href="../../d0/d8f/classSandeshWriter.html#a70ebb48baaac20b81570507e38684c47">SendInternal</a>(bulk_msg);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="comment">// reset send_buf_</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <a class="code" href="../../d0/d8f/classSandeshWriter.html#a6edb3847946749d4cb95aa6e404fe6dc">reset_send_buf</a>();</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            uint8_t *buffer;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="comment">// We don&#39;t have enough space to accommodate all the</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="comment">// pending data in one message.</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            boost::shared_ptr&lt;TMemoryBuffer&gt; old_buf(<span class="keyword">new</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    <a class="code" href="../../d9/d10/classcontrail_1_1sandesh_1_1transport_1_1TMemoryBuffer.html">TMemoryBuffer</a>(<a class="code" href="../../d0/d8f/classSandeshWriter.html#a749abee764012bb594fd84343ca4f452">send_buf_offset</a>()));</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            buffer = old_buf-&gt;getWritePtr(<a class="code" href="../../d0/d8f/classSandeshWriter.html#a749abee764012bb594fd84343ca4f452">send_buf_offset</a>());</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            memcpy(buffer, <a class="code" href="../../d0/d8f/classSandeshWriter.html#adc4b6d55b5da0cab860acca9319b0fab">send_buf</a>(),</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                   <a class="code" href="../../d0/d8f/classSandeshWriter.html#a749abee764012bb594fd84343ca4f452">send_buf_offset</a>());</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            old_buf-&gt;wroteBytes(<a class="code" href="../../d0/d8f/classSandeshWriter.html#a749abee764012bb594fd84343ca4f452">send_buf_offset</a>());</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="comment">// Take care of the unsent data in send_buf_ first.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="comment">// Note that we could have accomodated part of buf [last message]</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="comment">// here. But, not doing so to avoid additional memcpy() :)</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <a class="code" href="../../d0/d8f/classSandeshWriter.html#a70ebb48baaac20b81570507e38684c47">SendInternal</a>(old_buf);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="comment">// Cleanup send_buf_</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <a class="code" href="../../d0/d8f/classSandeshWriter.html#a6edb3847946749d4cb95aa6e404fe6dc">reset_send_buf</a>();</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="comment">// Well, send the last message now.</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <a class="code" href="../../d0/d8f/classSandeshWriter.html#a70ebb48baaac20b81570507e38684c47">SendInternal</a>(send_buffer);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="comment">// No unsent data. Send the message now.</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="../../d0/d8f/classSandeshWriter.html#a70ebb48baaac20b81570507e38684c47">SendInternal</a>(send_buffer);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="../../d0/d8f/classSandeshWriter.html#a70ebb48baaac20b81570507e38684c47">  270</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d0/d8f/classSandeshWriter.html#a70ebb48baaac20b81570507e38684c47">SandeshWriter::SendInternal</a>(boost::shared_ptr&lt;TMemoryBuffer&gt; buf) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    uint8_t  *buffer;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    uint32_t len;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    buf-&gt;getBuffer(&amp;buffer, &amp;len);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    tbb::mutex::scoped_lock lock(<a class="code" href="../../d0/d8f/classSandeshWriter.html#a4eeff7bd464a750ede91a921f7dc8cf5">send_mutex_</a>);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="../../d0/d8f/classSandeshWriter.html#a254bae36474a74a508f242f57483ae30">ready_to_send_</a> = <a class="code" href="../../d0/d8f/classSandeshWriter.html#a87ec724c716203971fdd6d4e0d711ba5">session_</a>-&gt;<a class="code" href="../../d2/d0e/classTcpSession.html#af181c9d6048155cb94ab3a605b56a574">Send</a>((<span class="keyword">const</span> uint8_t *)buffer, len, NULL);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">// SandeshSession</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="../../d1/dfd/classSandeshSession.html#a39c3cecd3632b664b8e8185b86cf32b8">  281</a></span>&#160;<a class="code" href="../../d1/dfd/classSandeshSession.html#a39c3cecd3632b664b8e8185b86cf32b8">SandeshSession::SandeshSession</a>(<a class="code" href="../../d8/d4d/classSslServer.html">SslServer</a> *client, <a class="code" href="../../db/dda/classSslSession.html#a3eea16bfb02a5a918d97480928c14e37">SslSocket</a> *socket,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordtype">int</span> task_instance, <span class="keywordtype">int</span> writer_task_id, <span class="keywordtype">int</span> reader_task_id) :</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="../../db/dda/classSslSession.html">SslSession</a>(client, socket),</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    instance_(task_instance),</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    writer_(new <a class="code" href="../../d0/d8f/classSandeshWriter.html">SandeshWriter</a>(this)),</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    reader_(new <a class="code" href="../../d9/d64/classSandeshReader.html">SandeshReader</a>(this)),</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    send_queue_(new <a class="code" href="../../de/d75/classSandesh.html">Sandesh</a>::SandeshQueue(writer_task_id,</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            task_instance,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <a class="code" href="../../d4/da9/namespaceboost.html">boost</a>::bind(&amp;<a class="code" href="../../d1/dfd/classSandeshSession.html">SandeshSession</a>::SendMsg, this, _1),</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            kQueueSize)),</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    stats_client_(NULL),</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    connection_(NULL),</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    keepalive_idle_time_(kSessionKeepaliveIdleTime),</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    keepalive_interval_(kSessionKeepaliveInterval),</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    keepalive_probes_(kSessionKeepaliveProbes),</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    tcp_user_timeout_(kSessionTcpUserTimeout),</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    reader_task_id_(reader_task_id),</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    sending_level_(SandeshLevel::<a class="code" href="../../d5/d87/globals_8h.html#af8f69ad2e0771a513d2eb7d5198b2a8caef2863a469df3ea6871d640e3669a2f2">INVALID</a>) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/d75/classSandesh.html#a2cf8b26e16c308947dbde45f18fbf78f">Sandesh::role</a>() == <a class="code" href="../../d5/de1/structSandesh_1_1SandeshRole.html#a7319897fe11feb7022a5cacb6e4a6c0bacb542b0faa8bae9b8d3d29461ffa21a6">Sandesh::SandeshRole::Collector</a>) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <a class="code" href="../../d1/dfd/classSandeshSession.html#ae687f79d2022cba9fe2b0195dc1cb25d">send_buffer_queue_</a>.reset(<span class="keyword">new</span> <a class="code" href="../../d4/d0c/classWorkQueue.html">Sandesh::SandeshBufferQueue</a>(writer_task_id,</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                task_instance,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                boost::bind(&amp;<a class="code" href="../../d1/dfd/classSandeshSession.html#a7e7c2d2986a94f611c5cd61f62f75509">SandeshSession::SendBuffer</a>, <span class="keyword">this</span>, _1)));</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <a class="code" href="../../d1/dfd/classSandeshSession.html#ae687f79d2022cba9fe2b0195dc1cb25d">send_buffer_queue_</a>-&gt;SetStartRunnerFunc(boost::bind(&amp;<a class="code" href="../../d1/dfd/classSandeshSession.html#a8a8d9b00d1f1741e7464c8efbc1511cf">SandeshSession::SessionSendReady</a>, <span class="keyword">this</span>));</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="../../d1/dfd/classSandeshSession.html#ade321d28717e66cca824a34a5d1968af">send_queue_</a>-&gt;SetStartRunnerFunc(boost::bind(&amp;<a class="code" href="../../d1/dfd/classSandeshSession.html#a8a8d9b00d1f1741e7464c8efbc1511cf">SandeshSession::SessionSendReady</a>, <span class="keyword">this</span>));</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="../../d1/dfd/classSandeshSession.html#a28e5e52ee6f256c0e922f6af014985eb">  308</a></span>&#160;<a class="code" href="../../d1/dfd/classSandeshSession.html#a28e5e52ee6f256c0e922f6af014985eb">SandeshSession::~SandeshSession</a>() {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;}</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="../../d1/dfd/classSandeshSession.html#a8a8d9b00d1f1741e7464c8efbc1511cf">  311</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d1/dfd/classSandeshSession.html#a8a8d9b00d1f1741e7464c8efbc1511cf">SandeshSession::SessionSendReady</a>() {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="../../d2/d0e/classTcpSession.html#ac10803a7f7a8485c6f7e77e2b11abeed">IsEstablished</a>() &amp;&amp; <a class="code" href="../../d1/dfd/classSandeshSession.html#a7164b38c0a2a30455b841e031f37ed44">writer_</a>-&gt;SendReady() &amp;&amp;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <a class="code" href="../../de/d75/classSandesh.html#a62eb09258028ea227f5c0e28ef2ee8e2">Sandesh::IsSendQueueEnabled</a>());</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;}</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="../../d1/dfd/classSandeshSession.html#a730467dbd60a46dc652a3b464d21b26d">  316</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/dfd/classSandeshSession.html#a730467dbd60a46dc652a3b464d21b26d">SandeshSession::SetSendQueueWaterMark</a>(</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="../../de/d75/classSandesh.html#a39284670cf55f58c73630dad84a27612">Sandesh::QueueWaterMarkInfo</a> &amp;swmi) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="../../d2/dde/structWaterMarkInfo.html">WaterMarkInfo</a> wm(boost::get&lt;0&gt;(swmi),</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        boost::bind(&amp;<a class="code" href="../../d1/dfd/classSandeshSession.html#a8f156ce671c7966531c53c8a51aecb99">SandeshSession::SetSendingLevel</a>, <span class="keyword">this</span>, _1,</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            boost::get&lt;1&gt;(swmi)));</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span> (boost::get&lt;2&gt;(swmi)) {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <a class="code" href="../../d1/dfd/classSandeshSession.html#ade321d28717e66cca824a34a5d1968af">send_queue_</a>-&gt;SetHighWaterMark(wm);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <a class="code" href="../../d1/dfd/classSandeshSession.html#ade321d28717e66cca824a34a5d1968af">send_queue_</a>-&gt;SetLowWaterMark(wm);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;}</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="../../d1/dfd/classSandeshSession.html#aec9cdc677e4edda90fc5ecdf20cd9863">  328</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/dfd/classSandeshSession.html#aec9cdc677e4edda90fc5ecdf20cd9863">SandeshSession::ResetSendQueueWaterMark</a>() {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="../../d1/dfd/classSandeshSession.html#ade321d28717e66cca824a34a5d1968af">send_queue_</a>-&gt;ResetHighWaterMark();</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="../../d1/dfd/classSandeshSession.html#ade321d28717e66cca824a34a5d1968af">send_queue_</a>-&gt;ResetLowWaterMark();</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;}</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="../../d1/dfd/classSandeshSession.html#a8f156ce671c7966531c53c8a51aecb99">  333</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/dfd/classSandeshSession.html#a8f156ce671c7966531c53c8a51aecb99">SandeshSession::SetSendingLevel</a>(<span class="keywordtype">size_t</span> count, <a class="code" href="../../de/dcb/load__balance_8h.html#a1d127017fb298b889f4ba24752d08b8e">SandeshLevel::type</a> level) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/dfd/classSandeshSession.html#aac2d51b7140bd5363ba61466656f48b2">sending_level_</a> != level) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <a class="code" href="../../d1/dfd/classSandeshSession.html#aac2d51b7140bd5363ba61466656f48b2">sending_level_</a> = level;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;}</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="../../d1/dfd/classSandeshSession.html#ade3289929841c351c51a9774f4a98e1e">  339</a></span>&#160;<a class="code" href="../../de/dcb/load__balance_8h.html#a1d127017fb298b889f4ba24752d08b8e">SandeshLevel::type</a> <a class="code" href="../../d1/dfd/classSandeshSession.html#ade3289929841c351c51a9774f4a98e1e">SandeshSession::SendingLevel</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d1/dfd/classSandeshSession.html#aac2d51b7140bd5363ba61466656f48b2">sending_level_</a>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="../../d1/dfd/classSandeshSession.html#a6eaf0601d8b7c1f7778fb03b8bb19a4b">  343</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/dfd/classSandeshSession.html#a6eaf0601d8b7c1f7778fb03b8bb19a4b">SandeshSession::Shutdown</a>() {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/d75/classSandesh.html#a2cf8b26e16c308947dbde45f18fbf78f">Sandesh::role</a>() == <a class="code" href="../../d5/de1/structSandesh_1_1SandeshRole.html#a7319897fe11feb7022a5cacb6e4a6c0bacb542b0faa8bae9b8d3d29461ffa21a6">Sandesh::SandeshRole::Collector</a>) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <a class="code" href="../../d1/dfd/classSandeshSession.html#ae687f79d2022cba9fe2b0195dc1cb25d">send_buffer_queue_</a>-&gt;Shutdown();</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="../../d1/dfd/classSandeshSession.html#ade321d28717e66cca824a34a5d1968af">send_queue_</a>-&gt;Shutdown();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="../../d1/dfd/classSandeshSession.html#a0f53720c50517a99fb79c31649b53aa2">  350</a></span>&#160;std::string <a class="code" href="../../d1/dfd/classSandeshSession.html#a0f53720c50517a99fb79c31649b53aa2">SandeshSession::ToString</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    std::stringstream out;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    out &lt;&lt; <a class="code" href="../../d2/d0e/classTcpSession.html#a5ea3a03c6c4b4a506b8a3af46e3cb92e">TcpSession::ToString</a>() &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; <a class="code" href="../../d1/dfd/classSandeshSession.html#ae9568cabccd7fcd67166a98648a4d16e">instance_</a> &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">return</span> out.str();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;}</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="../../d1/dfd/classSandeshSession.html#a2d06bbd62576583c2b32dc60ef22ba23">  356</a></span>&#160;boost::system::error_code <a class="code" href="../../d1/dfd/classSandeshSession.html#a2d06bbd62576583c2b32dc60ef22ba23">SandeshSession::SetSocketOptions</a>() {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    boost::system::error_code ec = <a class="code" href="../../d2/d0e/classTcpSession.html#ad8740e4f810aa650f174fe6fb31c3e47">TcpSession::SetSocketOptions</a>();</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">if</span> (ec) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordflow">return</span> ec;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d2/d0e/classTcpSession.html#ae003ac5c35229455c64624c6b5c272f5">SetSocketKeepaliveOptions</a>(<a class="code" href="../../d1/dfd/classSandeshSession.html#a5a50f41f97f49937d27107ae107e8345">keepalive_idle_time_</a>, <a class="code" href="../../d1/dfd/classSandeshSession.html#a641dc56917652ec141379f000c7e11fc">keepalive_interval_</a>,</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <a class="code" href="../../d1/dfd/classSandeshSession.html#a6803c5c6968c7ce2e92dc196524aeb6a">keepalive_probes_</a>, <a class="code" href="../../d1/dfd/classSandeshSession.html#aefb9be143184425b90540dbc4d47f368">tcp_user_timeout_</a>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="../../d1/dfd/classSandeshSession.html#a15dccbcacbd4b38402ef89b5251f7b46">  365</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/dfd/classSandeshSession.html#a15dccbcacbd4b38402ef89b5251f7b46">SandeshSession::OnRead</a>(<a class="code" href="../../d2/d0e/classTcpSession.html#aadd0345915edabc2824f3118a62d891f">Buffer</a> buffer) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="../../d1/dfd/classSandeshSession.html#a74d400f203f31dc7e3e1e2c6eaeb1511">reader_</a>-&gt;OnRead(buffer);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;}</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="../../d1/dfd/classSandeshSession.html#a03dd00fe022bb324bf33acc7e8d8f55a">  369</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d1/dfd/classSandeshSession.html#a03dd00fe022bb324bf33acc7e8d8f55a">SandeshSession::SendMsg</a>(<a class="code" href="../../d1/d3c/structSandeshElement.html">SandeshElement</a> element) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="../../de/d75/classSandesh.html">Sandesh</a> *<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a> = element.<a class="code" href="../../d1/d3c/structSandeshElement.html#a93d9625c62c34972f4c5e863f5919e8b">snh_</a>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    tbb::mutex::scoped_lock lock(<a class="code" href="../../d1/dfd/classSandeshSession.html#aa1e557686996a63a24650456a7df5ca9">send_mutex_</a>);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d0e/classTcpSession.html#ac10803a7f7a8485c6f7e77e2b11abeed">IsEstablished</a>()) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../de/d75/classSandesh.html#ab5f277781a32d27e6ba1879ea4eaf7e8">Sandesh::IsLoggingDroppedAllowed</a>(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;type())) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <a class="code" href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a>(ERROR, __func__ &lt;&lt; <span class="stringliteral">&quot; Not Connected : Dropping Message: &quot;</span> &lt;&lt;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;ToString());</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <a class="code" href="../../d1/dfd/classSandeshSession.html#aaa9ffe0db354351aa404d43c02597fce">increment_send_msg_fail</a>();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="../../de/d75/classSandesh.html#a0d9dd4649dcc88784f7f7e57247a0a4e">Sandesh::UpdateTxMsgFailStats</a>(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;Name(), 0,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            SandeshTxDropReason::SessionNotConnected);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;Release();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;IsLoggingAllowed()) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;Log();</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordtype">bool</span> more = !<a class="code" href="../../d1/dfd/classSandeshSession.html#ade321d28717e66cca824a34a5d1968af">send_queue_</a>-&gt;IsQueueEmpty();</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/dfd/classSandeshSession.html#a6530ab22fec8c6b4f77adbfb423f9d32">stats_client_</a> &amp;&amp; <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;type() == SandeshType::UVE) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <a class="code" href="../../d1/dfd/classSandeshSession.html#a6530ab22fec8c6b4f77adbfb423f9d32">stats_client_</a>-&gt;<a class="code" href="../../d5/dcd/classStatsClient.html#acab6aa0d08dc04401e25ca428ec501dc">SendMsg</a>(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="../../d1/dfd/classSandeshSession.html#a7164b38c0a2a30455b841e031f37ed44">writer_</a>-&gt;SendMsg(<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>, more);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;}</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="../../d1/dfd/classSandeshSession.html#a7e7c2d2986a94f611c5cd61f62f75509">  394</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d1/dfd/classSandeshSession.html#a7e7c2d2986a94f611c5cd61f62f75509">SandeshSession::SendBuffer</a>(boost::shared_ptr&lt;TMemoryBuffer&gt; sbuffer) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    tbb::mutex::scoped_lock lock(<a class="code" href="../../d1/dfd/classSandeshSession.html#aa1e557686996a63a24650456a7df5ca9">send_mutex_</a>);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d0e/classTcpSession.html#ac10803a7f7a8485c6f7e77e2b11abeed">IsEstablished</a>()) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <a class="code" href="../../d1/dfd/classSandeshSession.html#a33182303c0e62d5d24b96092143afda1">increment_send_buffer_fail</a>();</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">// No buffer packing supported currently</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <a class="code" href="../../d1/dfd/classSandeshSession.html#a7164b38c0a2a30455b841e031f37ed44">writer_</a>-&gt;SendBuffer(sbuffer);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;}</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="../../d1/dfd/classSandeshSession.html#ad880a199978016bf15ee873bc905be9c">  405</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d1/dfd/classSandeshSession.html#ad880a199978016bf15ee873bc905be9c">SandeshSession::EnqueueBuffer</a>(u_int8_t *buf, u_int32_t buf_len) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    boost::shared_ptr&lt;TMemoryBuffer&gt; sbuffer(<span class="keyword">new</span> <a class="code" href="../../d9/d10/classcontrail_1_1sandesh_1_1transport_1_1TMemoryBuffer.html">TMemoryBuffer</a>(buf_len));</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    u_int8_t *write_buf = sbuffer-&gt;getWritePtr(buf_len);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    memcpy(write_buf, buf, buf_len);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    sbuffer-&gt;wroteBytes(buf_len);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d1/dfd/classSandeshSession.html#a74e9ad47697a7c6fca72c6d97e8bfef4">send_buffer_queue</a>()-&gt;<a class="code" href="../../d4/d0c/classWorkQueue.html#a1cd8582cc7cdc534693e9278b27b5f41">Enqueue</a>(sbuffer);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;}</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="../../d1/dfd/classSandeshSession.html#a48429daf3c38886d3c0de12cb9818026">  413</a></span>&#160;<a class="code" href="../../de/d75/classSandesh.html">Sandesh</a> * <a class="code" href="../../d1/dfd/classSandeshSession.html#a48429daf3c38886d3c0de12cb9818026">SandeshSession::DecodeCtrlSandesh</a>(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; msg,</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keyword">const</span> SandeshHeader&amp; header,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; sandesh_name, <span class="keyword">const</span> uint32_t&amp; header_offset) {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keyword">namespace </span>sandesh_prot = <a class="code" href="../../dc/dde/namespacecontrail_1_1sandesh_1_1protocol.html">contrail::sandesh::protocol</a>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keyword">namespace </span>sandesh_trans = <a class="code" href="../../d4/dbb/namespacecontrail_1_1sandesh_1_1transport.html">contrail::sandesh::transport</a>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    assert(header.get_Hints() &amp; g_sandesh_constants.SANDESH_CONTROL_HINT);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// Create and process the sandesh</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="../../de/d75/classSandesh.html">Sandesh</a> *<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a> = <a class="code" href="../../dc/dbf/classSandeshBaseFactory.html#a70668a049a987b4b606d62fe27e43d0d">SandeshBaseFactory::CreateInstance</a>(sandesh_name);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a> == NULL) {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <a class="code" href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a>(ERROR, __func__ &lt;&lt; <span class="stringliteral">&quot;: Unknown sandesh ctrl message: &quot;</span> &lt;&lt; sandesh_name);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    boost::shared_ptr&lt;sandesh_trans::TMemoryBuffer&gt; btrans =</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            boost::shared_ptr&lt;sandesh_trans::TMemoryBuffer&gt;(</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                    <span class="keyword">new</span> sandesh_trans::TMemoryBuffer((uint8_t *)msg.c_str() + header_offset,</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                            msg.size() - header_offset));</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    boost::shared_ptr&lt;sandesh_prot::TXMLProtocol&gt; prot =</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            boost::shared_ptr&lt;sandesh_prot::TXMLProtocol&gt;(<span class="keyword">new</span> sandesh_prot::TXMLProtocol(btrans));</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    int32_t xfer = <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;Read(prot);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span> (xfer &lt; 0) {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <a class="code" href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a>(ERROR, __func__ &lt;&lt; <span class="stringliteral">&quot;: Decoding &quot;</span> &lt;&lt; sandesh_name &lt;&lt; <span class="stringliteral">&quot; for ctrl FAILED&quot;</span>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>-&gt;Release();</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../da/dcc/namespacesandesh.html">sandesh</a>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;}</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno"><a class="line" href="../../d1/dfd/classSandeshSession.html#a041474e3313d2d4dd9ea33e70078d8d7">  443</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d1/dfd/classSandeshSession.html#a041474e3313d2d4dd9ea33e70078d8d7">SandeshSession::EnqueueClose</a>() {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d2/d0e/classTcpSession.html#a51a39940c17304d3379ac1492196f97c">IsClosed</a>()) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    tbb::mutex::scoped_lock lock(<a class="code" href="../../d1/dfd/classSandeshSession.html#a5966bc8e58cb0fc75eefc3eb83420c7c">conn_mutex_</a>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/dfd/classSandeshSession.html#afd90b9e08a58116b951b08461e1b4266">connection_</a>) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <a class="code" href="../../d1/dfd/classSandeshSession.html#afd90b9e08a58116b951b08461e1b4266">connection_</a>-&gt;<a class="code" href="../../d9/df3/classSandeshConnection.html#a4225c29e305c9815f11676ecb8e791c6">state_machine</a>()-&gt;<a class="code" href="../../d3/d36/classSandeshStateMachine.html#abbf674a70afaa7893d1978170969ecb9">OnSessionEvent</a>(<span class="keyword">this</span>,</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <a class="code" href="../../d2/d0e/classTcpSession.html#a00ea3012f13ed9be96a66e9e0ea5d33baa10d420c6c38868a8fe7981dea9d5fd4">TcpSession::CLOSE</a>);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <a class="code" href="../../d2/d0e/classTcpSession.html#a90f5af97068082f27c36f0d1e6941dfe">TcpSession::EventObserver</a> eobs(<a class="code" href="../../d2/d0e/classTcpSession.html#adf33e39f41b52baeebf35a7ddb7825eb">observer</a>());</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="keywordflow">if</span> (eobs) {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            eobs(<span class="keyword">this</span>, <a class="code" href="../../d2/d0e/classTcpSession.html#a00ea3012f13ed9be96a66e9e0ea5d33baa10d420c6c38868a8fe7981dea9d5fd4">TcpSession::CLOSE</a>);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;}</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">// SandeshReader</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="../../d9/d64/classSandeshReader.html#a3db4e43f6b85757ed63efdef62f45f4c">  462</a></span>&#160;<a class="code" href="../../d9/d64/classSandeshReader.html#a3db4e43f6b85757ed63efdef62f45f4c">SandeshReader::SandeshReader</a>(<a class="code" href="../../d1/dfd/classSandeshSession.html">SandeshSession</a> *session) :</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        buf_(<span class="stringliteral">&quot;&quot;</span>),</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        offset_(0),</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        msg_length_(-1),</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        session_(session) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>.reserve(<a class="code" href="../../d9/d64/classSandeshReader.html#a93b6d0c398a71ff519a09c356cfcfb89">kDefaultRecvSize</a>);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;}</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno"><a class="line" href="../../d9/d64/classSandeshReader.html#a25d1e440f5ce04ef7359270852ddf939">  470</a></span>&#160;<a class="code" href="../../d9/d64/classSandeshReader.html#a25d1e440f5ce04ef7359270852ddf939">SandeshReader::~SandeshReader</a>() {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;}</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="../../d9/d64/classSandeshReader.html#aeb81cff83e7d21331660bb125e6957a3">  473</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d9/d64/classSandeshReader.html#aeb81cff83e7d21331660bb125e6957a3">SandeshReader::ExtractMsgHeader</a>(<span class="keyword">const</span> std::string&amp; msg,</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        SandeshHeader&amp; header, std::string&amp; msg_type, uint32_t&amp; header_offset) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    int32_t xfer = 0, ret;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    boost::shared_ptr&lt;TMemoryBuffer&gt; btrans =</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            boost::shared_ptr&lt;TMemoryBuffer&gt;(</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                    <span class="keyword">new</span> <a class="code" href="../../d9/d10/classcontrail_1_1sandesh_1_1transport_1_1TMemoryBuffer.html">TMemoryBuffer</a>((uint8_t *)msg.c_str(), msg.size()));</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    boost::shared_ptr&lt;TXMLProtocol&gt; prot =</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            boost::shared_ptr&lt;TXMLProtocol&gt;(<span class="keyword">new</span> <a class="code" href="../../de/d75/classcontrail_1_1sandesh_1_1protocol_1_1TXMLProtocol.html">TXMLProtocol</a>(btrans));</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">// Read the sandesh header and note the offset</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">if</span> ((ret = header.read(prot)) &lt;= 0) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <a class="code" href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a>(ERROR, __func__ &lt;&lt; <span class="stringliteral">&quot;: Sandesh header read FAILED: &quot;</span> &lt;&lt; msg);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">return</span> EINVAL;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    xfer += ret;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    header_offset = xfer;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// Extract the message name</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">if</span> ((ret = prot-&gt;readSandeshBegin(msg_type)) &lt;= 0) {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <a class="code" href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a>(ERROR, __func__ &lt;&lt; <span class="stringliteral">&quot;: Sandesh begin read FAILED: &quot;</span> &lt;&lt; msg);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="keywordflow">return</span> EINVAL;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    xfer += ret;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno"><a class="line" href="../../d9/d64/classSandeshReader.html#a8b50e8316390838da57e0fc7cd04df4d">  497</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/d64/classSandeshReader.html#a8b50e8316390838da57e0fc7cd04df4d">SandeshReader::SetBuf</a>(<span class="keyword">const</span> std::string &amp;str) {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>.empty()) {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <a class="code" href="../../d9/d64/classSandeshReader.html#a62a2af0aea38109c528f65230941997c">ReplaceBuf</a>(str);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a> += str;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">// TODO handle buf_ &gt; kMaxMessageSize</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;}</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="../../d9/d64/classSandeshReader.html#a62a2af0aea38109c528f65230941997c">  506</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/d64/classSandeshReader.html#a62a2af0aea38109c528f65230941997c">SandeshReader::ReplaceBuf</a>(<span class="keyword">const</span> std::string &amp;str) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a> = str;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>.reserve(<a class="code" href="../../d9/d64/classSandeshReader.html#a93b6d0c398a71ff519a09c356cfcfb89">SandeshReader::kDefaultRecvSize</a>);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="../../d9/d64/classSandeshReader.html#a4bc64152fbab5e8b2f91d0dedad51224">offset_</a> = 0;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;}</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno"><a class="line" href="../../d9/d64/classSandeshReader.html#ac2ac36e24abfd066a6db467f8d384df9">  512</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d9/d64/classSandeshReader.html#ac2ac36e24abfd066a6db467f8d384df9">SandeshReader::LeftOver</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>.empty()) {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>.size() != <a class="code" href="../../d9/d64/classSandeshReader.html#a4bc64152fbab5e8b2f91d0dedad51224">offset_</a>);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;}</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">// Returns false if not able to extract the message length, true otherwise</span></div>
<div class="line"><a name="l00520"></a><span class="lineno"><a class="line" href="../../d9/d64/classSandeshReader.html#ad631750f30fcc6d4af1d0f333dcfa2dc">  520</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d9/d64/classSandeshReader.html#ad631750f30fcc6d4af1d0f333dcfa2dc">SandeshReader::ExtractMsgLength</a>(<span class="keywordtype">size_t</span> &amp;msg_length, <span class="keywordtype">int</span> *result) {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="comment">// Have we read enough to extract the message length?</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>.size() - <a class="code" href="../../d9/d64/classSandeshReader.html#a4bc64152fbab5e8b2f91d0dedad51224">offset_</a> &lt; <a class="code" href="../../d0/d8f/classSandeshWriter.html#a10b5d73b7957933c5088204b8a83fd45">SandeshWriter::sandesh_open_</a>.size()) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// Some sanity check</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">if</span> (!boost::algorithm::starts_with(<a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>.c_str() + <a class="code" href="../../d9/d64/classSandeshReader.html#a4bc64152fbab5e8b2f91d0dedad51224">offset_</a>,</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            <a class="code" href="../../d0/d8f/classSandeshWriter.html#af94d2aac87c3a58d0f5a1de383caa293">SandeshWriter::sandesh_open_attr_length_</a>)) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        *result = -1;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    std::string::const_iterator end = <a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>.begin() + <a class="code" href="../../d9/d64/classSandeshReader.html#a4bc64152fbab5e8b2f91d0dedad51224">offset_</a> +</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <a class="code" href="../../d0/d8f/classSandeshWriter.html#a10b5d73b7957933c5088204b8a83fd45">SandeshWriter::sandesh_open_</a>.size() - 1;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">if</span> (*end != <span class="charliteral">&#39;&gt;&#39;</span>) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        *result = -2;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    std::string::const_iterator st = <a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>.begin() + <a class="code" href="../../d9/d64/classSandeshReader.html#a4bc64152fbab5e8b2f91d0dedad51224">offset_</a> +</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <a class="code" href="../../d0/d8f/classSandeshWriter.html#af94d2aac87c3a58d0f5a1de383caa293">SandeshWriter::sandesh_open_attr_length_</a>.size();</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">// Adjust for double quote</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    --end;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordtype">string</span> length = string(st, end);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <a class="code" href="../../dd/d70/string__util_8h.html#a0d7d35e804a90964164148bb9bb955b8">stringToInteger</a>(length.c_str(), <a class="code" href="../../d9/d64/classSandeshReader.html#a3d9d3721fe98fce17693cd4183ead45b">msg_length</a>);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d64/classSandeshReader.html#a3d9d3721fe98fce17693cd4183ead45b">msg_length</a> == 0) {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        *result = -3;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;}</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">// Returns false if not able to extract the full message, true otherwise</span></div>
<div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="../../d9/d64/classSandeshReader.html#ab9bf7179bd4d978d87709def9b0ef7df">  554</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d9/d64/classSandeshReader.html#ab9bf7179bd4d978d87709def9b0ef7df">SandeshReader::ExtractMsg</a>(<a class="code" href="../../d9/d64/classSandeshReader.html#a78e5b4e29469271189f170a493b57de9">Buffer</a> buffer, <span class="keywordtype">int</span> *result, <span class="keywordtype">bool</span> NewBuf) {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">if</span> (NewBuf) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keyword">const</span> uint8_t *cp = <a class="code" href="../../d2/d0e/classTcpSession.html#a5d54ca8bb8677944597b8f7e71d9c2f8">TcpSession::BufferData</a>(buffer);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="comment">// TODO Avoid this copy</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        std::string str(cp, cp + <a class="code" href="../../d2/d0e/classTcpSession.html#a72dca78676dd42e1b23b7959d50caf92">TcpSession::BufferSize</a>(buffer));</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <a class="code" href="../../d9/d64/classSandeshReader.html#a8b50e8316390838da57e0fc7cd04df4d">SetBuf</a>(str);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">// Extract the message length</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d64/classSandeshReader.html#a9764d84610e8561d67de3c04b89c1f55">MsgLengthKnown</a>()) {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d64/classSandeshReader.html#a3d9d3721fe98fce17693cd4183ead45b">msg_length</a> = 0;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="keywordtype">bool</span> done = <a class="code" href="../../d9/d64/classSandeshReader.html#ad631750f30fcc6d4af1d0f333dcfa2dc">ExtractMsgLength</a>(<a class="code" href="../../d9/d64/classSandeshReader.html#a3d9d3721fe98fce17693cd4183ead45b">msg_length</a>, result);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keywordflow">if</span> (done == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <a class="code" href="../../d9/d64/classSandeshReader.html#ad9f661d76e37c7b05a9398ae348d8a34">set_msg_length</a>(<a class="code" href="../../d9/d64/classSandeshReader.html#a3d9d3721fe98fce17693cd4183ead45b">msg_length</a>);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">// Check if the entire message is read or not</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>.size() &lt; <a class="code" href="../../d9/d64/classSandeshReader.html#a3d9d3721fe98fce17693cd4183ead45b">msg_length</a>()) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;}</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno"><a class="line" href="../../d9/d64/classSandeshReader.html#a360c3ba3400bfde7ee10cb70fdfcb81d">  577</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/d64/classSandeshReader.html#a360c3ba3400bfde7ee10cb70fdfcb81d">SandeshReader::OnRead</a>(<a class="code" href="../../d9/d64/classSandeshReader.html#a78e5b4e29469271189f170a493b57de9">Buffer</a> buffer) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    tbb::mutex::scoped_lock lock(<a class="code" href="../../d9/d64/classSandeshReader.html#a1c381595ccafe892eeee4dc136803d36">cb_mutex_</a>);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">// Check if session is being deleted, then drop the packet</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d64/classSandeshReader.html#a64eb3dba82d8023d73ab983a801f03a2">cb_</a>.empty()) {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <a class="code" href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a>(ERROR, __func__ &lt;&lt;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="stringliteral">&quot; Session being deleted: Dropping Message&quot;</span>);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <a class="code" href="../../d9/d64/classSandeshReader.html#a728621d1fcb9c1d681eacad0ca85527b">session_</a>-&gt;<a class="code" href="../../d1/dfd/classSandeshSession.html#a86628122670e69a70c01b23d9b82e7b9">increment_recv_fail</a>();</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <a class="code" href="../../d9/d64/classSandeshReader.html#a728621d1fcb9c1d681eacad0ca85527b">session_</a>-&gt;<a class="code" href="../../d2/d0e/classTcpSession.html#a839ed6302fe50e80d1748068e727e102">ReleaseBuffer</a>(buffer);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordtype">int</span> result = 0;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordtype">bool</span> done = <a class="code" href="../../d9/d64/classSandeshReader.html#ab9bf7179bd4d978d87709def9b0ef7df">ExtractMsg</a>(buffer, &amp;result, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">if</span> (result &lt; 0) {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="comment">// Generate error and close connection</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            <a class="code" href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a>(ERROR, __func__ &lt;&lt; <span class="stringliteral">&quot; Message extract failed: &quot;</span> &lt;&lt; result);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="keyword">const</span> uint8_t *cp = <a class="code" href="../../d2/d0e/classTcpSession.html#a5d54ca8bb8677944597b8f7e71d9c2f8">TcpSession::BufferData</a>(buffer);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordtype">size_t</span> cp_size = <a class="code" href="../../d2/d0e/classTcpSession.html#a72dca78676dd42e1b23b7959d50caf92">TcpSession::BufferSize</a>(buffer);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <a class="code" href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a>(ERROR, __func__ &lt;&lt; <span class="stringliteral">&quot; OnRead Buffer Size: &quot;</span> &lt;&lt; cp_size);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            <a class="code" href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a>(ERROR, __func__ &lt;&lt; <span class="stringliteral">&quot; OnRead Buffer: &quot;</span>);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            std::string debug((<span class="keyword">const</span> <span class="keywordtype">char</span>*)cp, cp_size);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <a class="code" href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a>(ERROR, debug);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            <a class="code" href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a>(ERROR, __func__ &lt;&lt; <span class="stringliteral">&quot; Reader Size: &quot;</span> &lt;&lt; <a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>.size());</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <a class="code" href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a>(ERROR, __func__ &lt;&lt; <span class="stringliteral">&quot; Reader Offset: &quot;</span> &lt;&lt; <a class="code" href="../../d9/d64/classSandeshReader.html#a4bc64152fbab5e8b2f91d0dedad51224">offset_</a>);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <a class="code" href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a>(ERROR, __func__ &lt;&lt; <span class="stringliteral">&quot; Reader Buffer: &quot;</span> &lt;&lt; <a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>.clear();</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <a class="code" href="../../d9/d64/classSandeshReader.html#a4bc64152fbab5e8b2f91d0dedad51224">offset_</a> = 0;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <span class="comment">// Enqueue a close on the state machine</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <a class="code" href="../../d9/d64/classSandeshReader.html#a728621d1fcb9c1d681eacad0ca85527b">session_</a>-&gt;<a class="code" href="../../d1/dfd/classSandeshSession.html#a86628122670e69a70c01b23d9b82e7b9">increment_recv_fail</a>();</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <a class="code" href="../../d9/d64/classSandeshReader.html#a728621d1fcb9c1d681eacad0ca85527b">session_</a>-&gt;<a class="code" href="../../d1/dfd/classSandeshSession.html#a041474e3313d2d4dd9ea33e70078d8d7">EnqueueClose</a>();</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="keywordflow">if</span> (done == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <span class="comment">// We got good match. Process the message after extracting out</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="comment">// the sandesh open and close envelope</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            std::string::const_iterator st = <a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>.begin() + <a class="code" href="../../d9/d64/classSandeshReader.html#a4bc64152fbab5e8b2f91d0dedad51224">offset_</a> +</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                    <a class="code" href="../../d0/d8f/classSandeshWriter.html#a10b5d73b7957933c5088204b8a83fd45">SandeshWriter::sandesh_open_</a>.size();</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            std::string::const_iterator end = <a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>.begin() + <a class="code" href="../../d9/d64/classSandeshReader.html#a4bc64152fbab5e8b2f91d0dedad51224">offset_</a> +</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                    <a class="code" href="../../d9/d64/classSandeshReader.html#a3d9d3721fe98fce17693cd4183ead45b">msg_length</a>() - <a class="code" href="../../d0/d8f/classSandeshWriter.html#abba63b1efaaef5af5f2353d49b329a31">SandeshWriter::sandesh_close_</a>.size();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            std::string xml(st, end);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <a class="code" href="../../d9/d64/classSandeshReader.html#a4bc64152fbab5e8b2f91d0dedad51224">offset_</a> += <a class="code" href="../../d9/d64/classSandeshReader.html#a3d9d3721fe98fce17693cd4183ead45b">msg_length</a>();</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <a class="code" href="../../d9/d64/classSandeshReader.html#a252f28fd1a0c77f46e15252f4710e95e">reset_msg_length</a>();</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d64/classSandeshReader.html#a64eb3dba82d8023d73ab983a801f03a2">cb_</a>(xml, <a class="code" href="../../d9/d64/classSandeshReader.html#a728621d1fcb9c1d681eacad0ca85527b">session_</a>)) {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                <span class="comment">// Enqueue a close on the state machine</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                <a class="code" href="../../d9/d64/classSandeshReader.html#a728621d1fcb9c1d681eacad0ca85527b">session_</a>-&gt;<a class="code" href="../../d1/dfd/classSandeshSession.html#a86628122670e69a70c01b23d9b82e7b9">increment_recv_fail</a>();</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                <a class="code" href="../../d9/d64/classSandeshReader.html#a728621d1fcb9c1d681eacad0ca85527b">session_</a>-&gt;<a class="code" href="../../d1/dfd/classSandeshSession.html#a041474e3313d2d4dd9ea33e70078d8d7">EnqueueClose</a>();</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <span class="comment">// Read more data.</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d9/d64/classSandeshReader.html#ac2ac36e24abfd066a6db467f8d384df9">LeftOver</a>()) {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <a class="code" href="../../d9/d64/classSandeshReader.html#a62a2af0aea38109c528f65230941997c">ReplaceBuf</a>(<span class="keywordtype">string</span>(<a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>, <a class="code" href="../../d9/d64/classSandeshReader.html#a4bc64152fbab5e8b2f91d0dedad51224">offset_</a>, <a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>.size() - <a class="code" href="../../d9/d64/classSandeshReader.html#a4bc64152fbab5e8b2f91d0dedad51224">offset_</a>));</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            done = <a class="code" href="../../d9/d64/classSandeshReader.html#ab9bf7179bd4d978d87709def9b0ef7df">ExtractMsg</a>(buffer, &amp;result, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <span class="comment">// No more data in the Buffer</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <a class="code" href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">buf_</a>.clear();</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <a class="code" href="../../d9/d64/classSandeshReader.html#a4bc64152fbab5e8b2f91d0dedad51224">offset_</a> = 0;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    } <span class="keywordflow">while</span> (<span class="keyword">true</span>);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="../../d9/d64/classSandeshReader.html#a728621d1fcb9c1d681eacad0ca85527b">session_</a>-&gt;<a class="code" href="../../d2/d0e/classTcpSession.html#a839ed6302fe50e80d1748068e727e102">ReleaseBuffer</a>(buffer);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;}</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno"><a class="line" href="../../d9/d64/classSandeshReader.html#a26fa99c98e9259904fe88c7883cee74f">  645</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d9/d64/classSandeshReader.html#a26fa99c98e9259904fe88c7883cee74f">SandeshReader::SetReceiveMsgCb</a>(<a class="code" href="../../d2/d85/sandesh__session_8h.html#a49e457ac7b3851c44dde469c4f742c02">SandeshReceiveMsgCb</a> cb) {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    tbb::mutex::scoped_lock lock(<a class="code" href="../../d9/d64/classSandeshReader.html#a1c381595ccafe892eeee4dc136803d36">cb_mutex_</a>);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <a class="code" href="../../d9/d64/classSandeshReader.html#a64eb3dba82d8023d73ab983a801f03a2">cb_</a> = cb;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;}</div>
<div class="ttc" id="aclassSandeshBaseFactory_html_a70668a049a987b4b606d62fe27e43d0d"><div class="ttname"><a href="../../dc/dbf/classSandeshBaseFactory.html#a70668a049a987b4b606d62fe27e43d0d">SandeshBaseFactory::CreateInstance</a></div><div class="ttdeci">static Sandesh * CreateInstance(std::string const &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2c/cpp_2sandesh_8h_source.html#l00623">cpp/sandesh.h:623</a></div></div>
<div class="ttc" id="aclassSandeshConnection_html_a4225c29e305c9815f11676ecb8e791c6"><div class="ttname"><a href="../../d9/df3/classSandeshConnection.html#a4225c29e305c9815f11676ecb8e791c6">SandeshConnection::state_machine</a></div><div class="ttdeci">SandeshStateMachine * state_machine() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d9f/sandesh__connection_8cc_source.html#l00098">sandesh_connection.cc:98</a></div></div>
<div class="ttc" id="aclassSandeshReader_html"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html">SandeshReader</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00102">sandesh_session.h:102</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_a1c381595ccafe892eeee4dc136803d36"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#a1c381595ccafe892eeee4dc136803d36">SandeshReader::cb_mutex_</a></div><div class="ttdeci">tbb::mutex cb_mutex_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00133">sandesh_session.h:133</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_a252f28fd1a0c77f46e15252f4710e95e"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#a252f28fd1a0c77f46e15252f4710e95e">SandeshReader::reset_msg_length</a></div><div class="ttdeci">void reset_msg_length()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00120">sandesh_session.h:120</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_a25d1e440f5ce04ef7359270852ddf939"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#a25d1e440f5ce04ef7359270852ddf939">SandeshReader::~SandeshReader</a></div><div class="ttdeci">virtual ~SandeshReader()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00470">sandesh_session.cc:470</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_a26fa99c98e9259904fe88c7883cee74f"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#a26fa99c98e9259904fe88c7883cee74f">SandeshReader::SetReceiveMsgCb</a></div><div class="ttdeci">void SetReceiveMsgCb(SandeshReceiveMsgCb cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00645">sandesh_session.cc:645</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_a360c3ba3400bfde7ee10cb70fdfcb81d"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#a360c3ba3400bfde7ee10cb70fdfcb81d">SandeshReader::OnRead</a></div><div class="ttdeci">virtual void OnRead(Buffer buffer)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00577">sandesh_session.cc:577</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_a3d9d3721fe98fce17693cd4183ead45b"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#a3d9d3721fe98fce17693cd4183ead45b">SandeshReader::msg_length</a></div><div class="ttdeci">size_t msg_length()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00116">sandesh_session.h:116</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_a3db4e43f6b85757ed63efdef62f45f4c"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#a3db4e43f6b85757ed63efdef62f45f4c">SandeshReader::SandeshReader</a></div><div class="ttdeci">SandeshReader(SandeshSession *session)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00462">sandesh_session.cc:462</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_a4bc64152fbab5e8b2f91d0dedad51224"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#a4bc64152fbab5e8b2f91d0dedad51224">SandeshReader::offset_</a></div><div class="ttdeci">size_t offset_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00130">sandesh_session.h:130</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_a62a2af0aea38109c528f65230941997c"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#a62a2af0aea38109c528f65230941997c">SandeshReader::ReplaceBuf</a></div><div class="ttdeci">void ReplaceBuf(const std::string &amp;str)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00506">sandesh_session.cc:506</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_a64eb3dba82d8023d73ab983a801f03a2"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#a64eb3dba82d8023d73ab983a801f03a2">SandeshReader::cb_</a></div><div class="ttdeci">SandeshReceiveMsgCb cb_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00134">sandesh_session.h:134</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_a728621d1fcb9c1d681eacad0ca85527b"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#a728621d1fcb9c1d681eacad0ca85527b">SandeshReader::session_</a></div><div class="ttdeci">SandeshSession * session_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00132">sandesh_session.h:132</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_a78e5b4e29469271189f170a493b57de9"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#a78e5b4e29469271189f170a493b57de9">SandeshReader::Buffer</a></div><div class="ttdeci">boost::asio::const_buffer Buffer</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00104">sandesh_session.h:104</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_a7ae12586bbee9c3ccd220f4c2b20b404"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#a7ae12586bbee9c3ccd220f4c2b20b404">SandeshReader::buf_</a></div><div class="ttdeci">std::string buf_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00129">sandesh_session.h:129</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_a8b50e8316390838da57e0fc7cd04df4d"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#a8b50e8316390838da57e0fc7cd04df4d">SandeshReader::SetBuf</a></div><div class="ttdeci">void SetBuf(const std::string &amp;str)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00497">sandesh_session.cc:497</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_a93b6d0c398a71ff519a09c356cfcfb89"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#a93b6d0c398a71ff519a09c356cfcfb89">SandeshReader::kDefaultRecvSize</a></div><div class="ttdeci">static const int kDefaultRecvSize</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00136">sandesh_session.h:136</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_a9764d84610e8561d67de3c04b89c1f55"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#a9764d84610e8561d67de3c04b89c1f55">SandeshReader::MsgLengthKnown</a></div><div class="ttdeci">bool MsgLengthKnown()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00114">sandesh_session.h:114</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_ab9bf7179bd4d978d87709def9b0ef7df"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#ab9bf7179bd4d978d87709def9b0ef7df">SandeshReader::ExtractMsg</a></div><div class="ttdeci">bool ExtractMsg(Buffer buffer, int *result, bool NewBuf)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00554">sandesh_session.cc:554</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_ac2ac36e24abfd066a6db467f8d384df9"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#ac2ac36e24abfd066a6db467f8d384df9">SandeshReader::LeftOver</a></div><div class="ttdeci">bool LeftOver() const</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00512">sandesh_session.cc:512</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_ad631750f30fcc6d4af1d0f333dcfa2dc"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#ad631750f30fcc6d4af1d0f333dcfa2dc">SandeshReader::ExtractMsgLength</a></div><div class="ttdeci">bool ExtractMsgLength(size_t &amp;msg_length, int *result)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00520">sandesh_session.cc:520</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_ad9f661d76e37c7b05a9398ae348d8a34"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#ad9f661d76e37c7b05a9398ae348d8a34">SandeshReader::set_msg_length</a></div><div class="ttdeci">void set_msg_length(size_t length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00118">sandesh_session.h:118</a></div></div>
<div class="ttc" id="aclassSandeshReader_html_aeb81cff83e7d21331660bb125e6957a3"><div class="ttname"><a href="../../d9/d64/classSandeshReader.html#aeb81cff83e7d21331660bb125e6957a3">SandeshReader::ExtractMsgHeader</a></div><div class="ttdeci">static int ExtractMsgHeader(const std::string &amp;msg, SandeshHeader &amp;header, std::string &amp;msg_type, uint32_t &amp;header_offset)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00473">sandesh_session.cc:473</a></div></div>
<div class="ttc" id="aclassSandeshSession_html"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html">SandeshSession</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00143">sandesh_session.h:143</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a03dd00fe022bb324bf33acc7e8d8f55a"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a03dd00fe022bb324bf33acc7e8d8f55a">SandeshSession::SendMsg</a></div><div class="ttdeci">bool SendMsg(SandeshElement element)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00369">sandesh_session.cc:369</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a041474e3313d2d4dd9ea33e70078d8d7"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a041474e3313d2d4dd9ea33e70078d8d7">SandeshSession::EnqueueClose</a></div><div class="ttdeci">virtual void EnqueueClose()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00443">sandesh_session.cc:443</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a0f53720c50517a99fb79c31649b53aa2"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a0f53720c50517a99fb79c31649b53aa2">SandeshSession::ToString</a></div><div class="ttdeci">virtual std::string ToString() const</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00350">sandesh_session.cc:350</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a15dccbcacbd4b38402ef89b5251f7b46"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a15dccbcacbd4b38402ef89b5251f7b46">SandeshSession::OnRead</a></div><div class="ttdeci">virtual void OnRead(Buffer buffer)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00365">sandesh_session.cc:365</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a28e5e52ee6f256c0e922f6af014985eb"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a28e5e52ee6f256c0e922f6af014985eb">SandeshSession::~SandeshSession</a></div><div class="ttdeci">virtual ~SandeshSession()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00308">sandesh_session.cc:308</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a2d06bbd62576583c2b32dc60ef22ba23"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a2d06bbd62576583c2b32dc60ef22ba23">SandeshSession::SetSocketOptions</a></div><div class="ttdeci">virtual boost::system::error_code SetSocketOptions()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00356">sandesh_session.cc:356</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a33182303c0e62d5d24b96092143afda1"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a33182303c0e62d5d24b96092143afda1">SandeshSession::increment_send_buffer_fail</a></div><div class="ttdeci">void increment_send_buffer_fail()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00199">sandesh_session.h:199</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a39c3cecd3632b664b8e8185b86cf32b8"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a39c3cecd3632b664b8e8185b86cf32b8">SandeshSession::SandeshSession</a></div><div class="ttdeci">SandeshSession(SslServer *client, SslSocket *socket, int task_instance, int writer_task_id, int reader_task_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00281">sandesh_session.cc:281</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a3a87471a603c88d30a7f805a680c0a21"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a3a87471a603c88d30a7f805a680c0a21">SandeshSession::increment_write_ready_cb_error</a></div><div class="ttdeci">void increment_write_ready_cb_error()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00208">sandesh_session.h:208</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a48429daf3c38886d3c0de12cb9818026"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a48429daf3c38886d3c0de12cb9818026">SandeshSession::DecodeCtrlSandesh</a></div><div class="ttdeci">static Sandesh * DecodeCtrlSandesh(const std::string &amp;msg, const SandeshHeader &amp;header, const std::string &amp;sandesh_name, const uint32_t &amp;header_offset)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00413">sandesh_session.cc:413</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a5966bc8e58cb0fc75eefc3eb83420c7c"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a5966bc8e58cb0fc75eefc3eb83420c7c">SandeshSession::conn_mutex_</a></div><div class="ttdeci">tbb::mutex conn_mutex_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00245">sandesh_session.h:245</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a5a50f41f97f49937d27107ae107e8345"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a5a50f41f97f49937d27107ae107e8345">SandeshSession::keepalive_idle_time_</a></div><div class="ttdeci">int keepalive_idle_time_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00247">sandesh_session.h:247</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a641dc56917652ec141379f000c7e11fc"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a641dc56917652ec141379f000c7e11fc">SandeshSession::keepalive_interval_</a></div><div class="ttdeci">int keepalive_interval_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00248">sandesh_session.h:248</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a6530ab22fec8c6b4f77adbfb423f9d32"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a6530ab22fec8c6b4f77adbfb423f9d32">SandeshSession::stats_client_</a></div><div class="ttdeci">StatsClient * stats_client_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00243">sandesh_session.h:243</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a6803c5c6968c7ce2e92dc196524aeb6a"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a6803c5c6968c7ce2e92dc196524aeb6a">SandeshSession::keepalive_probes_</a></div><div class="ttdeci">int keepalive_probes_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00249">sandesh_session.h:249</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a6eaf0601d8b7c1f7778fb03b8bb19a4b"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a6eaf0601d8b7c1f7778fb03b8bb19a4b">SandeshSession::Shutdown</a></div><div class="ttdeci">virtual void Shutdown()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00343">sandesh_session.cc:343</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a7164b38c0a2a30455b841e031f37ed44"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a7164b38c0a2a30455b841e031f37ed44">SandeshSession::writer_</a></div><div class="ttdeci">boost::scoped_ptr&lt; SandeshWriter &gt; writer_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00239">sandesh_session.h:239</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a730467dbd60a46dc652a3b464d21b26d"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a730467dbd60a46dc652a3b464d21b26d">SandeshSession::SetSendQueueWaterMark</a></div><div class="ttdeci">void SetSendQueueWaterMark(Sandesh::QueueWaterMarkInfo &amp;wm_info)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00316">sandesh_session.cc:316</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a74d400f203f31dc7e3e1e2c6eaeb1511"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a74d400f203f31dc7e3e1e2c6eaeb1511">SandeshSession::reader_</a></div><div class="ttdeci">boost::scoped_ptr&lt; SandeshReader &gt; reader_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00240">sandesh_session.h:240</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a74e9ad47697a7c6fca72c6d97e8bfef4"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a74e9ad47697a7c6fca72c6d97e8bfef4">SandeshSession::send_buffer_queue</a></div><div class="ttdeci">Sandesh::SandeshBufferQueue * send_buffer_queue()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00157">sandesh_session.h:157</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a7e7c2d2986a94f611c5cd61f62f75509"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a7e7c2d2986a94f611c5cd61f62f75509">SandeshSession::SendBuffer</a></div><div class="ttdeci">bool SendBuffer(boost::shared_ptr&lt; TMemoryBuffer &gt; sbuffer)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00394">sandesh_session.cc:394</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a86628122670e69a70c01b23d9b82e7b9"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a86628122670e69a70c01b23d9b82e7b9">SandeshSession::increment_recv_fail</a></div><div class="ttdeci">void increment_recv_fail()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00190">sandesh_session.h:190</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a8a8d9b00d1f1741e7464c8efbc1511cf"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a8a8d9b00d1f1741e7464c8efbc1511cf">SandeshSession::SessionSendReady</a></div><div class="ttdeci">bool SessionSendReady()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00311">sandesh_session.cc:311</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_a8f156ce671c7966531c53c8a51aecb99"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#a8f156ce671c7966531c53c8a51aecb99">SandeshSession::SetSendingLevel</a></div><div class="ttdeci">void SetSendingLevel(size_t count, SandeshLevel::type level)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00333">sandesh_session.cc:333</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_aa1e557686996a63a24650456a7df5ca9"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#aa1e557686996a63a24650456a7df5ca9">SandeshSession::send_mutex_</a></div><div class="ttdeci">tbb::mutex send_mutex_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00246">sandesh_session.h:246</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_aaa9ffe0db354351aa404d43c02597fce"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#aaa9ffe0db354351aa404d43c02597fce">SandeshSession::increment_send_msg_fail</a></div><div class="ttdeci">void increment_send_msg_fail()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00196">sandesh_session.h:196</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_aac2d51b7140bd5363ba61466656f48b2"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#aac2d51b7140bd5363ba61466656f48b2">SandeshSession::sending_level_</a></div><div class="ttdeci">SandeshLevel::type sending_level_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00252">sandesh_session.h:252</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_aad7309ebbbc4ab1f16ee4fecfd489652"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#aad7309ebbbc4ab1f16ee4fecfd489652">SandeshSession::send_queue</a></div><div class="ttdeci">Sandesh::SandeshQueue * send_queue()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00154">sandesh_session.h:154</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_ad880a199978016bf15ee873bc905be9c"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#ad880a199978016bf15ee873bc905be9c">SandeshSession::EnqueueBuffer</a></div><div class="ttdeci">virtual bool EnqueueBuffer(u_int8_t *buf, u_int32_t buf_len)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00405">sandesh_session.cc:405</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_ad962e2f7d5d3be9756f38fdefc17976f"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#ad962e2f7d5d3be9756f38fdefc17976f">SandeshSession::increment_send_msg</a></div><div class="ttdeci">void increment_send_msg()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00193">sandesh_session.h:193</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_ade321d28717e66cca824a34a5d1968af"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#ade321d28717e66cca824a34a5d1968af">SandeshSession::send_queue_</a></div><div class="ttdeci">boost::scoped_ptr&lt; Sandesh::SandeshQueue &gt; send_queue_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00241">sandesh_session.h:241</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_ade3289929841c351c51a9774f4a98e1e"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#ade3289929841c351c51a9774f4a98e1e">SandeshSession::SendingLevel</a></div><div class="ttdeci">SandeshLevel::type SendingLevel() const</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00339">sandesh_session.cc:339</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_ae687f79d2022cba9fe2b0195dc1cb25d"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#ae687f79d2022cba9fe2b0195dc1cb25d">SandeshSession::send_buffer_queue_</a></div><div class="ttdeci">boost::scoped_ptr&lt; Sandesh::SandeshBufferQueue &gt; send_buffer_queue_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00242">sandesh_session.h:242</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_ae9568cabccd7fcd67166a98648a4d16e"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#ae9568cabccd7fcd67166a98648a4d16e">SandeshSession::instance_</a></div><div class="ttdeci">int instance_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00238">sandesh_session.h:238</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_aec9cdc677e4edda90fc5ecdf20cd9863"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#aec9cdc677e4edda90fc5ecdf20cd9863">SandeshSession::ResetSendQueueWaterMark</a></div><div class="ttdeci">void ResetSendQueueWaterMark()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00328">sandesh_session.cc:328</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_aefb9be143184425b90540dbc4d47f368"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#aefb9be143184425b90540dbc4d47f368">SandeshSession::tcp_user_timeout_</a></div><div class="ttdeci">int tcp_user_timeout_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00250">sandesh_session.h:250</a></div></div>
<div class="ttc" id="aclassSandeshSession_html_afd90b9e08a58116b951b08461e1b4266"><div class="ttname"><a href="../../d1/dfd/classSandeshSession.html#afd90b9e08a58116b951b08461e1b4266">SandeshSession::connection_</a></div><div class="ttdeci">SandeshConnection * connection_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00244">sandesh_session.h:244</a></div></div>
<div class="ttc" id="aclassSandeshStateMachine_html_abbf674a70afaa7893d1978170969ecb9"><div class="ttname"><a href="../../d3/d36/classSandeshStateMachine.html#abbf674a70afaa7893d1978170969ecb9">SandeshStateMachine::OnSessionEvent</a></div><div class="ttdeci">void OnSessionEvent(TcpSession *session, TcpSession::Event event)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d97/sandesh__state__machine_8cc_source.html#l00632">sandesh_state_machine.cc:632</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html">SandeshWriter</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00034">sandesh_session.h:34</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_a10b5d73b7957933c5088204b8a83fd45"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#a10b5d73b7957933c5088204b8a83fd45">SandeshWriter::sandesh_open_</a></div><div class="ttdeci">static const std::string sandesh_open_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00052">sandesh_session.h:52</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_a254bae36474a74a508f242f57483ae30"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#a254bae36474a74a508f242f57483ae30">SandeshWriter::ready_to_send_</a></div><div class="ttdeci">bool ready_to_send_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00087">sandesh_session.h:87</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_a3af5002a2ca2312452a672f09f32e4ca"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#a3af5002a2ca2312452a672f09f32e4ca">SandeshWriter::~SandeshWriter</a></div><div class="ttdeci">~SandeshWriter()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00051">sandesh_session.cc:51</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_a49ceac02ceec6b9e16d2bec4db937cd8"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#a49ceac02ceec6b9e16d2bec4db937cd8">SandeshWriter::append_send_buf</a></div><div class="ttdeci">void append_send_buf(uint8_t *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00077">sandesh_session.h:77</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_a4eeff7bd464a750ede91a921f7dc8cf5"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#a4eeff7bd464a750ede91a921f7dc8cf5">SandeshWriter::send_mutex_</a></div><div class="ttdeci">tbb::mutex send_mutex_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00086">sandesh_session.h:86</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_a5574290db5e5cc8d082a6fe1f1783cf5"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#a5574290db5e5cc8d082a6fe1f1783cf5">SandeshWriter::kDefaultSendSize</a></div><div class="ttdeci">static const unsigned int kDefaultSendSize</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00037">sandesh_session.h:37</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_a571e16e09b7667e345cf10a221fb31c0"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#a571e16e09b7667e345cf10a221fb31c0">SandeshWriter::SendMsg</a></div><div class="ttdeci">void SendMsg(Sandesh *sandesh, bool more)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00073">sandesh_session.cc:73</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_a6466a57d1dc5520523d04aaf5616a365"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#a6466a57d1dc5520523d04aaf5616a365">SandeshWriter::SandeshWriter</a></div><div class="ttdeci">SandeshWriter(SandeshSession *session)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00044">sandesh_session.cc:44</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_a661f9f5117cf1d800860dfb71d3d2c4b"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#a661f9f5117cf1d800860dfb71d3d2c4b">SandeshWriter::WriteReady</a></div><div class="ttdeci">void WriteReady(const boost::system::error_code &amp;ec)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00055">sandesh_session.cc:55</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_a6edb3847946749d4cb95aa6e404fe6dc"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#a6edb3847946749d4cb95aa6e404fe6dc">SandeshWriter::reset_send_buf</a></div><div class="ttdeci">void reset_send_buf()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00082">sandesh_session.h:82</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_a70ebb48baaac20b81570507e38684c47"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#a70ebb48baaac20b81570507e38684c47">SandeshWriter::SendInternal</a></div><div class="ttdeci">void SendInternal(boost::shared_ptr&lt; TMemoryBuffer &gt;)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00270">sandesh_session.cc:270</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_a749abee764012bb594fd84343ca4f452"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#a749abee764012bb594fd84343ca4f452">SandeshWriter::send_buf_offset</a></div><div class="ttdeci">size_t send_buf_offset()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00070">sandesh_session.h:70</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_a87ec724c716203971fdd6d4e0d711ba5"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#a87ec724c716203971fdd6d4e0d711ba5">SandeshWriter::session_</a></div><div class="ttdeci">SandeshSession * session_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00066">sandesh_session.h:66</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_a9d64f820713dc01cd9cca39330fb2311"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#a9d64f820713dc01cd9cca39330fb2311">SandeshWriter::set_send_buf</a></div><div class="ttdeci">void set_send_buf(uint8_t *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00072">sandesh_session.h:72</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_aa62d0e8304a43b28c6626619555faabb"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#aa62d0e8304a43b28c6626619555faabb">SandeshWriter::kEncodeBufferSize</a></div><div class="ttdeci">static const uint32_t kEncodeBufferSize</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00036">sandesh_session.h:36</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_abba63b1efaaef5af5f2353d49b329a31"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#abba63b1efaaef5af5f2353d49b329a31">SandeshWriter::sandesh_close_</a></div><div class="ttdeci">static const std::string sandesh_close_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00054">sandesh_session.h:54</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_abc2811f33401937c2902a24eee8f1995"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#abc2811f33401937c2902a24eee8f1995">SandeshWriter::SendMsgAll</a></div><div class="ttdeci">void SendMsgAll(boost::shared_ptr&lt; TMemoryBuffer &gt;)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00223">sandesh_session.cc:223</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_abf21e13dcb2f5e220beb599c17b565ad"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#abf21e13dcb2f5e220beb599c17b565ad">SandeshWriter::SendMsgMore</a></div><div class="ttdeci">void SendMsgMore(boost::shared_ptr&lt; TMemoryBuffer &gt;)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db4/sandesh__session_8cc_source.html#l00174">sandesh_session.cc:174</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_adc4b6d55b5da0cab860acca9319b0fab"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#adc4b6d55b5da0cab860acca9319b0fab">SandeshWriter::send_buf</a></div><div class="ttdeci">uint8_t * send_buf() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00071">sandesh_session.h:71</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_ae1de346b909b944015d83fdd0eaa5859"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#ae1de346b909b944015d83fdd0eaa5859">SandeshWriter::send_buf_</a></div><div class="ttdeci">uint8_t * send_buf_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00089">sandesh_session.h:89</a></div></div>
<div class="ttc" id="aclassSandeshWriter_html_af94d2aac87c3a58d0f5a1de383caa293"><div class="ttname"><a href="../../d0/d8f/classSandeshWriter.html#af94d2aac87c3a58d0f5a1de383caa293">SandeshWriter::sandesh_open_attr_length_</a></div><div class="ttdeci">static const std::string sandesh_open_attr_length_</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00053">sandesh_session.h:53</a></div></div>
<div class="ttc" id="aclassSandesh_html"><div class="ttname"><a href="../../de/d75/classSandesh.html">Sandesh</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2c/cpp_2sandesh_8h_source.html#l00130">cpp/sandesh.h:130</a></div></div>
<div class="ttc" id="aclassSandesh_html_a0d9dd4649dcc88784f7f7e57247a0a4e"><div class="ttname"><a href="../../de/d75/classSandesh.html#a0d9dd4649dcc88784f7f7e57247a0a4e">Sandesh::UpdateTxMsgFailStats</a></div><div class="ttdeci">static void UpdateTxMsgFailStats(const std::string &amp;msg_name, uint64_t bytes, SandeshTxDropReason::type dreason)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/sandesh_8cc_source.html#l00890">sandesh.cc:890</a></div></div>
<div class="ttc" id="aclassSandesh_html_a2cf8b26e16c308947dbde45f18fbf78f"><div class="ttname"><a href="../../de/d75/classSandesh.html#a2cf8b26e16c308947dbde45f18fbf78f">Sandesh::role</a></div><div class="ttdeci">static SandeshRole::type role()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2c/cpp_2sandesh_8h_source.html#l00296">cpp/sandesh.h:296</a></div></div>
<div class="ttc" id="aclassSandesh_html_a39284670cf55f58c73630dad84a27612"><div class="ttname"><a href="../../de/d75/classSandesh.html#a39284670cf55f58c73630dad84a27612">Sandesh::QueueWaterMarkInfo</a></div><div class="ttdeci">boost::tuple&lt; size_t, SandeshLevel::type, bool, bool &gt; QueueWaterMarkInfo</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2c/cpp_2sandesh_8h_source.html#l00147">cpp/sandesh.h:147</a></div></div>
<div class="ttc" id="aclassSandesh_html_a58e35aa0cc5c3d705b19ab8388ddcacf"><div class="ttname"><a href="../../de/d75/classSandesh.html#a58e35aa0cc5c3d705b19ab8388ddcacf">Sandesh::UpdateTxMsgStats</a></div><div class="ttdeci">static void UpdateTxMsgStats(const std::string &amp;msg_name, uint64_t bytes)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/sandesh_8cc_source.html#l00884">sandesh.cc:884</a></div></div>
<div class="ttc" id="aclassSandesh_html_a62eb09258028ea227f5c0e28ef2ee8e2"><div class="ttname"><a href="../../de/d75/classSandesh.html#a62eb09258028ea227f5c0e28ef2ee8e2">Sandesh::IsSendQueueEnabled</a></div><div class="ttdeci">static bool IsSendQueueEnabled()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2c/cpp_2sandesh_8h_source.html#l00239">cpp/sandesh.h:239</a></div></div>
<div class="ttc" id="aclassSandesh_html_ab5f277781a32d27e6ba1879ea4eaf7e8"><div class="ttname"><a href="../../de/d75/classSandesh.html#ab5f277781a32d27e6ba1879ea4eaf7e8">Sandesh::IsLoggingDroppedAllowed</a></div><div class="ttdeci">static bool IsLoggingDroppedAllowed(SandeshType::type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d39/sandesh_8cc_source.html#l00844">sandesh.cc:844</a></div></div>
<div class="ttc" id="aclassSslServer_html"><div class="ttname"><a href="../../d8/d4d/classSslServer.html">SslServer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3b/ssl__server_8h_source.html#l00014">ssl_server.h:14</a></div></div>
<div class="ttc" id="aclassSslSession_html"><div class="ttname"><a href="../../db/dda/classSslSession.html">SslSession</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d8c/ssl__session_8h_source.html#l00016">ssl_session.h:16</a></div></div>
<div class="ttc" id="aclassSslSession_html_a3eea16bfb02a5a918d97480928c14e37"><div class="ttname"><a href="../../db/dda/classSslSession.html#a3eea16bfb02a5a918d97480928c14e37">SslSession::SslSocket</a></div><div class="ttdeci">boost::asio::ssl::stream&lt; boost::asio::ip::tcp::socket &gt; SslSocket</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d8c/ssl__session_8h_source.html#l00018">ssl_session.h:18</a></div></div>
<div class="ttc" id="aclassStatsClient_html_acab6aa0d08dc04401e25ca428ec501dc"><div class="ttname"><a href="../../d5/dcd/classStatsClient.html#acab6aa0d08dc04401e25ca428ec501dc">StatsClient::SendMsg</a></div><div class="ttdeci">virtual bool SendMsg(Sandesh *sandesh)=0</div></div>
<div class="ttc" id="aclassTcpSession_html_a00ea3012f13ed9be96a66e9e0ea5d33baa10d420c6c38868a8fe7981dea9d5fd4"><div class="ttname"><a href="../../d2/d0e/classTcpSession.html#a00ea3012f13ed9be96a66e9e0ea5d33baa10d420c6c38868a8fe7981dea9d5fd4">TcpSession::CLOSE</a></div><div class="ttdeci">@ CLOSE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d15/tcp__session_8h_source.html#l00053">tcp_session.h:52</a></div></div>
<div class="ttc" id="aclassTcpSession_html_a51a39940c17304d3379ac1492196f97c"><div class="ttname"><a href="../../d2/d0e/classTcpSession.html#a51a39940c17304d3379ac1492196f97c">TcpSession::IsClosed</a></div><div class="ttdeci">bool IsClosed() const</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d15/tcp__session_8h_source.html#l00125">tcp_session.h:125</a></div></div>
<div class="ttc" id="aclassTcpSession_html_a5d54ca8bb8677944597b8f7e71d9c2f8"><div class="ttname"><a href="../../d2/d0e/classTcpSession.html#a5d54ca8bb8677944597b8f7e71d9c2f8">TcpSession::BufferData</a></div><div class="ttdeci">static const uint8_t * BufferData(const Buffer &amp;buffer)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d15/tcp__session_8h_source.html#l00113">tcp_session.h:113</a></div></div>
<div class="ttc" id="aclassTcpSession_html_a5ea3a03c6c4b4a506b8a3af46e3cb92e"><div class="ttname"><a href="../../d2/d0e/classTcpSession.html#a5ea3a03c6c4b4a506b8a3af46e3cb92e">TcpSession::ToString</a></div><div class="ttdeci">virtual std::string ToString() const</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d15/tcp__session_8h_source.html#l00083">tcp_session.h:83</a></div></div>
<div class="ttc" id="aclassTcpSession_html_a72dca78676dd42e1b23b7959d50caf92"><div class="ttname"><a href="../../d2/d0e/classTcpSession.html#a72dca78676dd42e1b23b7959d50caf92">TcpSession::BufferSize</a></div><div class="ttdeci">static size_t BufferSize(const Buffer &amp;buffer)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d15/tcp__session_8h_source.html#l00116">tcp_session.h:116</a></div></div>
<div class="ttc" id="aclassTcpSession_html_a839ed6302fe50e80d1748068e727e102"><div class="ttname"><a href="../../d2/d0e/classTcpSession.html#a839ed6302fe50e80d1748068e727e102">TcpSession::ReleaseBuffer</a></div><div class="ttdeci">virtual void ReleaseBuffer(Buffer buffer)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d26/tcp__session_8cc_source.html#l00143">tcp_session.cc:143</a></div></div>
<div class="ttc" id="aclassTcpSession_html_a90f5af97068082f27c36f0d1e6941dfe"><div class="ttname"><a href="../../d2/d0e/classTcpSession.html#a90f5af97068082f27c36f0d1e6941dfe">TcpSession::EventObserver</a></div><div class="ttdeci">boost::function&lt; void(TcpSession *, Event)&gt; EventObserver</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d15/tcp__session_8h_source.html#l00063">tcp_session.h:63</a></div></div>
<div class="ttc" id="aclassTcpSession_html_aadd0345915edabc2824f3118a62d891f"><div class="ttname"><a href="../../d2/d0e/classTcpSession.html#aadd0345915edabc2824f3118a62d891f">TcpSession::Buffer</a></div><div class="ttdeci">boost::asio::const_buffer Buffer</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d15/tcp__session_8h_source.html#l00064">tcp_session.h:64</a></div></div>
<div class="ttc" id="aclassTcpSession_html_ac10803a7f7a8485c6f7e77e2b11abeed"><div class="ttname"><a href="../../d2/d0e/classTcpSession.html#ac10803a7f7a8485c6f7e77e2b11abeed">TcpSession::IsEstablished</a></div><div class="ttdeci">bool IsEstablished() const</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d15/tcp__session_8h_source.html#l00120">tcp_session.h:120</a></div></div>
<div class="ttc" id="aclassTcpSession_html_ad8740e4f810aa650f174fe6fb31c3e47"><div class="ttname"><a href="../../d2/d0e/classTcpSession.html#ad8740e4f810aa650f174fe6fb31c3e47">TcpSession::SetSocketOptions</a></div><div class="ttdeci">virtual boost::system::error_code SetSocketOptions()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d26/tcp__session_8cc_source.html#l00868">tcp_session.cc:868</a></div></div>
<div class="ttc" id="aclassTcpSession_html_adf33e39f41b52baeebf35a7ddb7825eb"><div class="ttname"><a href="../../d2/d0e/classTcpSession.html#adf33e39f41b52baeebf35a7ddb7825eb">TcpSession::observer</a></div><div class="ttdeci">EventObserver observer()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d15/tcp__session_8h_source.html#l00214">tcp_session.h:214</a></div></div>
<div class="ttc" id="aclassTcpSession_html_ae003ac5c35229455c64624c6b5c272f5"><div class="ttname"><a href="../../d2/d0e/classTcpSession.html#ae003ac5c35229455c64624c6b5c272f5">TcpSession::SetSocketKeepaliveOptions</a></div><div class="ttdeci">boost::system::error_code SetSocketKeepaliveOptions(int keepalive_time, int keepalive_intvl, int keepalive_probes, int tcp_user_timeout_val=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d26/tcp__session_8cc_source.html#l00802">tcp_session.cc:802</a></div></div>
<div class="ttc" id="aclassTcpSession_html_af181c9d6048155cb94ab3a605b56a574"><div class="ttname"><a href="../../d2/d0e/classTcpSession.html#af181c9d6048155cb94ab3a605b56a574">TcpSession::Send</a></div><div class="ttdeci">virtual bool Send(const uint8_t *data, size_t size, size_t *sent)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d26/tcp__session_8cc_source.html#l00428">tcp_session.cc:428</a></div></div>
<div class="ttc" id="aclassWorkQueue_html"><div class="ttname"><a href="../../d4/d0c/classWorkQueue.html">WorkQueue</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d47/queue__task_8h_source.html#l00109">queue_task.h:109</a></div></div>
<div class="ttc" id="aclassWorkQueue_html_a1cd8582cc7cdc534693e9278b27b5f41"><div class="ttname"><a href="../../d4/d0c/classWorkQueue.html#a1cd8582cc7cdc534693e9278b27b5f41">WorkQueue::Enqueue</a></div><div class="ttdeci">bool Enqueue(QueueEntryT entry)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d47/queue__task_8h_source.html#l00248">queue_task.h:248</a></div></div>
<div class="ttc" id="aclassWorkQueue_html_af732cae3f686d952b71def5b5771ea9e"><div class="ttname"><a href="../../d4/d0c/classWorkQueue.html#af732cae3f686d952b71def5b5771ea9e">WorkQueue::MayBeStartRunner</a></div><div class="ttdeci">void MayBeStartRunner()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d47/queue__task_8h_source.html#l00281">queue_task.h:281</a></div></div>
<div class="ttc" id="aclasscontrail_1_1sandesh_1_1protocol_1_1TXMLProtocol_html"><div class="ttname"><a href="../../de/d75/classcontrail_1_1sandesh_1_1protocol_1_1TXMLProtocol.html">contrail::sandesh::protocol::TXMLProtocol</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3c/TXMLProtocol_8h_source.html#l00021">TXMLProtocol.h:21</a></div></div>
<div class="ttc" id="aclasscontrail_1_1sandesh_1_1transport_1_1TMemoryBuffer_html"><div class="ttname"><a href="../../d9/d10/classcontrail_1_1sandesh_1_1transport_1_1TMemoryBuffer.html">contrail::sandesh::transport::TMemoryBuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d11/TBufferTransports_8h_source.html#l00192">TBufferTransports.h:192</a></div></div>
<div class="ttc" id="acpp_2sandesh_8h_html_a08e7032b93d4e9831355f88e17c2ee32"><div class="ttname"><a href="../../d3/d2c/cpp_2sandesh_8h.html#a08e7032b93d4e9831355f88e17c2ee32">SANDESH_LOG</a></div><div class="ttdeci">#define SANDESH_LOG(_Level, _Msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2c/cpp_2sandesh_8h_source.html#l00474">cpp/sandesh.h:474</a></div></div>
<div class="ttc" id="aglobals_8h_html_af8f69ad2e0771a513d2eb7d5198b2a8caef2863a469df3ea6871d640e3669a2f2"><div class="ttname"><a href="../../d5/d87/globals_8h.html#af8f69ad2e0771a513d2eb7d5198b2a8caef2863a469df3ea6871d640e3669a2f2">INVALID</a></div><div class="ttdeci">@ INVALID</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d87/globals_8h_source.html#l00147">globals.h:147</a></div></div>
<div class="ttc" id="aload__balance_8h_html_a1d127017fb298b889f4ba24752d08b8e"><div class="ttname"><a href="../../de/dcb/load__balance_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a></div><div class="ttdeci">uint8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/load__balance_8h_source.html#l00002">load_balance.h:2</a></div></div>
<div class="ttc" id="anamespaceboost_html"><div class="ttname"><a href="../../d4/da9/namespaceboost.html">boost</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d55/db__graph__base_8h_source.html#l00023">db_graph_base.h:23</a></div></div>
<div class="ttc" id="anamespacecontrail_1_1sandesh_1_1protocol_html"><div class="ttname"><a href="../../dc/dde/namespacecontrail_1_1sandesh_1_1protocol.html">contrail::sandesh::protocol</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d22/TBinaryProtocol_8h_source.html#l00033">TBinaryProtocol.h:33</a></div></div>
<div class="ttc" id="anamespacecontrail_1_1sandesh_1_1transport_html"><div class="ttname"><a href="../../d4/dbb/namespacecontrail_1_1sandesh_1_1transport.html">contrail::sandesh::transport</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d11/TBufferTransports_8h_source.html#l00037">TBufferTransports.h:37</a></div></div>
<div class="ttc" id="anamespacesandesh_html"><div class="ttname"><a href="../../da/dcc/namespacesandesh.html">sandesh</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dbb/sandesh__options_8cc_source.html#l00012">sandesh_options.cc:12</a></div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="../../d8/dcc/namespacestd.html">std</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d03/bgp__update_8h_source.html#l00120">bgp_update.h:120</a></div></div>
<div class="ttc" id="aparse__object_8h_html"><div class="ttname"><a href="../../d1/d66/parse__object_8h.html">parse_object.h</a></div></div>
<div class="ttc" id="asandesh__connection_8h_html"><div class="ttname"><a href="../../d9/dfa/sandesh__connection_8h.html">sandesh_connection.h</a></div></div>
<div class="ttc" id="asandesh__session_8h_html"><div class="ttname"><a href="../../d2/d85/sandesh__session_8h.html">sandesh_session.h</a></div></div>
<div class="ttc" id="asandesh__session_8h_html_a49e457ac7b3851c44dde469c4f742c02"><div class="ttname"><a href="../../d2/d85/sandesh__session_8h.html#a49e457ac7b3851c44dde469c4f742c02">SandeshReceiveMsgCb</a></div><div class="ttdeci">boost::function&lt; bool(const std::string &amp;, SandeshSession *)&gt; SandeshReceiveMsgCb</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00100">sandesh_session.h:100</a></div></div>
<div class="ttc" id="asandesh__session_8h_html_a5ab26593b785e6449896608d5f49466c"><div class="ttname"><a href="../../d2/d85/sandesh__session_8h.html#a5ab26593b785e6449896608d5f49466c">sXML_SANDESH_OPEN</a></div><div class="ttdeci">#define sXML_SANDESH_OPEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00093">sandesh_session.h:93</a></div></div>
<div class="ttc" id="asandesh__session_8h_html_ab31bc165aaad01f2a44070b97e083f71"><div class="ttname"><a href="../../d2/d85/sandesh__session_8h.html#ab31bc165aaad01f2a44070b97e083f71">sXML_SANDESH_CLOSE</a></div><div class="ttdeci">#define sXML_SANDESH_CLOSE</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00094">sandesh_session.h:94</a></div></div>
<div class="ttc" id="asandesh__session_8h_html_aedbbe920e334e4ed8e07a3f24b7a3938"><div class="ttname"><a href="../../d2/d85/sandesh__session_8h.html#aedbbe920e334e4ed8e07a3f24b7a3938">sXML_SANDESH_OPEN_ATTR_LENGTH</a></div><div class="ttdeci">#define sXML_SANDESH_OPEN_ATTR_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d85/sandesh__session_8h_source.html#l00092">sandesh_session.h:92</a></div></div>
<div class="ttc" id="astring__util_8h_html_a0d7d35e804a90964164148bb9bb955b8"><div class="ttname"><a href="../../dd/d70/string__util_8h.html#a0d7d35e804a90964164148bb9bb955b8">stringToInteger</a></div><div class="ttdeci">bool stringToInteger(const std::string &amp;str, NumberType &amp;num)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d70/string__util_8h_source.html#l00071">string_util.h:71</a></div></div>
<div class="ttc" id="astructSandeshElement_html"><div class="ttname"><a href="../../d1/d3c/structSandeshElement.html">SandeshElement</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2c/cpp_2sandesh_8h_source.html#l00453">cpp/sandesh.h:453</a></div></div>
<div class="ttc" id="astructSandeshElement_html_a93d9625c62c34972f4c5e863f5919e8b"><div class="ttname"><a href="../../d1/d3c/structSandeshElement.html#a93d9625c62c34972f4c5e863f5919e8b">SandeshElement::snh_</a></div><div class="ttdeci">Sandesh * snh_</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2c/cpp_2sandesh_8h_source.html#l00454">cpp/sandesh.h:454</a></div></div>
<div class="ttc" id="astructSandesh_1_1SandeshRole_html_a7319897fe11feb7022a5cacb6e4a6c0bacb542b0faa8bae9b8d3d29461ffa21a6"><div class="ttname"><a href="../../d5/de1/structSandesh_1_1SandeshRole.html#a7319897fe11feb7022a5cacb6e4a6c0bacb542b0faa8bae9b8d3d29461ffa21a6">Sandesh::SandeshRole::Collector</a></div><div class="ttdeci">@ Collector</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2c/cpp_2sandesh_8h_source.html#l00143">cpp/sandesh.h:143</a></div></div>
<div class="ttc" id="astructWaterMarkInfo_html"><div class="ttname"><a href="../../d2/dde/structWaterMarkInfo.html">WaterMarkInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/de0/watermark_8h_source.html#l00019">watermark.h:19</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_0a7d39584c34dc4772b798c7b583750f.html">contrail</a></li><li class="navelem"><a class="el" href="../../dir_b6c736c67dca1dde75140b15fe40c91d.html">src</a></li><li class="navelem"><a class="el" href="../../dir_07b628283610f72b3c66cdc29ecc5cf0.html">contrail-common</a></li><li class="navelem"><a class="el" href="../../dir_d35e9b1b7b4ef9bb6b2097e43c848f54.html">sandesh</a></li><li class="navelem"><a class="el" href="../../dir_08b45cabb4405de7026df0dc4e3f2cd7.html">library</a></li><li class="navelem"><a class="el" href="../../dir_0bd6df7f05787a29ad2db23f91b262c2.html">cpp</a></li><li class="navelem"><a class="el" href="../../de/db4/sandesh__session_8cc.html">sandesh_session.cc</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
