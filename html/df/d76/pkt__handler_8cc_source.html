<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>OpenSDN source code: pkt_handler.cc Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenSDN source code
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('df/d76/pkt__handler_8cc_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">pkt_handler.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../df/d76/pkt__handler_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (c) 2013 Juniper Networks, Inc. All rights reserved.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/dff/os_8h.html">base/os.h</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;arpa/inet.h&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;netinet/in.h&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;netinet/ip6.h&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;netinet/icmp6.h&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d84/agent__param_8h.html">init/agent_param.h</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d18/agent__cmn_8h.html">cmn/agent_cmn.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/dd2/diag_8h.html">diag/diag.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d95/address__util_8h.html">base/address_util.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d7d/ecmp__load__balance_8h.html">oper/ecmp_load_balance.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d31/interface__common_8h.html">oper/interface_common.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d3f/nexthop_8h.html">oper/nexthop.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/dde/route__common_8h.html">oper/route_common.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d21/vrf_8h.html">oper/vrf.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/dd8/tunnel__nh_8h.html">oper/tunnel_nh.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d6e/control__interface_8h.html">pkt/control_interface.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d79/pkt__handler_8h.html">pkt/pkt_handler.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d2c/controller_2src_2vnsw_2agent_2pkt_2proto_8h.html">pkt/proto.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d01/flow__table_8h.html">pkt/flow_table.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d5c/flow__proto_8h.html">pkt/flow_proto.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;pkt/pkt_types.h&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/db3/pkt__init_8h.html">pkt/pkt_init.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d16/agent__stats_8h.html">cmn/agent_stats.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/dc5/packet__buffer_8h.html">pkt/packet_buffer.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;vr_types.h&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;vr_defs.h&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;vr_mpls.h&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="../../df/d76/pkt__handler_8cc.html#a3517b6542d72a569bd903923b6413b65">   35</a></span>&#160;<span class="preprocessor">#define PKT_TRACE(obj, arg)                                              \</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">do {                                                                     \</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">    std::ostringstream _str;                                             \</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">    _str &lt;&lt; arg;                                                         \</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">    Pkt##obj::TraceMsg(PacketTraceBuf, __FILE__, __LINE__, _str.str());  \</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">} while (false)                                                          \</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor"></span><span class="keyword">const</span> std::size_t <a class="code" href="../../db/d26/classPktTrace.html#a0b7227b964b142e143287cb123a8c357">PktTrace::kPktMaxTraceSize</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> IsBfdkeepalivePkt(<span class="keyword">const</span> <a class="code" href="../../d6/d0d/structAgentHdr.html">AgentHdr</a> &amp;hdr)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// For the BFD traped packets, BFD state info is available in &#39;cmd_param&#39;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span> ((hdr.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == AGENT_TRAP_BFD) &amp;&amp; (hdr.<a class="code" href="../../d6/d0d/structAgentHdr.html#a34bbc005d14e0b0f17e6d146569fbe23">cmd_param</a> == 0xc0)) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#aac1de8e0f22b726a87a3991f0aee1bf1">   57</a></span>&#160;<a class="code" href="../../d5/d94/classPktHandler.html#aac1de8e0f22b726a87a3991f0aee1bf1">PktHandler::PktHandler</a>(<a class="code" href="../../d8/dfe/classAgent.html">Agent</a> *agent, <a class="code" href="../../d3/d55/classPktModule.html">PktModule</a> *pkt_module) :</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    stats_(), agent_(agent), pkt_module_(pkt_module),</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    work_queue_(<a class="code" href="../../df/ddc/classTaskScheduler.html">TaskScheduler</a>::GetInstance()-&gt;GetTaskId(<span class="stringliteral">&quot;Agent::PktHandler&quot;</span>), 0,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                boost::bind(&amp;<a class="code" href="../../d5/d94/classPktHandler.html">PktHandler</a>::ProcessPacket, this, _1)),</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    work_queue_bfd_ka_(<a class="code" href="../../df/ddc/classTaskScheduler.html">TaskScheduler</a>::GetInstance()-&gt;GetTaskId(<span class="stringliteral">&quot;Agent::BFD_KA&quot;</span>), 0,</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                boost::bind(&amp;<a class="code" href="../../d5/d94/classPktHandler.html">PktHandler</a>::ProcessBfdDataPacket, this, _1))</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#ae46544244f80b3d8b64b069f3b42f407">work_queue_</a>.<a class="code" href="../../d4/d0c/classWorkQueue.html#adfdf14c9aec59ed072c3e6447d0d1253">set_name</a>(<span class="stringliteral">&quot;Packet Handler Queue&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#ae46544244f80b3d8b64b069f3b42f407">work_queue_</a>.<a class="code" href="../../d4/d0c/classWorkQueue.html#af03022fb8a22a406467c293371b2a5cc">set_measure_busy_time</a>(<a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a18c4d54957310b7374e8cb9f8be6cf63">MeasureQueueDelay</a>());</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// BFD keep alive packet processing</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#a6e58aed3cda30f9f586c2e4e89007f67">work_queue_bfd_ka_</a>.<a class="code" href="../../d4/d0c/classWorkQueue.html#adfdf14c9aec59ed072c3e6447d0d1253">set_name</a>(<span class="stringliteral">&quot;Packet BFD Data Queue&quot;</span>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#a6e58aed3cda30f9f586c2e4e89007f67">work_queue_bfd_ka_</a>.<a class="code" href="../../d4/d0c/classWorkQueue.html#af03022fb8a22a406467c293371b2a5cc">set_measure_busy_time</a>(<a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a18c4d54957310b7374e8cb9f8be6cf63">MeasureQueueDelay</a>());</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a4b5663f56c7bf149f0c101a235f565c0">MAX_MODULES</a>; ++i) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">if</span> (i == <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a5b2afa6c9e384c5b3546911393a71c84">PktHandler::DHCP</a> || i == <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a2615c28e77125c06a1780277b5d611c9">PktHandler::DHCPV6</a> ||</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            i == <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a62b35a24c63c7f5531b5d57fe591270b">PktHandler::DNS</a>)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <a class="code" href="../../d5/d94/classPktHandler.html#aa56e12e1b77b0cfb23304cf9e261091b">pkt_trace_</a>.at(i).set_pkt_trace_size(512);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <a class="code" href="../../d5/d94/classPktHandler.html#aa56e12e1b77b0cfb23304cf9e261091b">pkt_trace_</a>.at(i).set_pkt_trace_size(128);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a6cc161858b09da22735f55b9ef03e28d">   78</a></span>&#160;<a class="code" href="../../d5/d94/classPktHandler.html#a6cc161858b09da22735f55b9ef03e28d">PktHandler::~PktHandler</a>() {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#ae46544244f80b3d8b64b069f3b42f407">work_queue_</a>.<a class="code" href="../../d4/d0c/classWorkQueue.html#a6749fce09b480760e1313b900a1938c0">Shutdown</a>();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a6a027fcf855ef847da27b8d3b1ae3051">   82</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/d94/classPktHandler.html#ab7ee36f7e26e1db0d30ba8d73f87e599">PktHandler::Register</a>(<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktModuleName</a> <a class="code" href="../../de/dcb/load__balance_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>, <a class="code" href="../../db/de3/classProto.html">Proto</a> *proto) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#aad1c6cf849c57ec2e075359a4a3c4e38">proto_list_</a>.at(type) = proto;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">if</span> (type == <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a27ef3a8980fccb05a5eaa9c85f2b5381">BFD</a>) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#a5e114cd19dfa6c18ad7ac81818277033">bfd_keepalive_proto_</a> = proto;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#afb079cbeb881272cb3295d033776d969">   89</a></span>&#160;uint32_t <a class="code" href="../../d5/d94/classPktHandler.html#afb079cbeb881272cb3295d033776d969">PktHandler::EncapHeaderLen</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a336b21bbbce890ea37d6e47abaac3900">pkt</a>()-&gt;<a class="code" href="../../d3/d55/classPktModule.html#a874f11abcbbe5f4f6d378838652d0903">control_interface</a>()-&gt;<a class="code" href="../../dc/d1d/classControlInterface.html#a651a304463ac9b3849a3d75f96a9050b">EncapsulationLength</a>();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;}</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">// Send packet to tap interface</span></div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a3cd8698f2530bbaa2dd347492dda8c18">   94</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/d94/classPktHandler.html#a3cd8698f2530bbaa2dd347492dda8c18">PktHandler::Send</a>(<span class="keyword">const</span> <a class="code" href="../../d6/d0d/structAgentHdr.html">AgentHdr</a> &amp;hdr, <span class="keyword">const</span> <a class="code" href="../../d4/dc5/packet__buffer_8h.html#a78def6b5ee9b81aaa6519da4cf9253bb">PacketBufferPtr</a> &amp;buff) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#a088c671feb2ecacc7b0f56ee1e513106">stats_</a>.<a class="code" href="../../dd/d88/structPktHandler_1_1PktStats.html#af5e6cd88c360f963267fa99e947bb307">PktSent</a>(<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktHandler::PktModuleName</a>(buff-&gt;module()));</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#aa56e12e1b77b0cfb23304cf9e261091b">pkt_trace_</a>.at(buff-&gt;module()).<a class="code" href="../../d5/d94/classPktHandler.html#aa0229bb40fa7ad85f4289257ab1550a0">AddPktTrace</a>(<a class="code" href="../../db/d26/classPktTrace.html#a8f01b6f2de3e08339e52afa91deb7faba16f5274796dd53156f532ba06345fb82">PktTrace::Out</a>, buff-&gt;data_len(),</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                              buff-&gt;data(), &amp;hdr);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a336b21bbbce890ea37d6e47abaac3900">pkt</a>()-&gt;<a class="code" href="../../d3/d55/classPktModule.html#a874f11abcbbe5f4f6d378838652d0903">control_interface</a>()-&gt;<a class="code" href="../../dc/d1d/classControlInterface.html#ad28d2c3b76a3433e8de9559fc911fcd9">Send</a>(hdr, buff) &lt;= 0) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="../../df/d76/pkt__handler_8cc.html#a3517b6542d72a569bd903923b6413b65">PKT_TRACE</a>(Err, <span class="stringliteral">&quot;Error sending packet&quot;</span>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a73014833ee8846ee22a06178f98a004a">  104</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/d94/classPktHandler.html#a73014833ee8846ee22a06178f98a004a">PktHandler::CalculatePortIP</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d0/dcc/classInterface.html">Interface</a> *in = NULL;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d5/d21/classVmInterface.html">VmInterface</a> *intf = NULL;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d0/dcc/classInterface.html">Interface</a> *pkt_in_intf = NULL;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">bool</span> ingress= <span class="keyword">false</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="../../d5/d21/classVmInterface.html#a5cc9d099287c652b47f28a64fcecb8d6">VmInterface::FatFlowIgnoreAddressType</a> ignore_addr;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    uint8_t protocol;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d4/dec/classNextHop.html">NextHop</a> *nh =</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#af4e822ae7caefed97883db7d64754056">agent</a>()-&gt;<a class="code" href="../../d8/dfe/classAgent.html#afc2cbe5f2dc7a47e06cc0b2c291e4f01">nexthop_table</a>()-&gt;<a class="code" href="../../df/d45/classNextHopTable.html#af380097a60be5a6266180aad98900022">FindNextHop</a>(pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#a755a4601a5bc30acea0c6676acd15701">nh</a>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">if</span> (!nh) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">if</span> (nh-&gt;<a class="code" href="../../d4/dec/classNextHop.html#a0c7a00522d6d540fecb6a2105ae81cfe">GetType</a>() == <a class="code" href="../../d4/dec/classNextHop.html#a6d58ef6d19818df01ad156b9b6f59fc4ac3e16d2a8d4b0350c93aea2d576542e2">NextHop::INTERFACE</a>) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../de/d30/classInterfaceNH.html">InterfaceNH</a> *intf_nh = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../de/d30/classInterfaceNH.html">InterfaceNH</a> *<span class="keyword">&gt;</span>(nh);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        in = intf_nh-&gt;<a class="code" href="../../de/d30/classInterfaceNH.html#a4372449ea4b16b5d92b3e469953346d8">GetInterface</a>();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nh-&gt;<a class="code" href="../../d4/dec/classNextHop.html#a0c7a00522d6d540fecb6a2105ae81cfe">GetType</a>() == <a class="code" href="../../d4/dec/classNextHop.html#a6d58ef6d19818df01ad156b9b6f59fc4a210bb844f475218159b9b231168c42af">NextHop::VLAN</a>) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d0/d47/classVlanNH.html">VlanNH</a> *vlan_nh = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../d0/d47/classVlanNH.html">VlanNH</a> *<span class="keyword">&gt;</span>(nh);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        in = vlan_nh-&gt;<a class="code" href="../../d0/d47/classVlanNH.html#a2a84f33c5405388b8862da7497fb42d4">GetInterface</a>();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nh-&gt;<a class="code" href="../../d4/dec/classNextHop.html#a0c7a00522d6d540fecb6a2105ae81cfe">GetType</a>() == <a class="code" href="../../d4/dec/classNextHop.html#a6d58ef6d19818df01ad156b9b6f59fc4aa93fa4b6343548cfcbebe79125545566">NextHop::COMPOSITE</a>) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../dd/d76/classCompositeNH.html">CompositeNH</a> *comp_nh = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../dd/d76/classCompositeNH.html">CompositeNH</a> *<span class="keyword">&gt;</span>(nh);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">if</span> (comp_nh-&gt;<a class="code" href="../../dd/d76/classCompositeNH.html#acdc48d0091d35e17b87cc50370a82bbd">composite_nh_type</a>() == <a class="code" href="../../de/d98/structComposite.html#a4747d68b2bad61ba02a5223f77690d5ea5d96c2170cd40688986f866367f3d94f">Composite::LOCAL_ECMP</a>) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            in = comp_nh-&gt;<a class="code" href="../../dd/d76/classCompositeNH.html#abfeecd1560f13a5cc4641ad39580126f">GetFirstLocalEcmpMemberInterface</a>();</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (in) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        intf = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../d5/d21/classVmInterface.html">VmInterface</a> *<span class="keyword">&gt;</span>(in);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">if</span> (!intf) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span> (intf-&gt;<a class="code" href="../../d5/d21/classVmInterface.html#a06f4707e09dd3fa51d4c2f92c85c8499">fat_flow_list</a>().<a class="code" href="../../d2/d38/structVmInterface_1_1FatFlowList.html#adac7d614415b749041946a012374bc94">list_</a>.size() == 0) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">if</span> (intf-&gt;<a class="code" href="../../d5/d21/classVmInterface.html#a9e25daa6ea3d8e4be2d960167b995813">ExcludeFromFatFlow</a>(pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a9281e06ce82d613719895da2c92387fd">family</a>, pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6eed2de2e29f912c86902b283e7409c6">ip_saddr</a>, pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3ab06f5a5929302e21be828a77d871b2">ip_daddr</a>)) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    uint16_t sport = pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span> (pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a> == IPPROTO_ICMP || pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a> == IPPROTO_IGMP) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        sport = 0;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    protocol = pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">     * For ICMPv6 change the protocol to ICMP as the same value is used when it is</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">     * stored in the fat flow rule</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">if</span> (pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a> == IPPROTO_ICMPV6) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        protocol = IPPROTO_ICMP;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a9af3e51b7169506f28e8bda89bcd0bf1">is_fat_flow_src_prefix</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a4995336bef3636c36eb26b316a4909d2">is_fat_flow_dst_prefix</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">if</span> (pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> &lt; pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a>) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">if</span> (intf-&gt;<a class="code" href="../../d5/d21/classVmInterface.html#ad9a0aaf675e2fcbdc6e80c3219d1ae2d">IsFatFlowPortBased</a>(protocol, sport, &amp;ignore_addr)) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> = 0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae650c255df1c2a49dedb2f52879c8225">ignore_address</a> = ignore_addr;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">if</span> (intf-&gt;<a class="code" href="../../d5/d21/classVmInterface.html#ad9a0aaf675e2fcbdc6e80c3219d1ae2d">IsFatFlowPortBased</a>(protocol, pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a>, &amp;ignore_addr)) {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> = 0;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae650c255df1c2a49dedb2f52879c8225">ignore_address</a> = ignore_addr;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">if</span> (intf-&gt;<a class="code" href="../../d5/d21/classVmInterface.html#ad9a0aaf675e2fcbdc6e80c3219d1ae2d">IsFatFlowPortBased</a>(protocol, pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a>, &amp;ignore_addr)) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">if</span> (pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> == pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a>) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6ef73e7d009958107f73525b87729648">same_port_number</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> = 0;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae650c255df1c2a49dedb2f52879c8225">ignore_address</a> = ignore_addr;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">if</span> (intf-&gt;<a class="code" href="../../d5/d21/classVmInterface.html#ad9a0aaf675e2fcbdc6e80c3219d1ae2d">IsFatFlowPortBased</a>(protocol, sport, &amp;ignore_addr)) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> = 0;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae650c255df1c2a49dedb2f52879c8225">ignore_address</a> = ignore_addr;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">/* If Fat-flow port is 0, then both source and destination ports have to</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">     * be ignored */</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">if</span> (intf-&gt;<a class="code" href="../../d5/d21/classVmInterface.html#ad9a0aaf675e2fcbdc6e80c3219d1ae2d">IsFatFlowPortBased</a>(protocol, 0, &amp;ignore_addr)) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> = 0;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> = 0;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae650c255df1c2a49dedb2f52879c8225">ignore_address</a> = ignore_addr;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// Check for fat flow based on prefix aggregation</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    pkt_in_intf = <a class="code" href="../../d8/dfe/classAgent.html#ab8529257124b8dcc9273d1d77c26111b">Agent::GetInstance</a>()-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a1763098920517b4774b95a4287ac71d0">interface_table</a>()-&gt;<a class="code" href="../../d2/d73/classInterfaceTable.html#a3460257f9b0fa13a0f7104f38d835aa3">FindInterface</a>(</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                                       pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#a542c76d864fa60bfc5cc62446cd4c142">ifindex</a>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    ingress = <a class="code" href="../../d5/d5e/classPktFlowInfo.html#aeb9254d3b8a854c9a37216fee0d99ecb">PktFlowInfo::ComputeDirection</a>(pkt_in_intf);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// set the src and dst prefix to src &amp; dst ip to begin with</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3bd2813e39e9762613998eebeeb41298">ip_ff_src_prefix</a> = pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6eed2de2e29f912c86902b283e7409c6">ip_saddr</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a9ce84d4ac75e447a71244cb9101fb976">ip_ff_dst_prefix</a> = pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3ab06f5a5929302e21be828a77d871b2">ip_daddr</a>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    intf-&gt;<a class="code" href="../../d5/d21/classVmInterface.html#ac3633d62916d00d278461a5498006d7c">IsFatFlowPrefixAggregation</a>(ingress, protocol,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                     (uint16_t *)&amp;pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a>,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                     (uint16_t *) &amp;pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a>,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                     &amp;pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6ef73e7d009958107f73525b87729648">same_port_number</a>,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                     &amp;pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3bd2813e39e9762613998eebeeb41298">ip_ff_src_prefix</a>,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                     &amp;pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a9ce84d4ac75e447a71244cb9101fb976">ip_ff_dst_prefix</a>,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                     &amp;pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a9af3e51b7169506f28e8bda89bcd0bf1">is_fat_flow_src_prefix</a>,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                     &amp;pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a4995336bef3636c36eb26b316a4909d2">is_fat_flow_dst_prefix</a>,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                     &amp;pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae650c255df1c2a49dedb2f52879c8225">ignore_address</a>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a8d2ca1d7adad973774c0e8803b9740bd">  219</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/d94/classPktHandler.html#a8d2ca1d7adad973774c0e8803b9740bd">PktHandler::IsBFDHealthCheckPacket</a>(<span class="keyword">const</span> <a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                        <span class="keyword">const</span> <a class="code" href="../../d0/dcc/classInterface.html">Interface</a> *intrface) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span> (intrface-&gt;<a class="code" href="../../d0/dcc/classInterface.html#aa4e925f921176be2ba014008dadde813">type</a>() == <a class="code" href="../../d0/dcc/classInterface.html#a01562cbfcb9c8793a7117b67ee0ce079a237f863154018d4c85568c225fa4a826">Interface::VM_INTERFACE</a> &amp;&amp;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a> == IPPROTO_UDP &amp;&amp;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#ad7d59d1b04d238b6273b44205c0ae8b3">BFD_SINGLEHOP_CONTROL_PORT</a> ||</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;         pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#acd3e54d24cdaa5f9c3f6440bcfffbe35">BFD_MULTIHOP_CONTROL_PORT</a> ||</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;         pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#a3718f13a4255901a5cd24fb3ad114ba6">BFD_ECHO_PORT</a>)) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a66261e744933110998a856d1459cfc41">  232</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/d94/classPktHandler.html#a66261e744933110998a856d1459cfc41">PktHandler::IsSegmentHealthCheckPacket</a>(<span class="keyword">const</span> <a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info,</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="../../d0/dcc/classInterface.html">Interface</a> *intrface) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">if</span> (intrface-&gt;<a class="code" href="../../d0/dcc/classInterface.html#aa4e925f921176be2ba014008dadde813">type</a>() == <a class="code" href="../../d0/dcc/classInterface.html#a01562cbfcb9c8793a7117b67ee0ce079a237f863154018d4c85568c225fa4a826">Interface::VM_INTERFACE</a> &amp;&amp;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a> == IPPROTO_ICMP) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a67e30904a9eab1f8993ba3f21bbc5e2e">icmp_chksum</a> == 0xffff) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">return</span> pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a8e6f2f0c80abcd030b2ecb4aef49abc2">is_segment_hc_pkt</a>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">// Validate the BFD Keepalive packet received</span></div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a3e3d144bdc73a0953eeade164fbb465b">  245</a></span>&#160;<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktHandler::PktModuleName</a> <a class="code" href="../../d5/d94/classPktHandler.html#a3e3d144bdc73a0953eeade164fbb465b">PktHandler::ParseBfdDataPacket</a>(<span class="keyword">const</span> <a class="code" href="../../d6/d0d/structAgentHdr.html">AgentHdr</a> &amp;hdr,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                                  <a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                                  uint8_t *pkt) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadb">PktType::Type</a> pkt_type = <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba35ce819a4b8389aab264fa447c3c04cd">PktType::INVALID</a>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a> = hdr;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordtype">int</span> len = 0, ret = 0;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// Parse packet before computing forwarding mode. Packet is parsed</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// independent of packet forwarding mode</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    len += <a class="code" href="../../d5/d94/classPktHandler.html#a50dc12a5515d56cc7eaa24577ab63e60">ParseEthernetHeader</a>(pkt_info, (pkt + len));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> != ETHERTYPE_IP) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a98ebefc0499e93352429ddc6f94edf6f">stats</a>()-&gt;<a class="code" href="../../d0/d98/classAgentStats.html#a704d954054be10ccea3cf69339e7199e">incr_pkt_drop_due_to_invalid_ethertype</a>();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a702d2d11f6301be930500864558697e4">INVALID</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// IP Packets</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    ret = <a class="code" href="../../d5/d94/classPktHandler.html#a8a1c95720fadfccc29c159b1a4550c39">ParseIpPacket</a>(pkt_info, pkt_type, (pkt + len));</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">if</span>(ret == -1) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a702d2d11f6301be930500864558697e4">INVALID</a>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    len += ret;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// Check if the BFD KA packet</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a> == IPPROTO_UDP &amp;&amp;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#ad7d59d1b04d238b6273b44205c0ae8b3">BFD_SINGLEHOP_CONTROL_PORT</a> &amp;&amp;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6aed8011421e47e8fef0273ab76d2be9">data</a>[0] &amp; 0x20)) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a27ef3a8980fccb05a5eaa9c85f2b5381">BFD</a>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a702d2d11f6301be930500864558697e4">INVALID</a>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">// Process the packet received from tap interface</span></div>
<div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#ab76ff6fdbb8faef0342d429ef6c83911">  280</a></span>&#160;<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktHandler::PktModuleName</a> <a class="code" href="../../d5/d94/classPktHandler.html#ab76ff6fdbb8faef0342d429ef6c83911">PktHandler::ParsePacket</a>(<span class="keyword">const</span> <a class="code" href="../../d6/d0d/structAgentHdr.html">AgentHdr</a> &amp;hdr,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                                  <a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                                  uint8_t *pkt) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadb">PktType::Type</a> pkt_type = <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba35ce819a4b8389aab264fa447c3c04cd">PktType::INVALID</a>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="../../d0/dcc/classInterface.html">Interface</a> *intf = NULL;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a> = hdr;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d94/classPktHandler.html#a85fdbc6698073189ea5c88a91148f0da">IsValidInterface</a>(hdr.<a class="code" href="../../d6/d0d/structAgentHdr.html#a542c76d864fa60bfc5cc62446cd4c142">ifindex</a>, &amp;intf)) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a702d2d11f6301be930500864558697e4">INVALID</a>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// Parse packet before computing forwarding mode. Packet is parsed</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// indepndent of packet forwarding mode</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d94/classPktHandler.html#aa22e71944d69f51845c18f88403b34d1">ParseUserPkt</a>(pkt_info, intf, pkt_type, pkt) &lt; 0) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a702d2d11f6301be930500864558697e4">INVALID</a>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3affceed1c7808f47a4d18c3035c2cca4e">AgentHdr::TRAP_TOR_CONTROL_PKT</a>) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="comment">// In case of a control packet from a TOR served by us, the ifindex</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="comment">// is modified to index of the VM interface; validate this interface.</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d94/classPktHandler.html#a85fdbc6698073189ea5c88a91148f0da">IsValidInterface</a>(pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#a542c76d864fa60bfc5cc62446cd4c142">ifindex</a>, &amp;intf)) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a702d2d11f6301be930500864558697e4">INVALID</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a1ea3136967b011ba7b21434bf8e9fbeb">vrf</a> = pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#ac279c0e6b1be3e9073f05188110aab4b">vrf</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span> (hdr.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3a290412c5ecc7974634855681ff774fe7">AgentHdr::TRAP_MAC_MOVE</a> ||</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        hdr.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3abb5b21d6fa7ea8735a4f67d331a7761f">AgentHdr::TRAP_MAC_LEARN</a> ||</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        hdr.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3ad25b645581878127a5d53670bc63f794">AgentHdr::TRAP_MAC_IP_LEARNING</a>) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a6f5182892fafb5ab237d01e0b540e76a">MAC_LEARNING</a>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordtype">bool</span> is_flow_packet = <a class="code" href="../../d5/d94/classPktHandler.html#af01d4924dbbcf7d0724635ca73e70067">IsFlowPacket</a>(pkt_info);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">// Look for DHCP packets if corresponding service is enabled</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">// Service processing over-rides ACL/Flow and forwarding configuration</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">if</span> (!is_flow_packet &amp;&amp; intf-&gt;<a class="code" href="../../d0/dcc/classInterface.html#ae1235bd5224278a806a0754101e447d5">dhcp_enabled</a>() &amp;&amp; (pkt_type == <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba28c9d988e5eca834aad2016b5e7ec126">PktType::UDP</a>)) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aa8d254e49c0d126842fa59208310500d">ip</a> &amp;&amp; (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#a478f5be6fb4bfb09b235bb50cf806cc9">DHCP_SERVER_PORT</a> ||</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                             pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#a23dd788b1cd28a0d834c3afefceaa1c1">DHCP_CLIENT_PORT</a>)) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a5b2afa6c9e384c5b3546911393a71c84">DHCP</a>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">if</span> (!is_flow_packet &amp;&amp; intf-&gt;<a class="code" href="../../d0/dcc/classInterface.html#aeff297caef8ced9c6b53c6633be506f2">dhcp_enabled_v6</a>() &amp;&amp; (pkt_type == <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba28c9d988e5eca834aad2016b5e7ec126">PktType::UDP</a>)) {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a15c8da40fb20b302d0ed43143d45c4e1">ip6</a> &amp;&amp; (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#ab2fd1889bb669d854b61d4a5fee3e3ec">DHCPV6_SERVER_PORT</a> ||</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                              pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#a6802d48c8c3b96baafb23641a82f43a0">DHCPV6_CLIENT_PORT</a>)) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a2615c28e77125c06a1780277b5d611c9">DHCPV6</a>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// Handle ARP packet</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">if</span> (pkt_type == <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba1daf0a0fe1b27e1facfa38c4607ddc1f">PktType::ARP</a>) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a7e0a812f8f37f686b0aa22450a7217e9">ARP</a>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">// Packets needing flow</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">if</span> (is_flow_packet) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#a73014833ee8846ee22a06178f98a004a">CalculatePortIP</a>(pkt_info);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">if</span> ((pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aa8d254e49c0d126842fa59208310500d">ip</a> &amp;&amp; pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a9281e06ce82d613719895da2c92387fd">family</a> == <a class="code" href="../../de/d6b/classAddress.html#a58d0c167a9c218030c678110e9e69987a1d93db3747cf6c75ab622601c30544a0">Address::INET</a>) ||</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a15c8da40fb20b302d0ed43143d45c4e1">ip6</a> &amp;&amp; pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a9281e06ce82d613719895da2c92387fd">family</a> == <a class="code" href="../../de/d6b/classAddress.html#a58d0c167a9c218030c678110e9e69987aa474968a53fad182e1b6340dd2eb80fc">Address::INET6</a>)) {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a5457c47d7cbee5842a46e62c3cd3257d">FLOW</a>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <a class="code" href="../../df/d76/pkt__handler_8cc.html#a3517b6542d72a569bd903923b6413b65">PKT_TRACE</a>(Err, <span class="stringliteral">&quot;Flow trap for non-IP packet for interface &quot;</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                      <span class="stringliteral">&quot;index &lt;&quot;</span> &lt;&lt; hdr.<a class="code" href="../../d6/d0d/structAgentHdr.html#a542c76d864fa60bfc5cc62446cd4c142">ifindex</a> &lt;&lt; <span class="stringliteral">&quot;&gt;&quot;</span>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a98ebefc0499e93352429ddc6f94edf6f">stats</a>()-&gt;<a class="code" href="../../d0/d98/classAgentStats.html#a149b6d9b1572347fc09c407ca18d9760">pkt_drop_due_to_flow_trap</a>();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a702d2d11f6301be930500864558697e4">INVALID</a>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// Look for DNS packets if corresponding service is enabled</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">// Service processing over-rides ACL/Flow</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">if</span> (intf-&gt;<a class="code" href="../../d0/dcc/classInterface.html#aaa22b71198a348ff9f0af382037e3270">dns_enabled</a>() &amp;&amp; (pkt_type == <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba28c9d988e5eca834aad2016b5e7ec126">PktType::UDP</a>)) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> == <a class="code" href="../../da/dea/bind__util_8h.html#a9266b48706648ecf0625a3e651095317">DNS_SERVER_PORT</a>) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a62b35a24c63c7f5531b5d57fe591270b">DNS</a>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">// Look for IP packets that need ARP resolution</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aa8d254e49c0d126842fa59208310500d">ip</a> &amp;&amp; hdr.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3acd2cc501e3251055cb416831d661c7aa">AgentHdr::TRAP_RESOLVE</a>) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a7e0a812f8f37f686b0aa22450a7217e9">ARP</a>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// send time exceeded ICMP messages to diag module</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d94/classPktHandler.html#a981101851eceaed34989aa4d1fdf46c4">IsDiagPacket</a>(pkt_info)) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a4c57cf83e556f72b36832ef761f4d948">DIAG</a>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d94/classPktHandler.html#a8d2ca1d7adad973774c0e8803b9740bd">IsBFDHealthCheckPacket</a>(pkt_info, intf)) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a27ef3a8980fccb05a5eaa9c85f2b5381">BFD</a>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">if</span> (pkt_type == <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba1700208778f79af64c7597d7698fd3f5">PktType::ICMP</a> &amp;&amp; <a class="code" href="../../d5/d94/classPktHandler.html#a66261e744933110998a856d1459cfc41">IsSegmentHealthCheckPacket</a>(pkt_info,</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                                                intf)) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a4c57cf83e556f72b36832ef761f4d948">DIAG</a>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">if</span> (pkt_type == <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba1700208778f79af64c7597d7698fd3f5">PktType::ICMP</a> &amp;&amp; <a class="code" href="../../d5/d94/classPktHandler.html#a4563e5d1e5fca94bfa6e374ec9e351fe">IsGwPacket</a>(intf, pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3ab06f5a5929302e21be828a77d871b2">ip_daddr</a>)) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a511c55b798be91247fc718d88aee9be2">ICMP</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// Look for IP6 packets that need NDP resolution</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a15c8da40fb20b302d0ed43143d45c4e1">ip6</a> &amp;&amp; hdr.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3acd2cc501e3251055cb416831d661c7aa">AgentHdr::TRAP_RESOLVE</a>) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a8148fafd9dad7090f48ba61e25a24e2e">ICMPV6</a>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">if</span> (pkt_type == <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba942e0faa3993a8390540f56f22ed0dfd">PktType::ICMPV6</a>) {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="keywordflow">if</span> (hdr.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3ae817adc4b2f152f1b666c8ca6c3451a9">AgentHdr::TRAP_HANDLE_DF</a>) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a435658619a4a080ccfe55462edf90f32">ICMPV6_ERROR</a>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a8148fafd9dad7090f48ba61e25a24e2e">ICMPV6</a>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">if</span> (pkt_type == <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadbad56b7425cb4e0085c953056bdb25293b">PktType::IGMP</a>) {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a6f33188a1cd8241668f980e455d0ad36">IGMP</a>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">if</span>(pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a15c8da40fb20b302d0ed43143d45c4e1">ip6</a> &amp;&amp; hdr.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3ae817adc4b2f152f1b666c8ca6c3451a9">AgentHdr::TRAP_HANDLE_DF</a>) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;       <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a435658619a4a080ccfe55462edf90f32">ICMPV6_ERROR</a>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aa8d254e49c0d126842fa59208310500d">ip</a> &amp;&amp; hdr.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3ae817adc4b2f152f1b666c8ca6c3451a9">AgentHdr::TRAP_HANDLE_DF</a>) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a686ca81e66d03b10cc7516ffc5c63162">ICMP_ERROR</a>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">if</span> (hdr.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3a83e2e344eeb4c075f179033b264db1ee">AgentHdr::TRAP_DIAG</a> &amp;&amp; (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aa8d254e49c0d126842fa59208310500d">ip</a> || pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a15c8da40fb20b302d0ed43143d45c4e1">ip6</a>)) {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a4c57cf83e556f72b36832ef761f4d948">DIAG</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a702d2d11f6301be930500864558697e4">INVALID</a>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;}</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a980ef2a9eb9a7b57757c84127a512d84">  411</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/d94/classPktHandler.html#a980ef2a9eb9a7b57757c84127a512d84">PktHandler::HandleRcvPkt</a>(<span class="keyword">const</span> <a class="code" href="../../d6/d0d/structAgentHdr.html">AgentHdr</a> &amp;hdr, <span class="keyword">const</span> <a class="code" href="../../d4/dc5/packet__buffer_8h.html#a78def6b5ee9b81aaa6519da4cf9253bb">PacketBufferPtr</a> &amp;buff){</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">// Enqueue packets to a workqueue to decouple from ASIO and run in</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">// exclusion with DB</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    boost::shared_ptr&lt;PacketBufferEnqueueItem&gt;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        info(<span class="keyword">new</span> <a class="code" href="../../df/db3/structPktHandler_1_1PacketBufferEnqueueItem.html">PacketBufferEnqueueItem</a>(hdr, buff));</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// BFD Keepalive packets are enqueued to a seperate work queue</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// so that its job run without dependence on dB tasks</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">if</span> (IsBfdkeepalivePkt(hdr)) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#a6e58aed3cda30f9f586c2e4e89007f67">work_queue_bfd_ka_</a>.<a class="code" href="../../d4/d0c/classWorkQueue.html#a1cd8582cc7cdc534693e9278b27b5f41">Enqueue</a>(info);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#ae46544244f80b3d8b64b069f3b42f407">work_queue_</a>.<a class="code" href="../../d4/d0c/classWorkQueue.html#a1cd8582cc7cdc534693e9278b27b5f41">Enqueue</a>(info);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;}</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#ab75389b995b14046e27951ebe13cc613">  426</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/d94/classPktHandler.html#ab75389b995b14046e27951ebe13cc613">PktHandler::ProcessPacket</a>(boost::shared_ptr&lt;PacketBufferEnqueueItem&gt; item) {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a98ebefc0499e93352429ddc6f94edf6f">stats</a>()-&gt;<a class="code" href="../../d0/d98/classAgentStats.html#adf4bcf3965777fa50545ff13520e5bf0">incr_pkt_exceptions</a>();</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d6/d0d/structAgentHdr.html">AgentHdr</a> &amp;hdr = item-&gt;hdr;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d4/dc5/packet__buffer_8h.html#a78def6b5ee9b81aaa6519da4cf9253bb">PacketBufferPtr</a> &amp;buff = item-&gt;buff;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    boost::shared_ptr&lt;PktInfo&gt; pkt_info (<span class="keyword">new</span> <a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a>(buff));</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    uint8_t *pkt = buff-&gt;data();</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktModuleName</a> mod = <a class="code" href="../../d5/d94/classPktHandler.html#ab76ff6fdbb8faef0342d429ef6c83911">ParsePacket</a>(hdr, pkt_info.get(), pkt);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#a39c8eb9481f19738c0a5ef2e1124ab7d">PktModuleEnqueue</a>(mod, hdr, pkt_info, pkt);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span> (mod == <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a702d2d11f6301be930500864558697e4">INVALID</a>) {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        pkt_info.reset();</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;}</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">// Process BFD keepalives (BFD packets with state &#39;UP&#39;) in a seperate task</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">// that is independent of Db Task</span></div>
<div class="line"><a name="l00442"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#ad2d7f1001fb4bf535f88d990e83d7c18">  442</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/d94/classPktHandler.html#ad2d7f1001fb4bf535f88d990e83d7c18">PktHandler::ProcessBfdDataPacket</a>(boost::shared_ptr&lt;PacketBufferEnqueueItem&gt; item) {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d6/d0d/structAgentHdr.html">AgentHdr</a> &amp;hdr = item-&gt;hdr;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d4/dc5/packet__buffer_8h.html#a78def6b5ee9b81aaa6519da4cf9253bb">PacketBufferPtr</a> &amp;buff = item-&gt;buff;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    uint8_t *pkt = buff-&gt;data();</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktModuleName</a> mod;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">// In certain Agent restart race condition, Agent would restart but</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">// vrouter is not in sync yet with agent restart. In this condition</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">// there could be BFD packets from the prior session could be trapped</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">// in vrouter and injected to the Agent&#39;s PKT0 i/f So, don&#39;t process</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">// BFD packets received, prior to agent init done.</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d94/classPktHandler.html#a5e114cd19dfa6c18ad7ac81818277033">bfd_keepalive_proto_</a> || (<a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a1aa71c3ba17bdad2992bad37627155cf">init_done</a>() == <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <a class="code" href="../../df/d76/pkt__handler_8cc.html#a3517b6542d72a569bd903923b6413b65">PKT_TRACE</a>(Err, <span class="stringliteral">&quot;BFD proto_list is not Initialized. Ignoring&quot;</span>);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    boost::shared_ptr&lt;PktInfo&gt; pkt_info (<span class="keyword">new</span> <a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a>(buff));</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    mod = <a class="code" href="../../d5/d94/classPktHandler.html#a3e3d144bdc73a0953eeade164fbb465b">ParseBfdDataPacket</a>(hdr, pkt_info.get(), pkt);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">if</span> (mod == <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a27ef3a8980fccb05a5eaa9c85f2b5381">BFD</a>) {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        pkt_info-&gt;is_bfd_keepalive = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        pkt_info-&gt;packet_buffer()-&gt;set_module(mod);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#a5e114cd19dfa6c18ad7ac81818277033">bfd_keepalive_proto_</a>-&gt;<a class="code" href="../../db/de3/classProto.html#a3b0e1a3ecd60473dfd0a69bb7c71f314">Enqueue</a>(pkt_info);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#aad1c6cf849c57ec2e075359a4a3c4e38">proto_list_</a>.at(<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a27ef3a8980fccb05a5eaa9c85f2b5381">BFD</a>)-&gt;ProcessStats(<a class="code" href="../../d5/d67/structPktStatsType.html#a525d0f71edc19ac0d482b274fdc13866a8e63441a554994188c09fc3911c67433">PktStatsType::PKT_RX_ENQUEUE</a>);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#aad1c6cf849c57ec2e075359a4a3c4e38">proto_list_</a>.at(<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a27ef3a8980fccb05a5eaa9c85f2b5381">BFD</a>)-&gt;ProcessStats(<a class="code" href="../../d5/d67/structPktStatsType.html#a525d0f71edc19ac0d482b274fdc13866a3c143d7726883d91959803345798372d">PktStatsType::PKT_RX_DROP_STATS</a>);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        pkt_info.reset();</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;}</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div>
<div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a39c8eb9481f19738c0a5ef2e1124ab7d">  472</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/d94/classPktHandler.html#a39c8eb9481f19738c0a5ef2e1124ab7d">PktHandler::PktModuleEnqueue</a>(<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktModuleName</a> mod, <span class="keyword">const</span> <a class="code" href="../../d6/d0d/structAgentHdr.html">AgentHdr</a> &amp;hdr,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                  boost::shared_ptr&lt;PktInfo&gt; pkt_info,</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                  uint8_t * pkt) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    pkt_info-&gt;packet_buffer()-&gt;set_module(mod);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#a088c671feb2ecacc7b0f56ee1e513106">stats_</a>.<a class="code" href="../../dd/d88/structPktHandler_1_1PktStats.html#a04f2c7f99b21f1517690548ce2f1aff8">PktRcvd</a>(mod);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">if</span> (mod == <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a702d2d11f6301be930500864558697e4">INVALID</a>) {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a98ebefc0499e93352429ddc6f94edf6f">stats</a>()-&gt;<a class="code" href="../../d0/d98/classAgentStats.html#a37ce3527fae3a6da0ca1fec196d1bd8a">incr_pkt_dropped</a>();</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#aa56e12e1b77b0cfb23304cf9e261091b">pkt_trace_</a>.at(mod).AddPktTrace(<a class="code" href="../../db/d26/classPktTrace.html#a8f01b6f2de3e08339e52afa91deb7fabaf28f823e77efd2ce7c08340332eebf02">PktTrace::In</a>, pkt_info-&gt;len, pkt, &amp;hdr);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#aa0580e8caa3ba13ba8696a1968034cea">Enqueue</a>(mod, pkt_info);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">// Compute L2/L3 forwarding mode for pacekt.</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">// Forwarding mode is L3 if,</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">// - Packet uses L3 label</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">// - DMAC in packet is VRRP Mac or VHOST MAC or receiving physical interface MAC</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">// Else forwarding mode is L2</span></div>
<div class="line"><a name="l00490"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#af73c2241648fa8fe1c226780b2b938e1">  490</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/d94/classPktHandler.html#af73c2241648fa8fe1c226780b2b938e1">PktHandler::ComputeForwardingMode</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info,</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="../../d0/dcc/classInterface.html">Interface</a> *intf)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">tunnel</a>.<a class="code" href="../../d6/d6b/structTunnelInfo.html#a152c8ed365b2ce0d0f7a061b34b43281">type</a>.<a class="code" href="../../d3/d08/classTunnelType.html#a9b1ab31bf0bf3d8e704196252696c155">GetType</a>() == <a class="code" href="../../d3/d08/classTunnelType.html#a3848db71a84631798eaa36c12369b977af2160a17fa0eb3713c8e06373a5040e0">TunnelType::MPLS_GRE</a> ||</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">tunnel</a>.<a class="code" href="../../d6/d6b/structTunnelInfo.html#a152c8ed365b2ce0d0f7a061b34b43281">type</a>.<a class="code" href="../../d3/d08/classTunnelType.html#a9b1ab31bf0bf3d8e704196252696c155">GetType</a>() == <a class="code" href="../../d3/d08/classTunnelType.html#a3848db71a84631798eaa36c12369b977a60fb19b5b806258cb4235c3042a7c8b5">TunnelType::MPLS_UDP</a>) {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="keywordflow">return</span> pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab201b710fbcd037a6865a5665e7c5540">l3_label</a>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a1abd34b8ab1a3f6415a551897cb580ed">dmac</a> == <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#ab6d30c99e876ef87e4d7a752bdcd2be2">vrrp_mac</a>()) {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a1abd34b8ab1a3f6415a551897cb580ed">dmac</a> == <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#abbc0825c7dfc8d97dd49c46b8b842352">vhost_interface</a>()-&gt;<a class="code" href="../../d0/dcc/classInterface.html#abb83064a529ab788f6ca5cd8592def91">mac</a>()) {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">if</span> (intf &amp;&amp; intf-&gt;<a class="code" href="../../d0/dcc/classInterface.html#aa4e925f921176be2ba014008dadde813">type</a>() == <a class="code" href="../../d0/dcc/classInterface.html#a01562cbfcb9c8793a7117b67ee0ce079a726374ecb3fd1af3633980e6fe2d24eb">Interface::PHYSICAL</a> &amp;&amp;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a1abd34b8ab1a3f6415a551897cb580ed">dmac</a> == intf-&gt;<a class="code" href="../../d0/dcc/classInterface.html#abb83064a529ab788f6ca5cd8592def91">mac</a>()) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;}</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div>
<div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a73f133f5d0c9a5295495b2068f30a6be">  513</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/d94/classPktHandler.html#a73f133f5d0c9a5295495b2068f30a6be">PktHandler::SetOuterIp</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info, uint8_t *pkt) {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> != ETHERTYPE_IP) {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keyword">struct </span>ip *ip_hdr = (<span class="keyword">struct </span>ip *)pkt;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">tunnel</a>.<a class="code" href="../../d6/d6b/structTunnelInfo.html#a50c5f3b118ce5fbb8d3e3b672f598ca2">ip</a> = ip_hdr;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">tunnel</a>.<a class="code" href="../../d6/d6b/structTunnelInfo.html#a6384a1274c1fb64781543fb090fa0960">ip_saddr</a> = ntohl(ip_hdr-&gt;ip_src.s_addr);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">tunnel</a>.<a class="code" href="../../d6/d6b/structTunnelInfo.html#ac83d19aa9af7a0b6ce7d600addcca6a4">ip_daddr</a> = ntohl(ip_hdr-&gt;ip_dst.s_addr);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;}</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div>
<div class="line"><a name="l00523"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a395987d474d0007c24201dfc2d4f89b4">  523</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/d94/classPktHandler.html#a395987d474d0007c24201dfc2d4f89b4">PktHandler::SetOuterMac</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info) {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">tunnel</a>.<a class="code" href="../../d6/d6b/structTunnelInfo.html#a0db8c0a4a1e39b970fcf8c59d03460d8">eth</a> = pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a8ed59fa62263d57ae9c6db08458885f2">eth</a>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;}</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div>
<div class="line"><a name="l00528"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a50dc12a5515d56cc7eaa24577ab63e60">  528</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d94/classPktHandler.html#a50dc12a5515d56cc7eaa24577ab63e60">PktHandler::ParseEthernetHeader</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info, uint8_t *pkt) {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordtype">int</span> len = 0;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a8ed59fa62263d57ae9c6db08458885f2">eth</a> = (<span class="keyword">struct </span>ether_header *) (pkt + len);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a7437bca732f78c630caf19f2fefb49e6">smac</a> = <a class="code" href="../../d3/df5/classMacAddress.html">MacAddress</a>(pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a8ed59fa62263d57ae9c6db08458885f2">eth</a>-&gt;ether_shost);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a1abd34b8ab1a3f6415a551897cb580ed">dmac</a> = <a class="code" href="../../d3/df5/classMacAddress.html">MacAddress</a>(pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a8ed59fa62263d57ae9c6db08458885f2">eth</a>-&gt;ether_dhost);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> = ntohs(pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a8ed59fa62263d57ae9c6db08458885f2">eth</a>-&gt;ether_type);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    len += <span class="keyword">sizeof</span>(<span class="keyword">struct </span>ether_header);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">//strip service vlan and customer vlan in packet</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">while</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> == ETHERTYPE_VLAN ||</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;           pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#af0130673e6e4e22530d7cfd5d7886f40">ETHERTYPE_QINQ</a>) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> = ntohs(*((uint16_t *)(pkt + len + 2)));</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        len += <a class="code" href="../../d3/d79/pkt__handler_8h.html#afc1644397649e7bc238d7296ed75045d">VLAN_HDR_LEN</a>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#a18139a80e36d86414f457b9959f2aba0">ETHERTYPE_PBB</a>) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="comment">//Parse inner payload</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ac7f5c3451f8a72cc8446c1de29acbae6">pbb_header</a> = (uint32_t *)(pkt + len);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aac0515411ab954657696f52a8a46d5fe">b_smac</a> = pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a7437bca732f78c630caf19f2fefb49e6">smac</a>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ac3a8d8745e7c386d2c61593ce1c430f2">b_dmac</a> = pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a1abd34b8ab1a3f6415a551897cb580ed">dmac</a>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a1d124629460052de977cc0496d5b2a1b">i_sid</a> = ntohl(*(pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ac7f5c3451f8a72cc8446c1de29acbae6">pbb_header</a>)) &amp; 0x00FFFFFF;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        len += <a class="code" href="../../d5/d94/classPktHandler.html#a50dc12a5515d56cc7eaa24577ab63e60">ParseEthernetHeader</a>(pkt_info, pkt + len + <a class="code" href="../../d3/d79/pkt__handler_8h.html#aa512a5683e8e1e95ed9a4be2249186bb">PBB_HEADER_LEN</a>);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;}</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a8a1c95720fadfccc29c159b1a4550c39">  555</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d94/classPktHandler.html#a8a1c95720fadfccc29c159b1a4550c39">PktHandler::ParseIpPacket</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info, <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadb">PktType::Type</a> &amp;pkt_type,</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                              uint8_t *pkt) {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordtype">int</span> len = 0;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    uint16_t ip_payload_len = 0;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> == ETHERTYPE_IP) {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keyword">struct </span>ip *ip = (<span class="keyword">struct </span>ip *)(pkt + len);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aa8d254e49c0d126842fa59208310500d">ip</a> = ip;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a9281e06ce82d613719895da2c92387fd">family</a> = <a class="code" href="../../de/d6b/classAddress.html#a58d0c167a9c218030c678110e9e69987a1d93db3747cf6c75ab622601c30544a0">Address::INET</a>;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6eed2de2e29f912c86902b283e7409c6">ip_saddr</a> = <a class="code" href="../../d9/d9b/address_8h.html#a7055b8d880410aad1e3ba8c041397b6c">IpAddress</a>(<a class="code" href="../../d9/d9b/address_8h.html#ae475599c70b47996f862faa1f265eaa2">Ip4Address</a>(ntohl(ip-&gt;ip_src.s_addr)));</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3ab06f5a5929302e21be828a77d871b2">ip_daddr</a> = <a class="code" href="../../d9/d9b/address_8h.html#a7055b8d880410aad1e3ba8c041397b6c">IpAddress</a>(<a class="code" href="../../d9/d9b/address_8h.html#ae475599c70b47996f862faa1f265eaa2">Ip4Address</a>(ntohl(ip-&gt;ip_dst.s_addr)));</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a> = ip-&gt;ip_p;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a859f1aadf64fad9342375bd71dce2a0a">ttl</a>      = ip-&gt;ip_ttl;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        uint8_t ip_header_len = (ip-&gt;ip_hl &lt;&lt; 2);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        ip_payload_len = ip-&gt;ip_len - ip_header_len;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        len += ip_header_len;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> == ETHERTYPE_IPV6) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a9281e06ce82d613719895da2c92387fd">family</a> = <a class="code" href="../../de/d6b/classAddress.html#a58d0c167a9c218030c678110e9e69987aa474968a53fad182e1b6340dd2eb80fc">Address::INET6</a>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        ip6_hdr *ip = (ip6_hdr *)(pkt + len);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a15c8da40fb20b302d0ed43143d45c4e1">ip6</a> = ip;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aa8d254e49c0d126842fa59208310500d">ip</a> = NULL;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        Ip6Address::bytes_type addr;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 16; i++) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            addr[i] = ip-&gt;ip6_src.s6_addr[i];</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6eed2de2e29f912c86902b283e7409c6">ip_saddr</a> = <a class="code" href="../../d9/d9b/address_8h.html#a7055b8d880410aad1e3ba8c041397b6c">IpAddress</a>(<a class="code" href="../../d9/d9b/address_8h.html#a231be25f722543d7460102bbe5c59f5d">Ip6Address</a>(addr));</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 16; i++) {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            addr[i] = ip-&gt;ip6_dst.s6_addr[i];</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        }</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3ab06f5a5929302e21be828a77d871b2">ip_daddr</a> = <a class="code" href="../../d9/d9b/address_8h.html#a7055b8d880410aad1e3ba8c041397b6c">IpAddress</a>(<a class="code" href="../../d9/d9b/address_8h.html#a231be25f722543d7460102bbe5c59f5d">Ip6Address</a>(addr));</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a859f1aadf64fad9342375bd71dce2a0a">ttl</a>      = ip-&gt;ip6_hlim;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        uint8_t proto = ip-&gt;ip6_ctlun.ip6_un1.ip6_un1_nxt;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        len += <span class="keyword">sizeof</span>(ip6_hdr);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">if</span> (proto == IPPROTO_FRAGMENT) {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            ip6_frag *nxt = (ip6_frag *)(pkt + len);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            proto = nxt-&gt;ip6f_nxt;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            len += <span class="keyword">sizeof</span>(ip6_frag);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a> = proto;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <a class="code" href="../../d5/d77/logging_8h.html#afa4d5ba62ca08799d69d54104884902a">LOG</a>(ERROR,</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;          <span class="stringliteral">&quot;Error EthType = Non IP/IPv6. BackTrace: &quot;</span> &lt;&lt; <a class="code" href="../../d2/d0e/agent_8cc.html#a6d4f9ef75ed60d04c1d67c58010f6e47">AgentBackTrace</a>(1));</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a98ebefc0499e93352429ddc6f94edf6f">stats</a>()-&gt;<a class="code" href="../../d0/d98/classAgentStats.html#a704d954054be10ccea3cf69339e7199e">incr_pkt_drop_due_to_invalid_ethertype</a>();</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;     }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">switch</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a>) {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordflow">case</span> IPPROTO_UDP : {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.<a class="code" href="../../d5/da8/structPktInfo.html#a5d9d0bce6380c0b13e2ee9a46b555504">udp</a> = (udphdr *) (pkt + len);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        len += <span class="keyword">sizeof</span>(udphdr);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6aed8011421e47e8fef0273ab76d2be9">data</a> = (pkt + len);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> = ntohs(pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.<a class="code" href="../../d5/da8/structPktInfo.html#a5d9d0bce6380c0b13e2ee9a46b555504">udp</a>-&gt;uh_dport);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> = ntohs(pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.<a class="code" href="../../d5/da8/structPktInfo.html#a5d9d0bce6380c0b13e2ee9a46b555504">udp</a>-&gt;uh_sport);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        pkt_type = <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba28c9d988e5eca834aad2016b5e7ec126">PktType::UDP</a>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">case</span> IPPROTO_TCP : {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.<a class="code" href="../../d5/da8/structPktInfo.html#af19bde2a39741c02653d9e6c7f4d43af">tcp</a> = (tcphdr *) (pkt + len);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        len += <span class="keyword">sizeof</span>(tcphdr);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6aed8011421e47e8fef0273ab76d2be9">data</a> = (pkt + len);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> = ntohs(pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.<a class="code" href="../../d5/da8/structPktInfo.html#af19bde2a39741c02653d9e6c7f4d43af">tcp</a>-&gt;th_dport);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> = ntohs(pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.<a class="code" href="../../d5/da8/structPktInfo.html#af19bde2a39741c02653d9e6c7f4d43af">tcp</a>-&gt;th_sport);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab5fa2d5a5b81ba51585c53c5ccbe3fbd">tcp_ack</a> = pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.<a class="code" href="../../d5/da8/structPktInfo.html#af19bde2a39741c02653d9e6c7f4d43af">tcp</a>-&gt;th_flags &amp; TH_ACK;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        pkt_type = <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadbae0ec25db0749724ab1fc3c6fd8d2ca03">PktType::TCP</a>;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">case</span> IPPROTO_SCTP : {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.<a class="code" href="../../d5/da8/structPktInfo.html#af8480949e8af30643e3af752fab18eca">sctp</a> = (<a class="code" href="../../d3/d75/structsctphdr.html">sctphdr</a> *) (pkt + len);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        len += <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d75/structsctphdr.html">sctphdr</a>);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6aed8011421e47e8fef0273ab76d2be9">data</a> = (pkt + len);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> = ntohs(pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.<a class="code" href="../../d5/da8/structPktInfo.html#af8480949e8af30643e3af752fab18eca">sctp</a>-&gt;<a class="code" href="../../d3/d75/structsctphdr.html#a601201aa4b3bc795d1942484329deeb4">th_dport</a>);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> = ntohs(pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.<a class="code" href="../../d5/da8/structPktInfo.html#af8480949e8af30643e3af752fab18eca">sctp</a>-&gt;<a class="code" href="../../d3/d75/structsctphdr.html#ad705d320d36799c6de367c16b5e3a8c5">th_sport</a>);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        pkt_type = <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadbae7d90e4d69f8c599bf0d411e9dccfbb8">PktType::SCTP</a>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordflow">case</span> IPPROTO_ICMP: {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.<a class="code" href="../../d5/da8/structPktInfo.html#a508f458d815ed43a04a0b3c6601ab3ba">icmp</a> = (<span class="keyword">struct </span>icmp *) (pkt + len);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        pkt_type = <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba1700208778f79af64c7597d7698fd3f5">PktType::ICMP</a>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keyword">struct </span>icmp *icmp = (<span class="keyword">struct </span>icmp *)(pkt + len);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a67e30904a9eab1f8993ba3f21bbc5e2e">icmp_chksum</a> = icmp-&gt;icmp_cksum;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> = htons(icmp-&gt;icmp_type);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="keywordflow">if</span> (icmp-&gt;icmp_type == ICMP_ECHO || icmp-&gt;icmp_type == ICMP_ECHOREPLY) {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> = ICMP_ECHOREPLY;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> = htons(icmp-&gt;icmp_id);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6aed8011421e47e8fef0273ab76d2be9">data</a> = (pkt + len + ICMP_MINLEN);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            uint16_t icmp_payload_len = ip_payload_len - ICMP_MINLEN;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="keywordflow">if</span> (icmp_payload_len &gt;= <span class="keyword">sizeof</span>(<a class="code" href="../../dd/da9/structAgentDiagPktData.html">AgentDiagPktData</a>)) {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                <a class="code" href="../../dd/da9/structAgentDiagPktData.html">AgentDiagPktData</a> *ad = (<a class="code" href="../../dd/da9/structAgentDiagPktData.html">AgentDiagPktData</a> *)pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6aed8011421e47e8fef0273ab76d2be9">data</a>;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                <span class="keywordtype">string</span> value(ad-&gt;<a class="code" href="../../dd/da9/structAgentDiagPktData.html#afeffc307bef6282f6e12131edecb439f">data_</a>, (<span class="keyword">sizeof</span>(ad-&gt;<a class="code" href="../../dd/da9/structAgentDiagPktData.html#afeffc307bef6282f6e12131edecb439f">data_</a>) - 1));</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                <span class="keywordflow">if</span> (value.compare(0, (<span class="keyword">sizeof</span>(ad-&gt;<a class="code" href="../../dd/da9/structAgentDiagPktData.html#afeffc307bef6282f6e12131edecb439f">data_</a>) - 1),</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                  <a class="code" href="../../dc/d16/classDiagTable.html#a9967a8613e283143fe536988c0f99b9d">DiagTable::kDiagData</a>) == 0) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a8e6f2f0c80abcd030b2ecb4aef49abc2">is_segment_hc_pkt</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d5/d94/classPktHandler.html#af01d4924dbbcf7d0724635ca73e70067">IsFlowPacket</a>(pkt_info) &amp;&amp;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                   ((icmp-&gt;icmp_type == ICMP_DEST_UNREACH) ||</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                    (icmp-&gt;icmp_type == ICMP_TIME_EXCEEDED))) {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            <span class="comment">//Agent has to look at inner payload</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            <span class="comment">//and recalculate the parameter</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            <span class="comment">//Handle this only for packets requiring flow miss</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="../../d5/d94/classPktHandler.html#a8a1c95720fadfccc29c159b1a4550c39">ParseIpPacket</a>(pkt_info, pkt_type, pkt + len + <span class="keyword">sizeof</span>(icmp)) == -1) {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;     <span class="comment">//Swap the key parameter, which would be used as key</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;            <a class="code" href="../../d9/d9b/address_8h.html#a7055b8d880410aad1e3ba8c041397b6c">IpAddress</a> src_ip = pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6eed2de2e29f912c86902b283e7409c6">ip_saddr</a>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6eed2de2e29f912c86902b283e7409c6">ip_saddr</a> = pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3ab06f5a5929302e21be828a77d871b2">ip_daddr</a>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3ab06f5a5929302e21be828a77d871b2">ip_daddr</a> = src_ip;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a> != IPPROTO_ICMP) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                uint16_t port = pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a>;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> = pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> = port;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> = 0;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">case</span> IPPROTO_ICMPV6: {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        pkt_type = <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba942e0faa3993a8390540f56f22ed0dfd">PktType::ICMPV6</a>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        icmp6_hdr *icmp = (icmp6_hdr *)(pkt + len);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.<a class="code" href="../../d5/da8/structPktInfo.html#ade16e16553f1900a8706351c3d93a146">icmp6</a> = icmp;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> = htons(icmp-&gt;icmp6_type);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="keywordflow">if</span> (icmp-&gt;icmp6_type == ICMP6_ECHO_REQUEST ||</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            icmp-&gt;icmp6_type == ICMP6_ECHO_REPLY) {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> = ICMP6_ECHO_REPLY;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> = htons(icmp-&gt;icmp6_id);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d5/d94/classPktHandler.html#af01d4924dbbcf7d0724635ca73e70067">IsFlowPacket</a>(pkt_info) &amp;&amp;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                icmp-&gt;icmp6_type &lt; ICMP6_ECHO_REQUEST) {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <span class="comment">//Agent has to look at inner payload</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            <span class="comment">//and recalculate the parameter</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <span class="comment">//Handle this only for packets requiring flow miss</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="../../d5/d94/classPktHandler.html#a8a1c95720fadfccc29c159b1a4550c39">ParseIpPacket</a>(pkt_info, pkt_type, pkt + len + <span class="keyword">sizeof</span>(icmp)) == -1) {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;     <span class="comment">//Swap the key parameter, which would be used as key</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            <a class="code" href="../../d9/d9b/address_8h.html#a7055b8d880410aad1e3ba8c041397b6c">IpAddress</a> src_ip = pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6eed2de2e29f912c86902b283e7409c6">ip_saddr</a>;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6eed2de2e29f912c86902b283e7409c6">ip_saddr</a> = pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3ab06f5a5929302e21be828a77d871b2">ip_daddr</a>;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3ab06f5a5929302e21be828a77d871b2">ip_daddr</a> = src_ip;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a> != IPPROTO_ICMPV6) {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                uint16_t port = pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a>;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> = pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a>;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> = port;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> = 0;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">case</span> IPPROTO_IGMP: {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.<a class="code" href="../../d5/da8/structPktInfo.html#ab7721d4dc87bf0d887397b2810a0d083">igmp</a> = (<span class="keyword">struct </span>igmp *) (pkt + len);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        pkt_type = <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadbad56b7425cb4e0085c953056bdb25293b">PktType::IGMP</a>;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> = 0;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> = 0;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6aed8011421e47e8fef0273ab76d2be9">data</a> = (pkt + len);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    }</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        pkt_type = <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba34d39d0c108081973a0f030402858fb3">PktType::IP</a>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> = 0;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> = 0;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    }</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;}</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div>
<div class="line"><a name="l00736"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a0ea013a9befa042f10c1d15c7b3d1dac">  736</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d94/classPktHandler.html#a0ea013a9befa042f10c1d15c7b3d1dac">PktHandler::ParseControlWord</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info, uint8_t *pkt,</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="../../df/de8/classMplsLabel.html">MplsLabel</a> *mpls) {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    uint32_t ret = 0;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">if</span> (mpls-&gt;<a class="code" href="../../df/de8/classMplsLabel.html#a5adca64ae757f9d442b01aab4361fc80">IsFabricMulticastReservedLabel</a>() == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="comment">//Check if there is a control word</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        uint32_t *control_word = (uint32_t *)(pkt);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="keywordflow">if</span> (*control_word == <a class="code" href="../../d5/d94/classPktHandler.html#a8ca8e09d434dd226b363f80c908a86d7">kMulticastControlWord</a>) {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab201b710fbcd037a6865a5665e7c5540">l3_label</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            ret += <a class="code" href="../../d5/d94/classPktHandler.html#accba384dfaf9321cfb4f7371ee65c963">kMulticastControlWordSize</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d3c/structVxlanHdr.html">VxlanHdr</a>) +</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                   <span class="keyword">sizeof</span>(udphdr) + <span class="keyword">sizeof</span>(ip);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        }</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab201b710fbcd037a6865a5665e7c5540">l3_label</a> == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="keywordtype">bool</span> layer2_control_word = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../de/d30/classInterfaceNH.html">InterfaceNH</a> *intf_nh =</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../de/d30/classInterfaceNH.html">InterfaceNH</a> *<span class="keyword">&gt;</span>(mpls-&gt;<a class="code" href="../../df/de8/classMplsLabel.html#a120304e249c7b7391d2448a966d21f95">nexthop</a>());</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keywordflow">if</span> (intf_nh &amp;&amp; intf_nh-&gt;<a class="code" href="../../de/d30/classInterfaceNH.html#a9de278ced25b508c010f4d1cdf136745">layer2_control_word</a>()) {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            layer2_control_word = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        }</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../dd/d76/classCompositeNH.html">CompositeNH</a> *comp_nh =</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../dd/d76/classCompositeNH.html">CompositeNH</a> *<span class="keyword">&gt;</span>(mpls-&gt;<a class="code" href="../../df/de8/classMplsLabel.html#a120304e249c7b7391d2448a966d21f95">nexthop</a>());</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="keywordflow">if</span> (comp_nh &amp;&amp; comp_nh-&gt;<a class="code" href="../../dd/d76/classCompositeNH.html#a6522cb5b04b6a0662d28dfddf8c3ba99">layer2_control_word</a>()) {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            layer2_control_word = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d8/da7/classVrfNH.html">VrfNH</a> *vrf_nh =</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../d8/da7/classVrfNH.html">VrfNH</a> *<span class="keyword">&gt;</span>(mpls-&gt;<a class="code" href="../../df/de8/classMplsLabel.html#a120304e249c7b7391d2448a966d21f95">nexthop</a>());</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keywordflow">if</span> (vrf_nh &amp;&amp; vrf_nh-&gt;<a class="code" href="../../d8/da7/classVrfNH.html#a7a5ca1f35f8e5ff1c7b8af2eb3fe00fc">layer2_control_word</a>()) {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            layer2_control_word = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="comment">//Check if there is a control word</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        uint32_t *control_word = (uint32_t *)(pkt);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keywordflow">if</span> (layer2_control_word &amp;&amp; *control_word == <a class="code" href="../../d5/d94/classPktHandler.html#a8ca8e09d434dd226b363f80c908a86d7">kMulticastControlWord</a>) {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            ret += <a class="code" href="../../d5/d94/classPktHandler.html#accba384dfaf9321cfb4f7371ee65c963">kMulticastControlWordSize</a>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;}</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div>
<div class="line"><a name="l00777"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a018bd8003f7dd01e8aa79582f2cedc5a">  777</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d94/classPktHandler.html#a018bd8003f7dd01e8aa79582f2cedc5a">PktHandler::ParseMplsHdr</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info, uint8_t *pkt) {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <a class="code" href="../../d2/db6/structMplsHdr.html">MplsHdr</a> *hdr = (<a class="code" href="../../d2/db6/structMplsHdr.html">MplsHdr</a> *)(pkt);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="comment">// MPLS Header validation. Check for,</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="comment">// - There is single label</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    uint32_t mpls_host = ntohl(hdr-&gt;<a class="code" href="../../d2/db6/structMplsHdr.html#a1dee66bd3a142791f80f8367f7adcdf2">hdr</a>);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">tunnel</a>.<a class="code" href="../../d6/d6b/structTunnelInfo.html#ad485c8c0d02fcbbc77f192d40742b92c">label</a> = (mpls_host &amp; 0xFFFFF000) &gt;&gt; 12;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    uint32_t ret = <span class="keyword">sizeof</span>(<a class="code" href="../../d2/db6/structMplsHdr.html">MplsHdr</a>);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">if</span> ((mpls_host &amp; 0x100) == 0) {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="comment">// interpret outer label 0xffffff as no label</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="keywordflow">if</span> (((mpls_host &amp; 0xFFFFF000) &gt;&gt; 12) !=</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                <a class="code" href="../../df/dd0/classMplsTable.html#a79fe2cd4afb235bf6f40d5f7c9704ece">MplsTable::kInvalidLabel</a>) {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">tunnel</a>.<a class="code" href="../../d6/d6b/structTunnelInfo.html#ad485c8c0d02fcbbc77f192d40742b92c">label</a> = <a class="code" href="../../df/dd0/classMplsTable.html#a79fe2cd4afb235bf6f40d5f7c9704ece">MplsTable::kInvalidLabel</a>;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            <a class="code" href="../../df/d76/pkt__handler_8cc.html#a3517b6542d72a569bd903923b6413b65">PKT_TRACE</a>(Err, <span class="stringliteral">&quot;Unexpected MPLS Label Stack. Ignoring&quot;</span>);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        hdr = (<a class="code" href="../../d2/db6/structMplsHdr.html">MplsHdr</a> *) (pkt + 4);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        mpls_host = ntohl(hdr-&gt;<a class="code" href="../../d2/db6/structMplsHdr.html#a1dee66bd3a142791f80f8367f7adcdf2">hdr</a>);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">tunnel</a>.<a class="code" href="../../d6/d6b/structTunnelInfo.html#ad485c8c0d02fcbbc77f192d40742b92c">label</a> = (mpls_host &amp; 0xFFFFF000) &gt;&gt; 12;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="keywordflow">if</span> ((mpls_host &amp; 0x100) == 0) {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">tunnel</a>.<a class="code" href="../../d6/d6b/structTunnelInfo.html#ad485c8c0d02fcbbc77f192d40742b92c">label</a> = <a class="code" href="../../df/dd0/classMplsTable.html#a79fe2cd4afb235bf6f40d5f7c9704ece">MplsTable::kInvalidLabel</a>;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            <a class="code" href="../../df/d76/pkt__handler_8cc.html#a3517b6542d72a569bd903923b6413b65">PKT_TRACE</a>(Err, <span class="stringliteral">&quot;Unexpected MPLS Label Stack. Ignoring&quot;</span>);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keywordflow">return</span>  -1;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        ret  += <span class="keyword">sizeof</span>(<a class="code" href="../../d2/db6/structMplsHdr.html">MplsHdr</a>);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    uint32_t label = pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">tunnel</a>.<a class="code" href="../../d6/d6b/structTunnelInfo.html#ad485c8c0d02fcbbc77f192d40742b92c">label</a>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <a class="code" href="../../d9/dcb/classMplsLabelKey.html">MplsLabelKey</a> mpls_key(label);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../df/de8/classMplsLabel.html">MplsLabel</a> *mpls = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../df/de8/classMplsLabel.html">MplsLabel</a> *<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a809ef2c3eb911e300fb623d99ea11836">mpls_table</a>()-&gt;<a class="code" href="../../db/d09/classAgentDBTable.html#a224ced1237aec89a4fb72dd3b0f5be13">FindActiveEntry</a>(&amp;mpls_key));</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="keywordflow">if</span> (mpls == NULL) {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <a class="code" href="../../df/d76/pkt__handler_8cc.html#a3517b6542d72a569bd903923b6413b65">PKT_TRACE</a>(Err, <span class="stringliteral">&quot;Invalid MPLS Label &lt;&quot;</span> &lt;&lt; label &lt;&lt; <span class="stringliteral">&quot;&gt;. Ignoring&quot;</span>);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">tunnel</a>.<a class="code" href="../../d6/d6b/structTunnelInfo.html#ad485c8c0d02fcbbc77f192d40742b92c">label</a> = <a class="code" href="../../df/dd0/classMplsTable.html#a79fe2cd4afb235bf6f40d5f7c9704ece">MplsTable::kInvalidLabel</a>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab201b710fbcd037a6865a5665e7c5540">l3_label</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../de/d30/classInterfaceNH.html">InterfaceNH</a> *nh = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../de/d30/classInterfaceNH.html">InterfaceNH</a> *<span class="keyword">&gt;</span>(mpls-&gt;<a class="code" href="../../df/de8/classMplsLabel.html#a120304e249c7b7391d2448a966d21f95">nexthop</a>());</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">if</span> (nh &amp;&amp; nh-&gt;<a class="code" href="../../de/d30/classInterfaceNH.html#aebbd2eec40ab0aca4b97125dbfb2d94d">IsBridge</a>()) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab201b710fbcd037a6865a5665e7c5540">l3_label</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../dd/d76/classCompositeNH.html">CompositeNH</a> *cnh = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../dd/d76/classCompositeNH.html">CompositeNH</a> *<span class="keyword">&gt;</span>(mpls-&gt;<a class="code" href="../../df/de8/classMplsLabel.html#a120304e249c7b7391d2448a966d21f95">nexthop</a>());</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">if</span> (cnh &amp;&amp; cnh-&gt;<a class="code" href="../../dd/d76/classCompositeNH.html#acdc48d0091d35e17b87cc50370a82bbd">composite_nh_type</a>() != <a class="code" href="../../de/d98/structComposite.html#a4747d68b2bad61ba02a5223f77690d5ea5d96c2170cd40688986f866367f3d94f">Composite::LOCAL_ECMP</a>) {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab201b710fbcd037a6865a5665e7c5540">l3_label</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d8/da7/classVrfNH.html">VrfNH</a> *vrf_nh = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../d8/da7/classVrfNH.html">VrfNH</a> *<span class="keyword">&gt;</span>(mpls-&gt;<a class="code" href="../../df/de8/classMplsLabel.html#a120304e249c7b7391d2448a966d21f95">nexthop</a>());</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">if</span> (vrf_nh &amp;&amp; vrf_nh-&gt;<a class="code" href="../../d8/da7/classVrfNH.html#aa7f7d2758bd8ece8d447eb5bfd6ea8da">bridge_nh</a>() == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab201b710fbcd037a6865a5665e7c5540">l3_label</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    }</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    ret += <a class="code" href="../../d5/d94/classPktHandler.html#a0ea013a9befa042f10c1d15c7b3d1dac">ParseControlWord</a>(pkt_info, pkt + ret, mpls);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;}</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">// Parse MPLSoGRE header</span></div>
<div class="line"><a name="l00838"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a95f3b7f291189dd9e70cc93401242658">  838</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d94/classPktHandler.html#a95f3b7f291189dd9e70cc93401242658">PktHandler::ParseMPLSoGRE</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info, uint8_t *pkt) {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <a class="code" href="../../d2/d1b/structGreHdr.html">GreHdr</a> *gre = (<a class="code" href="../../d2/d1b/structGreHdr.html">GreHdr</a> *)(pkt);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordflow">if</span> (gre-&gt;<a class="code" href="../../d2/d1b/structGreHdr.html#aaa95e24e748615bbac1c5776efde4cf0">protocol</a> != ntohs(VR_GRE_PROTO_MPLS)) {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <a class="code" href="../../df/d76/pkt__handler_8cc.html#a3517b6542d72a569bd903923b6413b65">PKT_TRACE</a>(Err, <span class="stringliteral">&quot;Non-MPLS protocol &lt;&quot;</span> &lt;&lt; ntohs(gre-&gt;<a class="code" href="../../d2/d1b/structGreHdr.html#aaa95e24e748615bbac1c5776efde4cf0">protocol</a>) &lt;&lt;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                  <span class="stringliteral">&quot;&gt; in GRE header&quot;</span>);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    }</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordtype">int</span> len = <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d1b/structGreHdr.html">GreHdr</a>);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordtype">int</span> tmp;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    tmp = <a class="code" href="../../d5/d94/classPktHandler.html#a018bd8003f7dd01e8aa79582f2cedc5a">ParseMplsHdr</a>(pkt_info, (pkt + len));</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordflow">if</span> (tmp &lt; 0) {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="keywordflow">return</span> tmp;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    len += tmp;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab201b710fbcd037a6865a5665e7c5540">l3_label</a> == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        tmp = <a class="code" href="../../d5/d94/classPktHandler.html#a50dc12a5515d56cc7eaa24577ab63e60">ParseEthernetHeader</a>(pkt_info, (pkt + len));</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keywordflow">if</span> (tmp &lt; 0)</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            <span class="keywordflow">return</span> tmp;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        len += tmp;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">tunnel</a>.<a class="code" href="../../d6/d6b/structTunnelInfo.html#a152c8ed365b2ce0d0f7a061b34b43281">type</a>.<a class="code" href="../../d3/d08/classTunnelType.html#afeaf43c73b054654af0b97ae3a711583">SetType</a>(<a class="code" href="../../d3/d08/classTunnelType.html#a3848db71a84631798eaa36c12369b977af2160a17fa0eb3713c8e06373a5040e0">TunnelType::MPLS_GRE</a>);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">return</span> (len);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;}</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div>
<div class="line"><a name="l00866"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a8ca9f552bafd9561df9b5a20e4d2a7b1">  866</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d94/classPktHandler.html#a8ca9f552bafd9561df9b5a20e4d2a7b1">PktHandler::ParseMPLSoUDP</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info, uint8_t *pkt) {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordtype">int</span> len = <a class="code" href="../../d5/d94/classPktHandler.html#a018bd8003f7dd01e8aa79582f2cedc5a">ParseMplsHdr</a>(pkt_info, pkt);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">if</span> (len &lt; 0) {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab201b710fbcd037a6865a5665e7c5540">l3_label</a> == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        len += <a class="code" href="../../d5/d94/classPktHandler.html#a50dc12a5515d56cc7eaa24577ab63e60">ParseEthernetHeader</a>(pkt_info, (pkt + len));</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">tunnel</a>.<a class="code" href="../../d6/d6b/structTunnelInfo.html#a152c8ed365b2ce0d0f7a061b34b43281">type</a>.<a class="code" href="../../d3/d08/classTunnelType.html#afeaf43c73b054654af0b97ae3a711583">SetType</a>(<a class="code" href="../../d3/d08/classTunnelType.html#a3848db71a84631798eaa36c12369b977a60fb19b5b806258cb4235c3042a7c8b5">TunnelType::MPLS_UDP</a>);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;}</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div>
<div class="line"><a name="l00880"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a3884910dca29dd35fc0944bbb227334e">  880</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d94/classPktHandler.html#a3884910dca29dd35fc0944bbb227334e">PktHandler::ParseVxlan</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info, uint8_t *pkt) {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <a class="code" href="../../d9/d3c/structVxlanHdr.html">VxlanHdr</a> *vxlan = (<a class="code" href="../../d9/d3c/structVxlanHdr.html">VxlanHdr</a> *)(pkt);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">tunnel</a>.<a class="code" href="../../d6/d6b/structTunnelInfo.html#a372ba294c7924934c0aca4f2a853b0c2">vxlan_id</a> = htonl(vxlan-&gt;<a class="code" href="../../d9/d3c/structVxlanHdr.html#a3c9d226cf3af164d153c898aef6492ba">vxlan_id</a>) &gt;&gt; 8;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keywordtype">int</span> len = <span class="keyword">sizeof</span>(vxlan);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    len += <a class="code" href="../../d5/d94/classPktHandler.html#a50dc12a5515d56cc7eaa24577ab63e60">ParseEthernetHeader</a>(pkt_info, (pkt + len));</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">tunnel</a>.<a class="code" href="../../d6/d6b/structTunnelInfo.html#a152c8ed365b2ce0d0f7a061b34b43281">type</a>.<a class="code" href="../../d3/d08/classTunnelType.html#afeaf43c73b054654af0b97ae3a711583">SetType</a>(<a class="code" href="../../d3/d08/classTunnelType.html#a3848db71a84631798eaa36c12369b977afba1693ef52847cfcfd2195e98351f16">TunnelType::VXLAN</a>);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab201b710fbcd037a6865a5665e7c5540">l3_label</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;}</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div>
<div class="line"><a name="l00892"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a0c24b408a4140d63bbb25f2b10b06c64">  892</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d94/classPktHandler.html#a0c24b408a4140d63bbb25f2b10b06c64">PktHandler::ParseUDPTunnels</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info, uint8_t *pkt) {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordtype">int</span> len = 0;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#a6771677c2de7aeda8be146d9068290e3">VXLAN_UDP_DEST_PORT</a>)</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        len = <a class="code" href="../../d5/d94/classPktHandler.html#a3884910dca29dd35fc0944bbb227334e">ParseVxlan</a>(pkt_info, (pkt + len));</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#a15188cd7f29c35c41850193420f4e537">MPLS_OVER_UDP_DEST_PORT</a> ||</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;             pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#a504d2569df42a9393272b08ab357ea33">IANA_MPLS_OVER_UDP_DEST_PORT</a>)</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        len = <a class="code" href="../../d5/d94/classPktHandler.html#a8ca9f552bafd9561df9b5a20e4d2a7b1">ParseMPLSoUDP</a>(pkt_info, (pkt + len));</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;}</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div>
<div class="line"><a name="l00903"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a7993c9a5bca47688d30b3056e70b87d3">  903</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/d94/classPktHandler.html#a7993c9a5bca47688d30b3056e70b87d3">PktHandler::ValidateIpPacket</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info) {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="comment">// For ICMP, IGMP, make sure IP is IPv4, else fail the parsing</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="comment">// so that we don&#39;t go ahead and access the ip header later</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">if</span> (((pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a> == IPPROTO_ICMP) ||</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;         (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a> == IPPROTO_IGMP)) &amp;&amp; (!pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aa8d254e49c0d126842fa59208310500d">ip</a>)) {</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    }</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="comment">// If ip proto is ICMPv6, then make sure IP is IPv6, else fail</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">// the parsing so that we don&#39;t go ahead and access the ip6 header</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">// later</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">if</span> ((pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a> == IPPROTO_ICMPV6) &amp;&amp; (!pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a15c8da40fb20b302d0ed43143d45c4e1">ip6</a>)) {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;}</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div>
<div class="line"><a name="l00919"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#aa22e71944d69f51845c18f88403b34d1">  919</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d94/classPktHandler.html#aa22e71944d69f51845c18f88403b34d1">PktHandler::ParseUserPkt</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info, <a class="code" href="../../d0/dcc/classInterface.html">Interface</a> *intf,</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                             <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadb">PktType::Type</a> &amp;pkt_type, uint8_t *pkt) {</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordtype">int</span> len = 0, ret = 0;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordtype">bool</span> pkt_ok;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="comment">// get to the actual packet header</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    len += <a class="code" href="../../d5/d94/classPktHandler.html#a50dc12a5515d56cc7eaa24577ab63e60">ParseEthernetHeader</a>(pkt_info, (pkt + len));</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="comment">// Parse payload</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> == ETHERTYPE_ARP) {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a76498bb0d3175427871fc647b94ba17a">arp</a> = (ether_arp *) (pkt + len);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        pkt_type = <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba1daf0a0fe1b27e1facfa38c4607ddc1f">PktType::ARP</a>;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="keyword">union </span>{</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            uint8_t data[<span class="keyword">sizeof</span>(in_addr_t)];</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            in_addr_t addr;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        } bytes;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        memcpy(bytes.data, pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a76498bb0d3175427871fc647b94ba17a">arp</a>-&gt;arp_spa, <span class="keyword">sizeof</span>(in_addr_t));</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        in_addr_t spa = ntohl(bytes.addr);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6eed2de2e29f912c86902b283e7409c6">ip_saddr</a> = <a class="code" href="../../d9/d9b/address_8h.html#a7055b8d880410aad1e3ba8c041397b6c">IpAddress</a>(<a class="code" href="../../d9/d9b/address_8h.html#ae475599c70b47996f862faa1f265eaa2">Ip4Address</a>(spa));</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    }</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="comment">// Identify NON-IP Packets</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> != ETHERTYPE_IP &amp;&amp;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> != ETHERTYPE_IPV6) {</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6aed8011421e47e8fef0273ab76d2be9">data</a> = (pkt + len);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        pkt_type = <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba67f7170c8356b1d25e9690f3d0b8358d">PktType::NON_IP</a>;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    }</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="comment">// Copy IP fields from outer header assuming tunnel is present. If tunnel</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="comment">// is not present, the values here will be ignored</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#a395987d474d0007c24201dfc2d4f89b4">SetOuterMac</a>(pkt_info);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#a73f133f5d0c9a5295495b2068f30a6be">SetOuterIp</a>(pkt_info, (pkt + len));</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">// IP Packets</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    ret = <a class="code" href="../../d5/d94/classPktHandler.html#a8a1c95720fadfccc29c159b1a4550c39">ParseIpPacket</a>(pkt_info, pkt_type, (pkt + len));</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">if</span>(ret == -1) {</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    }</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    len += ret;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d94/classPktHandler.html#a7993c9a5bca47688d30b3056e70b87d3">ValidateIpPacket</a>(pkt_info)) {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;         <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a98ebefc0499e93352429ddc6f94edf6f">stats</a>()-&gt;<a class="code" href="../../d0/d98/classAgentStats.html#a32321e2698ee8c2fc079c717921a3511">incr_pkt_invalid_ip_pkt</a>();</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="comment">// If packet is an IP fragment and not flow trap, ignore it</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d94/classPktHandler.html#a06bcc951c27d02fbcb4c8154954208d0">IgnoreFragmentedPacket</a>(pkt_info)) {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a98ebefc0499e93352429ddc6f94edf6f">stats</a>()-&gt;<a class="code" href="../../d0/d98/classAgentStats.html#a0535054967b9a580c163055b8efe9f31">incr_pkt_fragments_dropped</a>();</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    }</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="comment">// If it is a packet from TOR that we serve, dont parse any further</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d94/classPktHandler.html#a09e59c211ee541ee6db0fedd7f3df049">IsManagedTORPacket</a>(intf, pkt_info, pkt_type, (pkt + len), &amp;pkt_ok)) {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pkt_ok) {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="comment">// invalid pkt received from tor</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;       <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a98ebefc0499e93352429ddc6f94edf6f">stats</a>()-&gt;<a class="code" href="../../d0/d98/classAgentStats.html#a20e3b06263028f637c4e155d259f0781">incr_pkt_invalid_frm_tor</a>();</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;       <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d94/classPktHandler.html#a981101851eceaed34989aa4d1fdf46c4">IsDiagPacket</a>(pkt_info) &amp;&amp;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> != <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3a555c07bba387daa53b40e095c25d2e07">AgentHdr::TRAP_ROUTER_ALERT</a>)) {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">// If tunneling is not enabled on interface or if it is a DHCP packet,</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">// dont parse any further</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">//    if (intf-&gt;IsTunnelEnabled() == false || IsDHCPPacket(pkt_info)) {</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">if</span> (intf-&gt;<a class="code" href="../../d0/dcc/classInterface.html#a91e7fca6cb9e1462112f1b7103dd9bd9">IsTunnelEnabled</a>() == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a98ebefc0499e93352429ddc6f94edf6f">stats</a>()-&gt;<a class="code" href="../../d0/d98/classAgentStats.html#af1a14ad50a8dd3751d094f0c8f0b1187">incr_pkt_drop_due_to_disable_tnl</a>();</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d5/d94/classPktHandler.html#ae8b0cad66045a0269b50a00f720134ff">IsDHCPPacket</a>(pkt_info)) {</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    }</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordtype">int</span> tunnel_len = 0;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="comment">// Do tunnel processing only if IP-DA is ours</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a9281e06ce82d613719895da2c92387fd">family</a> == <a class="code" href="../../de/d6b/classAddress.html#a58d0c167a9c218030c678110e9e69987a1d93db3747cf6c75ab622601c30544a0">Address::INET</a> &amp;&amp;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3ab06f5a5929302e21be828a77d871b2">ip_daddr</a>.to_v4() == <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#ac03bc14ab24abd2d4e377709b726c3b2">router_id</a>()) {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <span class="comment">// Look for supported headers</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="keywordflow">switch</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a>) {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="keywordflow">case</span> IPPROTO_GRE :</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            <span class="comment">// Parse MPLSoGRE tunnel</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            tunnel_len = <a class="code" href="../../d5/d94/classPktHandler.html#a95f3b7f291189dd9e70cc93401242658">ParseMPLSoGRE</a>(pkt_info, (pkt + len));</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="keywordflow">case</span> IPPROTO_UDP:</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            <span class="comment">// Parse MPLSoUDP tunnel</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            tunnel_len = <a class="code" href="../../d5/d94/classPktHandler.html#a0c24b408a4140d63bbb25f2b10b06c64">ParseUDPTunnels</a>(pkt_info, (pkt + len));</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    }</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="keywordflow">if</span> (tunnel_len &lt; 0) {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="comment">// Found tunnel packet, but error in decoding</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        pkt_type = <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba35ce819a4b8389aab264fa447c3c04cd">PktType::INVALID</a>;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a98ebefc0499e93352429ddc6f94edf6f">stats</a>()-&gt;<a class="code" href="../../d0/d98/classAgentStats.html#aa1d390629199ec9dcb7ff4424843c8c7">incr_pkt_drop_due_to_decode_error</a>();</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        <span class="keywordflow">return</span> tunnel_len;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keywordflow">if</span> (tunnel_len == 0) {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    len += tunnel_len;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="comment">// Find IPv4/IPv6 Packet based on first nibble in payload</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">if</span> (((pkt + len)[0] &amp; 0x60) == 0x60) {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> = ETHERTYPE_IPV6;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> = ETHERTYPE_IP;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    }</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    ret = <a class="code" href="../../d5/d94/classPktHandler.html#a8a1c95720fadfccc29c159b1a4550c39">ParseIpPacket</a>(pkt_info, pkt_type, (pkt + len));</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">if</span>(ret == -1) {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    }</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    len += ret;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="comment">// validate inner iphdr</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d94/classPktHandler.html#a7993c9a5bca47688d30b3056e70b87d3">ValidateIpPacket</a>(pkt_info)) {</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a98ebefc0499e93352429ddc6f94edf6f">stats</a>()-&gt;<a class="code" href="../../d0/d98/classAgentStats.html#a32321e2698ee8c2fc079c717921a3511">incr_pkt_invalid_ip_pkt</a>();</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keywordflow">return</span> len;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;}</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">// Enqueue an inter-task message to the specified module</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#ab5a99acd484c2d1099bfa8e09a074506"> 1054</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/d94/classPktHandler.html#ab5a99acd484c2d1099bfa8e09a074506">PktHandler::SendMessage</a>(<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktModuleName</a> mod, <a class="code" href="../../de/d93/structInterTaskMsg.html">InterTaskMsg</a> *msg) {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="keywordflow">if</span> (mod &lt; <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a4b5663f56c7bf149f0c101a235f565c0">MAX_MODULES</a>) {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        boost::shared_ptr&lt;PktInfo&gt; pkt_info(<span class="keyword">new</span> <a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a>(mod, msg));</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <span class="keywordflow">if</span> (!(<a class="code" href="../../d5/d94/classPktHandler.html#aad1c6cf849c57ec2e075359a4a3c4e38">proto_list_</a>.at(mod)-&gt;Enqueue(pkt_info))) {</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            <a class="code" href="../../df/d76/pkt__handler_8cc.html#a3517b6542d72a569bd903923b6413b65">PKT_TRACE</a>(Err, <span class="stringliteral">&quot;Threshold exceeded while enqueuing IPC Message &lt;&quot;</span> &lt;&lt;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                      mod &lt;&lt; <span class="stringliteral">&quot;&gt;&quot;</span>);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    }</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;}</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a06bcc951c27d02fbcb4c8154954208d0"> 1064</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/d94/classPktHandler.html#a06bcc951c27d02fbcb4c8154954208d0">PktHandler::IgnoreFragmentedPacket</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info) {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aa8d254e49c0d126842fa59208310500d">ip</a>) {</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        uint16_t offset = htons(pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#aa8d254e49c0d126842fa59208310500d">ip</a>-&gt;ip_off);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordflow">if</span> (((offset &amp; IP_MF) || (offset &amp; IP_OFFMASK)) &amp;&amp;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            !<a class="code" href="../../d5/d94/classPktHandler.html#af01d4924dbbcf7d0724635ca73e70067">IsFlowPacket</a>(pkt_info))</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a15c8da40fb20b302d0ed43143d45c4e1">ip6</a>) {</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        uint8_t proto = pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a15c8da40fb20b302d0ed43143d45c4e1">ip6</a>-&gt;ip6_ctlun.ip6_un1.ip6_un1_nxt;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <span class="keywordflow">if</span> (proto == IPPROTO_FRAGMENT) {</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d5/d94/classPktHandler.html#af01d4924dbbcf7d0724635ca73e70067">IsFlowPacket</a>(pkt_info) ||</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3ae817adc4b2f152f1b666c8ca6c3451a9">AgentHdr::TRAP_HANDLE_DF</a>) {</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            }</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        }</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    }</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;}</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div>
<div class="line"><a name="l01085"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#ae8b0cad66045a0269b50a00f720134ff"> 1085</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/d94/classPktHandler.html#ae8b0cad66045a0269b50a00f720134ff">PktHandler::IsDHCPPacket</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info) {</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="comment">// Do not consider source port in case we are looking at UDP tunnel header</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#a6771677c2de7aeda8be146d9068290e3">VXLAN_UDP_DEST_PORT</a> ||</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#a15188cd7f29c35c41850193420f4e537">MPLS_OVER_UDP_DEST_PORT</a> ||</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#a504d2569df42a9393272b08ab357ea33">IANA_MPLS_OVER_UDP_DEST_PORT</a>) {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#a478f5be6fb4bfb09b235bb50cf806cc9">DHCP_SERVER_PORT</a> ||</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a> == <a class="code" href="../../d3/d79/pkt__handler_8h.html#a23dd788b1cd28a0d834c3afefceaa1c1">DHCP_CLIENT_PORT</a>) {</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <span class="comment">// we dont handle DHCPv6 coming from fabric</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    }</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;}</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div>
<div class="line"><a name="l01101"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#ae22c44588d24996ffd9cf61509954f14"> 1101</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/d94/classPktHandler.html#ae22c44588d24996ffd9cf61509954f14">PktHandler::IsToRDevice</a>(uint32_t vrf_id, <span class="keyword">const</span> <a class="code" href="../../d9/d9b/address_8h.html#a7055b8d880410aad1e3ba8c041397b6c">IpAddress</a> &amp;ip) {</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d94/classPktHandler.html#af4e822ae7caefed97883db7d64754056">agent</a>()-&gt;tsn_enabled() == <span class="keyword">false</span>)</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordflow">if</span> (ip.is_v4() == <span class="keyword">false</span>)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <a class="code" href="../../d9/d9b/address_8h.html#ae475599c70b47996f862faa1f265eaa2">Ip4Address</a> ip4 = ip.to_v4();</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <a class="code" href="../../d2/d3d/classVrfEntry.html">VrfEntry</a> *vrf = <a class="code" href="../../d5/d94/classPktHandler.html#af4e822ae7caefed97883db7d64754056">agent</a>()-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a661b6ae0b81be524aabb25dcefaabd47">vrf_table</a>()-&gt;<a class="code" href="../../db/d35/classVrfTable.html#ab68c6f010ca30d15c33eace6ec7f28b6">FindVrfFromId</a>(vrf_id);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="keywordflow">if</span> (vrf == NULL)</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <a class="code" href="../../d8/d2e/classBridgeAgentRouteTable.html">BridgeAgentRouteTable</a> *table = <span class="keyword">static_cast&lt;</span><a class="code" href="../../d8/d2e/classBridgeAgentRouteTable.html">BridgeAgentRouteTable</a> *<span class="keyword">&gt;</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        (vrf-&gt;<a class="code" href="../../d2/d3d/classVrfEntry.html#ac32cfcd6a11cd0050853c45a682f1464">GetBridgeRouteTable</a>());</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordflow">if</span> (table == NULL)</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <a class="code" href="../../da/dfb/classBridgeRouteEntry.html">BridgeRouteEntry</a> *rt = table-&gt;<a class="code" href="../../d8/d2e/classBridgeAgentRouteTable.html#a6271f83db49f47976f1bd2482e3ae30c">FindRoute</a>(<a class="code" href="../../d3/df5/classMacAddress.html#a6fb1333e2f0a73a54b04ab3d81876561">MacAddress::BroadcastMac</a>());</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">if</span> (rt == NULL)</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../dd/d76/classCompositeNH.html">CompositeNH</a> *nh = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../dd/d76/classCompositeNH.html">CompositeNH</a> *<span class="keyword">&gt;</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        (rt-&gt;<a class="code" href="../../d4/d57/classAgentRoute.html#adcd6fd8eed3302495616afe5c8ab10ca">GetActiveNextHop</a>());</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">if</span> (nh == NULL)</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    ComponentNHList::const_iterator it = nh-&gt;<a class="code" href="../../dd/d76/classCompositeNH.html#a038788b2f2c2ece59f85d142bc11b15c">begin</a>();</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordflow">while</span> (it != nh-&gt;<a class="code" href="../../dd/d76/classCompositeNH.html#abd357768641b8c1d31e53017135448a6">end</a>()) {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../dd/d76/classCompositeNH.html">CompositeNH</a> *tor_nh = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../dd/d76/classCompositeNH.html">CompositeNH</a> *<span class="keyword">&gt;</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            ((*it)-&gt;nh());</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="keywordflow">if</span> (tor_nh == NULL) {</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            it++;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="keywordflow">if</span> (tor_nh-&gt;<a class="code" href="../../dd/d76/classCompositeNH.html#acdc48d0091d35e17b87cc50370a82bbd">composite_nh_type</a>() != <a class="code" href="../../de/d98/structComposite.html#a4747d68b2bad61ba02a5223f77690d5ea7e44d414dff32ac1db835f49bfaa0a89">Composite::TOR</a> &amp;&amp;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            tor_nh-&gt;<a class="code" href="../../dd/d76/classCompositeNH.html#acdc48d0091d35e17b87cc50370a82bbd">composite_nh_type</a>() != <a class="code" href="../../de/d98/structComposite.html#a4747d68b2bad61ba02a5223f77690d5eaab9ca131307d78aead877bcc68a46288">Composite::EVPN</a>) {</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            it++;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        }</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        ComponentNHList::const_iterator tor_it = tor_nh-&gt;<a class="code" href="../../dd/d76/classCompositeNH.html#a038788b2f2c2ece59f85d142bc11b15c">begin</a>();</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="keywordflow">while</span> (tor_it != tor_nh-&gt;<a class="code" href="../../dd/d76/classCompositeNH.html#abd357768641b8c1d31e53017135448a6">end</a>()) {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <span class="keyword">const</span> <a class="code" href="../../d0/daf/classTunnelNH.html">TunnelNH</a> *tun_nh = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../d0/daf/classTunnelNH.html">TunnelNH</a> *<span class="keyword">&gt;</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                ((*tor_it)-&gt;nh());</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            <span class="keywordflow">if</span> (tun_nh == NULL) {</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                tor_it++;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;            }</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            <span class="keywordflow">if</span> (*tun_nh-&gt;<a class="code" href="../../d0/daf/classTunnelNH.html#ab6838feedf038e489355b779bfe2acf5">GetDip</a>() == ip4) {</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            }</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            tor_it++;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        }</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        it++;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    }</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;}</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">// We can receive DHCP / DNS packets on physical port from TOR ports managed</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment">// by a TOR services node. Check if the source mac is the mac address of a</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">// VM interface available in the node.</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a09e59c211ee541ee6db0fedd7f3df049"> 1165</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/d94/classPktHandler.html#a09e59c211ee541ee6db0fedd7f3df049">PktHandler::IsManagedTORPacket</a>(<a class="code" href="../../d0/dcc/classInterface.html">Interface</a> *intf, <a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info,</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                    <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadb">PktType::Type</a> &amp;pkt_type, uint8_t *pkt, <span class="keywordtype">bool</span> *pkt_ok) {</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    *pkt_ok = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordflow">if</span> (intf-&gt;<a class="code" href="../../d0/dcc/classInterface.html#aa4e925f921176be2ba014008dadde813">type</a>() != <a class="code" href="../../d0/dcc/classInterface.html#a01562cbfcb9c8793a7117b67ee0ce079a726374ecb3fd1af3633980e6fe2d24eb">Interface::PHYSICAL</a>) {</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    }</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="keywordflow">if</span> (pkt_type != <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba28c9d988e5eca834aad2016b5e7ec126">PktType::UDP</a> || pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a> != <a class="code" href="../../d3/d79/pkt__handler_8h.html#a6771677c2de7aeda8be146d9068290e3">VXLAN_UDP_DEST_PORT</a>)</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="comment">// Get VXLAN id and point to original L2 frame after the VXLAN header</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    pkt += 8;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="comment">// get to the actual packet header</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    pkt += <a class="code" href="../../d5/d94/classPktHandler.html#a50dc12a5515d56cc7eaa24577ab63e60">ParseEthernetHeader</a>(pkt_info, pkt);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    ether_addr addr;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    memcpy(addr.ether_addr_octet, pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a8ed59fa62263d57ae9c6db08458885f2">eth</a>-&gt;ether_shost, ETH_ALEN);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <a class="code" href="../../d3/df5/classMacAddress.html">MacAddress</a> address(addr);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d2/d3d/classVrfEntry.html">VrfEntry</a> *vrf = <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a661b6ae0b81be524aabb25dcefaabd47">vrf_table</a>()-&gt;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        FindVrfFromId(pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#ac279c0e6b1be3e9073f05188110aab4b">vrf</a>);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">if</span> (vrf == NULL)</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;   <a class="code" href="../../d8/d2e/classBridgeAgentRouteTable.html">BridgeAgentRouteTable</a> *bridge_table =</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><a class="code" href="../../d8/d2e/classBridgeAgentRouteTable.html">BridgeAgentRouteTable</a> *<span class="keyword">&gt;</span>(vrf-&gt;<a class="code" href="../../d2/d3d/classVrfEntry.html#ac32cfcd6a11cd0050853c45a682f1464">GetBridgeRouteTable</a>());</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordflow">if</span>(bridge_table == NULL) {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        <a class="code" href="../../d5/d77/logging_8h.html#afa4d5ba62ca08799d69d54104884902a">LOG</a>(ERROR,</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;           <span class="stringliteral">&quot;Error bridge_table == NULL. BackTrace: &quot;</span> &lt;&lt; <a class="code" href="../../d2/d0e/agent_8cc.html#a6d4f9ef75ed60d04c1d67c58010f6e47">AgentBackTrace</a>(1));</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        _Exit(0);</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    }</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d5/d21/classVmInterface.html">VmInterface</a> *vm_intf = bridge_table-&gt;<a class="code" href="../../d8/d2e/classBridgeAgentRouteTable.html#acd29ee6fcce85330dcd810fa2aba06ee">FindVmFromDhcpBinding</a>(address);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordflow">if</span> (vm_intf == NULL) {</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/d94/classPktHandler.html#ae22c44588d24996ffd9cf61509954f14">IsToRDevice</a>(vm_intf-&gt;<a class="code" href="../../d0/dcc/classInterface.html#ab7c0e976860b4e8d1f14ff6dce82d9ae">vrf_id</a>(), pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6eed2de2e29f912c86902b283e7409c6">ip_saddr</a>) == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    }</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="comment">// update agent_hdr to reflect the VM interface data</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="comment">// cmd_param is set to physical interface id</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> = <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3affceed1c7808f47a4d18c3035c2cca4e">AgentHdr::TRAP_TOR_CONTROL_PKT</a>;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#a34bbc005d14e0b0f17e6d146569fbe23">cmd_param</a> = pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#a542c76d864fa60bfc5cc62446cd4c142">ifindex</a>;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#a542c76d864fa60bfc5cc62446cd4c142">ifindex</a> = vm_intf-&gt;<a class="code" href="../../d0/dcc/classInterface.html#a302160fc71c3eb559ca3c63e4b75f413">id</a>();</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="comment">// Parse payload</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> == ETHERTYPE_ARP) {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a76498bb0d3175427871fc647b94ba17a">arp</a> = (ether_arp *) pkt;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        pkt_type = <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba1daf0a0fe1b27e1facfa38c4607ddc1f">PktType::ARP</a>;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    }</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="comment">// Identify NON-IP Packets</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> != ETHERTYPE_IP &amp;&amp;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">ether_type</a> != ETHERTYPE_IPV6) {</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6aed8011421e47e8fef0273ab76d2be9">data</a> = pkt;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        pkt_type = <a class="code" href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba67f7170c8356b1d25e9690f3d0b8358d">PktType::NON_IP</a>;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    }</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="comment">// IP Packets</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="../../d5/d94/classPktHandler.html#a8a1c95720fadfccc29c159b1a4550c39">ParseIpPacket</a>(pkt_info, pkt_type, pkt) == -1) {</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        *pkt_ok = <span class="keyword">false</span>; <span class="comment">//Don&#39;t process any further</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d94/classPktHandler.html#a7993c9a5bca47688d30b3056e70b87d3">ValidateIpPacket</a>(pkt_info)) {</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        *pkt_ok = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    }</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;}</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div>
<div class="line"><a name="l01237"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#af01d4924dbbcf7d0724635ca73e70067"> 1237</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/d94/classPktHandler.html#af01d4924dbbcf7d0724635ca73e70067">PktHandler::IsFlowPacket</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info) {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3a9b9afd835ae7a0b3421f92f12dd991df">AgentHdr::TRAP_FLOW_MISS</a> ||</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3ad93e60118252978a72c45b6d8a83cda7">AgentHdr::TRAP_FLOW_ACTION_HOLD</a>) {</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    }</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;}</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div>
<div class="line"><a name="l01245"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#aad57437816d6223c56f290ceca290b43"> 1245</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/d94/classPktHandler.html#af01d4924dbbcf7d0724635ca73e70067">PktHandler::IsFlowPacket</a>(<span class="keyword">const</span> <a class="code" href="../../d6/d0d/structAgentHdr.html">AgentHdr</a> &amp;agent_hdr) {</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordflow">if</span> (agent_hdr.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3a9b9afd835ae7a0b3421f92f12dd991df">AgentHdr::TRAP_FLOW_MISS</a> ||</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        agent_hdr.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3ad93e60118252978a72c45b6d8a83cda7">AgentHdr::TRAP_FLOW_ACTION_HOLD</a>) {</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;}</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div>
<div class="line"><a name="l01253"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a981101851eceaed34989aa4d1fdf46c4"> 1253</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/d94/classPktHandler.html#a981101851eceaed34989aa4d1fdf46c4">PktHandler::IsDiagPacket</a>(<a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt_info) {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="keywordflow">if</span> (pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3af95ea993e71663741f92769696d7630a">AgentHdr::TRAP_ZERO_TTL</a> ||</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3a7dc10d3e347355ce79b89c56bb6c8b18">AgentHdr::TRAP_ICMP_ERROR</a></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        || pkt_info-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>.<a class="code" href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">cmd</a> == <a class="code" href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3a555c07bba387daa53b40e095c25d2e07">AgentHdr::TRAP_ROUTER_ALERT</a>)</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;}</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">// Check if the packet is destined to the VM&#39;s default GW</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a4563e5d1e5fca94bfa6e374ec9e351fe"> 1262</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/d94/classPktHandler.html#a4563e5d1e5fca94bfa6e374ec9e351fe">PktHandler::IsGwPacket</a>(<span class="keyword">const</span> <a class="code" href="../../d0/dcc/classInterface.html">Interface</a> *intf, <span class="keyword">const</span> <a class="code" href="../../d9/d9b/address_8h.html#a7055b8d880410aad1e3ba8c041397b6c">IpAddress</a> &amp;dst_ip) {</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="keywordflow">if</span> (!intf || intf-&gt;<a class="code" href="../../d0/dcc/classInterface.html#aa4e925f921176be2ba014008dadde813">type</a>() != <a class="code" href="../../d0/dcc/classInterface.html#a01562cbfcb9c8793a7117b67ee0ce079a237f863154018d4c85568c225fa4a826">Interface::VM_INTERFACE</a>)</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d5/d21/classVmInterface.html">VmInterface</a> *vm_intf = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../d5/d21/classVmInterface.html">VmInterface</a> *<span class="keyword">&gt;</span>(intf);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <span class="keywordflow">if</span> (vm_intf-&gt;<a class="code" href="../../d5/d21/classVmInterface.html#afb8d38d7515d09435980c6307b316a56">vmi_type</a>() != <a class="code" href="../../d5/d21/classVmInterface.html#a685793cc3053753bcb248561ab1161c0a544b39b02f30d6b443fefe25c15ca6d4">VmInterface::GATEWAY</a>) {</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="comment">//Gateway interface doesnt have IP address</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <span class="keywordflow">if</span> (dst_ip.is_v6() &amp;&amp; vm_intf-&gt;<a class="code" href="../../d5/d21/classVmInterface.html#a9c0028149535fe16b78d112aee99eeb4">primary_ip6_addr</a>().is_unspecified())</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dst_ip.is_v4() &amp;&amp; vm_intf-&gt;<a class="code" href="../../d5/d21/classVmInterface.html#ada7ed7a5fb4d53d7260bdbe8f2630e14">primary_ip_addr</a>().is_unspecified())</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    }</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../d8/d00/classVnEntry.html">VnEntry</a> *vn = vm_intf-&gt;<a class="code" href="../../d5/d21/classVmInterface.html#ad3409722d31d08b926a0660636083917">vn</a>();</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordflow">if</span> (vn) {</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <span class="keyword">const</span> std::vector&lt;VnIpam&gt; &amp;ipam = vn-&gt;<a class="code" href="../../d8/d00/classVnEntry.html#a1037b99b37ff98fdbb43f757b0ed528b">GetVnIpam</a>();</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; ipam.size(); ++i) {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            <span class="keywordflow">if</span> (dst_ip.is_v4()) {</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                <span class="keywordflow">if</span> (!ipam[i].IsV4()) {</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                }</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                <span class="keywordflow">if</span> (ipam[i].default_gw == dst_ip ||</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                    ipam[i].dns_server == dst_ip) {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                }</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                <span class="keywordflow">if</span> (!ipam[i].IsV6()) {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                <span class="keywordflow">if</span> (ipam[i].default_gw == dst_ip ||</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                        ipam[i].dns_server == dst_ip) {</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                }</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;            }</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        }</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    }</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;}</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;</div>
<div class="line"><a name="l01302"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#a85fdbc6698073189ea5c88a91148f0da"> 1302</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/d94/classPktHandler.html#a85fdbc6698073189ea5c88a91148f0da">PktHandler::IsValidInterface</a>(uint32_t ifindex, <a class="code" href="../../d0/dcc/classInterface.html">Interface</a> **intrface) {</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <a class="code" href="../../d0/dcc/classInterface.html">Interface</a> *intf = <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a1763098920517b4774b95a4287ac71d0">interface_table</a>()-&gt;<a class="code" href="../../d2/d73/classInterfaceTable.html#a3460257f9b0fa13a0f7104f38d835aa3">FindInterface</a>(ifindex);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="keywordflow">if</span> (intf == NULL) {</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        <a class="code" href="../../df/d76/pkt__handler_8cc.html#a3517b6542d72a569bd903923b6413b65">PKT_TRACE</a>(Err, <span class="stringliteral">&quot;Invalid interface index &lt;&quot;</span> &lt;&lt; ifindex &lt;&lt; <span class="stringliteral">&quot;&gt;&quot;</span>);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">agent_</a>-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a98ebefc0499e93352429ddc6f94edf6f">stats</a>()-&gt;<a class="code" href="../../d0/d98/classAgentStats.html#ac1459263729bee18dad5c46ea6a2b9bf">incr_pkt_invalid_interface</a>();</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    }</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    *intrface = intf;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;}</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div>
<div class="line"><a name="l01314"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#afdd24821da0db51a5c000dc86181c911"> 1314</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/d94/classPktHandler.html#afdd24821da0db51a5c000dc86181c911">PktHandler::PktTraceIterate</a>(<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktModuleName</a> mod, <a class="code" href="../../d5/d94/classPktHandler.html#a7c1b143f05f7acd900f0e1d4185694dd">PktTraceCallback</a> cb) {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="keywordflow">if</span> (!cb.empty()) {</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        <a class="code" href="../../db/d26/classPktTrace.html">PktTrace</a> &amp;pkt(<a class="code" href="../../d5/d94/classPktHandler.html#aa56e12e1b77b0cfb23304cf9e261091b">pkt_trace_</a>.at(mod));</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        pkt.<a class="code" href="../../db/d26/classPktTrace.html#ae3e0eef18f4b97745c47db13c3de561f">Iterate</a>(cb);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    }</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;}</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div>
<div class="line"><a name="l01321"></a><span class="lineno"><a class="line" href="../../dd/d88/structPktHandler_1_1PktStats.html#a04f2c7f99b21f1517690548ce2f1aff8"> 1321</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d88/structPktHandler_1_1PktStats.html#a04f2c7f99b21f1517690548ce2f1aff8">PktHandler::PktStats::PktRcvd</a>(<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktModuleName</a> mod) {</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">if</span> (mod &lt; <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a4b5663f56c7bf149f0c101a235f565c0">MAX_MODULES</a>)</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <a class="code" href="../../dd/d88/structPktHandler_1_1PktStats.html#a7b5c5c553004d747d8cea587b277b1ea">received</a>[mod]++;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;}</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div>
<div class="line"><a name="l01326"></a><span class="lineno"><a class="line" href="../../dd/d88/structPktHandler_1_1PktStats.html#af5e6cd88c360f963267fa99e947bb307"> 1326</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d88/structPktHandler_1_1PktStats.html#af5e6cd88c360f963267fa99e947bb307">PktHandler::PktStats::PktSent</a>(<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktModuleName</a> mod) {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="keywordflow">if</span> (mod &lt; <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a4b5663f56c7bf149f0c101a235f565c0">MAX_MODULES</a>)</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        sent[mod]++;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;}</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div>
<div class="line"><a name="l01331"></a><span class="lineno"><a class="line" href="../../dd/d88/structPktHandler_1_1PktStats.html#a82bf97de645ed9bafd501dbd734ce462"> 1331</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dd/d88/structPktHandler_1_1PktStats.html#a82bf97de645ed9bafd501dbd734ce462">PktHandler::PktStats::PktQThresholdExceeded</a>(<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktModuleName</a> mod) {</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="keywordflow">if</span> (mod &lt; <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a4b5663f56c7bf149f0c101a235f565c0">MAX_MODULES</a>)</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        q_threshold_exceeded[mod]++;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;}</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;</div>
<div class="line"><a name="l01338"></a><span class="lineno"><a class="line" href="../../d5/da8/structPktInfo.html#ae3a13425aa68f1dfe8698483475ad3e9"> 1338</a></span>&#160;<a class="code" href="../../d5/da8/structPktInfo.html#a09de18bc5de08c1435c39d2de5dca0db">PktInfo::PktInfo</a>(<span class="keyword">const</span> <a class="code" href="../../d4/dc5/packet__buffer_8h.html#a78def6b5ee9b81aaa6519da4cf9253bb">PacketBufferPtr</a> &amp;buff) :</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    module(<a class="code" href="../../d5/d94/classPktHandler.html">PktHandler</a>::<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a702d2d11f6301be930500864558697e4">INVALID</a>),</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    pkt(buff-&gt;data()), len(buff-&gt;data_len()), max_pkt_len(buff-&gt;buffer_len()),</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    data(), ipc(), family(<a class="code" href="../../de/d6b/classAddress.html">Address</a>::UNSPEC), <a class="code" href="../../de/dcb/load__balance_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>(<a class="code" href="../../d8/d9c/structPktType.html">PktType</a>::<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a702d2d11f6301be930500864558697e4">INVALID</a>), agent_hdr(),</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    ether_type(-1), ip_saddr(), ip_daddr(), ip_proto(), sport(), dport(),</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    ttl(0), icmp_chksum(0), tcp_ack(false), tunnel(),</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    l3_label(false), is_bfd_keepalive(false), is_segment_hc_pkt(false),</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    ignore_address(<a class="code" href="../../d5/d21/classVmInterface.html">VmInterface</a>::IGNORE_NONE), same_port_number(false),</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    is_fat_flow_src_prefix(false), ip_ff_src_prefix(),</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    is_fat_flow_dst_prefix(false), ip_ff_dst_prefix(),</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    eth(), arp(), ip(), ip6(), packet_buffer_(buff) {</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.tcp = 0;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;}</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div>
<div class="line"><a name="l01352"></a><span class="lineno"><a class="line" href="../../d5/da8/structPktInfo.html#a133a714a773a594fe4f3aa03322a36ff"> 1352</a></span>&#160;<a class="code" href="../../d5/da8/structPktInfo.html#a09de18bc5de08c1435c39d2de5dca0db">PktInfo::PktInfo</a>(<span class="keyword">const</span> <a class="code" href="../../d4/dc5/packet__buffer_8h.html#a78def6b5ee9b81aaa6519da4cf9253bb">PacketBufferPtr</a> &amp;buff, <span class="keyword">const</span> <a class="code" href="../../d6/d0d/structAgentHdr.html">AgentHdr</a> &amp;hdr) :</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    pkt(buff-&gt;data()), len(buff-&gt;data_len()), max_pkt_len(buff-&gt;buffer_len()),</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    data(), ipc(), family(<a class="code" href="../../de/d6b/classAddress.html">Address</a>::UNSPEC), <a class="code" href="../../de/dcb/load__balance_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>(<a class="code" href="../../d8/d9c/structPktType.html">PktType</a>::<a class="code" href="../../d5/d87/globals_8h.html#af8f69ad2e0771a513d2eb7d5198b2a8caef2863a469df3ea6871d640e3669a2f2">INVALID</a>),</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    agent_hdr(hdr), ether_type(-1), ip_saddr(), ip_daddr(), ip_proto(), sport(),</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    dport(), ttl(0), icmp_chksum(0), tcp_ack(false), tunnel(),</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    l3_label(false), is_bfd_keepalive(false), is_segment_hc_pkt(false),</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    ignore_address(<a class="code" href="../../d5/d21/classVmInterface.html">VmInterface</a>::IGNORE_NONE), same_port_number(false),</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    is_fat_flow_src_prefix(false), ip_ff_src_prefix(),</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    is_fat_flow_dst_prefix(false), ip_ff_dst_prefix(),</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    eth(), arp(), ip(), ip6(), packet_buffer_(buff) {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.tcp = 0;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;}</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div>
<div class="line"><a name="l01365"></a><span class="lineno"><a class="line" href="../../d5/da8/structPktInfo.html#a09de18bc5de08c1435c39d2de5dca0db"> 1365</a></span>&#160;<a class="code" href="../../d5/da8/structPktInfo.html#a09de18bc5de08c1435c39d2de5dca0db">PktInfo::PktInfo</a>(<a class="code" href="../../d8/dfe/classAgent.html">Agent</a> *agent, uint32_t buff_len, <a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktHandler::PktModuleName</a> mod,</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                 uint32_t mdata) :</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    module(mod),</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    len(), max_pkt_len(), data(), ipc(), family(<a class="code" href="../../de/d6b/classAddress.html">Address</a>::UNSPEC),</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <a class="code" href="../../de/dcb/load__balance_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>(<a class="code" href="../../d8/d9c/structPktType.html">PktType</a>::<a class="code" href="../../d5/d87/globals_8h.html#af8f69ad2e0771a513d2eb7d5198b2a8caef2863a469df3ea6871d640e3669a2f2">INVALID</a>), agent_hdr(), ether_type(-1), ip_saddr(), ip_daddr(),</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    ip_proto(), sport(), dport(), ttl(0), icmp_chksum(0), tcp_ack(false),</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    tunnel(), l3_label(false), is_bfd_keepalive(false), is_segment_hc_pkt(false),</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    ignore_address(<a class="code" href="../../d5/d21/classVmInterface.html">VmInterface</a>::IGNORE_NONE), same_port_number(false),</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    is_fat_flow_src_prefix(false), ip_ff_src_prefix(),</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    is_fat_flow_dst_prefix(false), ip_ff_dst_prefix(),</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    eth(),arp(), ip(), ip6() {</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#ad0cb770575ee100a2495a29734262c83">packet_buffer_</a> = agent-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a336b21bbbce890ea37d6e47abaac3900">pkt</a>()-&gt;<a class="code" href="../../d3/d55/classPktModule.html#a135bd5f128027bdc1a13578b30af85cc">packet_buffer_manager</a>()-&gt;<a class="code" href="../../d0/dd9/classPacketBufferManager.html#a5022c34278d3c2e42153011c70120324">Allocate</a></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        (<a class="code" href="../../d5/da8/structPktInfo.html#adce6da79b75d42f77d439e7ad2b4dd99">module</a>, buff_len, mdata);</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#a0edd9430bd89502db5df54dc160bb5e1">pkt</a> = <a class="code" href="../../d5/da8/structPktInfo.html#ad0cb770575ee100a2495a29734262c83">packet_buffer_</a>-&gt;data();</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#a6fa8d862151b7712ede71fe4c5dc3c85">len</a> = <a class="code" href="../../d5/da8/structPktInfo.html#ad0cb770575ee100a2495a29734262c83">packet_buffer_</a>-&gt;data_len();</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#ac71d0eccc1b62c72e8bab70e0b5872e8">max_pkt_len</a> = <a class="code" href="../../d5/da8/structPktInfo.html#ad0cb770575ee100a2495a29734262c83">packet_buffer_</a>-&gt;buffer_len();</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.tcp = 0;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;}</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;</div>
<div class="line"><a name="l01386"></a><span class="lineno"><a class="line" href="../../d5/da8/structPktInfo.html#a74c55428d3c17c05b8b95df4cad9ca4c"> 1386</a></span>&#160;<a class="code" href="../../d5/da8/structPktInfo.html#a09de18bc5de08c1435c39d2de5dca0db">PktInfo::PktInfo</a>(<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktHandler::PktModuleName</a> mod, <a class="code" href="../../de/d93/structInterTaskMsg.html">InterTaskMsg</a> *msg) :</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    module(mod),</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    pkt(), len(), max_pkt_len(0), data(), ipc(msg), family(<a class="code" href="../../de/d6b/classAddress.html">Address</a>::UNSPEC),</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <a class="code" href="../../de/dcb/load__balance_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a>(<a class="code" href="../../d8/d9c/structPktType.html">PktType</a>::MESSAGE), agent_hdr(), ether_type(-1), ip_saddr(), ip_daddr(),</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    ip_proto(), sport(), dport(), ttl(0), icmp_chksum(0), tcp_ack(false),</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    tunnel(), l3_label(false), is_bfd_keepalive(false), is_segment_hc_pkt(false),</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    ignore_address(<a class="code" href="../../d5/d21/classVmInterface.html">VmInterface</a>::IGNORE_NONE), same_port_number(false),</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    is_fat_flow_src_prefix(false), ip_ff_src_prefix(),</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    is_fat_flow_dst_prefix(false), ip_ff_dst_prefix(),</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    eth(), arp(), ip(), ip6(), packet_buffer_() {</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.tcp = 0;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;}</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div>
<div class="line"><a name="l01399"></a><span class="lineno"><a class="line" href="../../d5/da8/structPktInfo.html#a80e7dc1be11679d34710c7ac7cfbeb4f"> 1399</a></span>&#160;<a class="code" href="../../d5/da8/structPktInfo.html#a80e7dc1be11679d34710c7ac7cfbeb4f">PktInfo::~PktInfo</a>() {</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;}</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;</div>
<div class="line"><a name="l01402"></a><span class="lineno"><a class="line" href="../../d5/da8/structPktInfo.html#ada1ebfb76eaf2f399cd4362c42db647e"> 1402</a></span>&#160;<span class="keyword">const</span> <a class="code" href="../../d6/d0d/structAgentHdr.html">AgentHdr</a> &amp;<a class="code" href="../../d5/da8/structPktInfo.html#ada1ebfb76eaf2f399cd4362c42db647e">PktInfo::GetAgentHdr</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;}</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;</div>
<div class="line"><a name="l01406"></a><span class="lineno"><a class="line" href="../../d5/da8/structPktInfo.html#a35ad00a1209b527bbecc84c355e9eef0"> 1406</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da8/structPktInfo.html#a35ad00a1209b527bbecc84c355e9eef0">PktInfo::reset_packet_buffer</a>() {</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#ad0cb770575ee100a2495a29734262c83">packet_buffer_</a>.reset();</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;}</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div>
<div class="line"><a name="l01410"></a><span class="lineno"><a class="line" href="../../d5/da8/structPktInfo.html#a81538ab2560dc7e284038ad3f5e035d2"> 1410</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da8/structPktInfo.html#a81538ab2560dc7e284038ad3f5e035d2">PktInfo::AllocPacketBuffer</a>(<a class="code" href="../../d8/dfe/classAgent.html">Agent</a> *agent, uint32_t module, uint16_t len,</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                                uint32_t mdata) {</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#ad0cb770575ee100a2495a29734262c83">packet_buffer_</a> = agent-&gt;<a class="code" href="../../d8/dfe/classAgent.html#a336b21bbbce890ea37d6e47abaac3900">pkt</a>()-&gt;<a class="code" href="../../d3/d55/classPktModule.html#a135bd5f128027bdc1a13578b30af85cc">packet_buffer_manager</a>()-&gt;<a class="code" href="../../d0/dd9/classPacketBufferManager.html#a5022c34278d3c2e42153011c70120324">Allocate</a></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        (module, len, mdata);</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#a0edd9430bd89502db5df54dc160bb5e1">pkt</a> = <a class="code" href="../../d5/da8/structPktInfo.html#ad0cb770575ee100a2495a29734262c83">packet_buffer_</a>-&gt;data();</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    len = <a class="code" href="../../d5/da8/structPktInfo.html#ad0cb770575ee100a2495a29734262c83">packet_buffer_</a>-&gt;data_len();</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#ac71d0eccc1b62c72e8bab70e0b5872e8">max_pkt_len</a> = <a class="code" href="../../d5/da8/structPktInfo.html#ad0cb770575ee100a2495a29734262c83">packet_buffer_</a>-&gt;buffer_len();</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;}</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;</div>
<div class="line"><a name="l01419"></a><span class="lineno"><a class="line" href="../../d5/da8/structPktInfo.html#ad0dd507e60f663284c59c811a58389a7"> 1419</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da8/structPktInfo.html#ad0dd507e60f663284c59c811a58389a7">PktInfo::set_len</a>(uint32_t x) {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#ad0cb770575ee100a2495a29734262c83">packet_buffer_</a>-&gt;set_len(x);</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#a6fa8d862151b7712ede71fe4c5dc3c85">len</a> = x;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;}</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;</div>
<div class="line"><a name="l01424"></a><span class="lineno"><a class="line" href="../../d5/da8/structPktInfo.html#a4690470285a966d67e56a42f5f99fb52"> 1424</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/da8/structPktInfo.html#a4690470285a966d67e56a42f5f99fb52">PktInfo::UpdateHeaderPtr</a>() {</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#a8ed59fa62263d57ae9c6db08458885f2">eth</a> = (<span class="keyword">struct </span>ether_header *)(<a class="code" href="../../d5/da8/structPktInfo.html#a0edd9430bd89502db5df54dc160bb5e1">pkt</a>);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#aa8d254e49c0d126842fa59208310500d">ip</a> = (<span class="keyword">struct </span><a class="code" href="../../d5/da8/structPktInfo.html#aa8d254e49c0d126842fa59208310500d">ip</a> *)(<a class="code" href="../../d5/da8/structPktInfo.html#a8ed59fa62263d57ae9c6db08458885f2">eth</a> + 1);</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.tcp = (<span class="keyword">struct </span>tcphdr *)(<a class="code" href="../../d5/da8/structPktInfo.html#aa8d254e49c0d126842fa59208310500d">ip</a> + 1);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;}</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;</div>
<div class="line"><a name="l01430"></a><span class="lineno"><a class="line" href="../../d5/da8/structPktInfo.html#a0721c1c52ab92da5aa5d7fee4a42d324"> 1430</a></span>&#160;std::size_t <a class="code" href="../../d5/da8/structPktInfo.html#a0721c1c52ab92da5aa5d7fee4a42d324">PktInfo::hash</a>(<span class="keyword">const</span> <a class="code" href="../../d8/dfe/classAgent.html">Agent</a> *agent,</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                          <span class="keyword">const</span> <a class="code" href="../../d1/db0/classEcmpLoadBalance.html">EcmpLoadBalance</a> &amp;ecmp_load_balance)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    std::size_t seed = 0;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="comment">// Bug: 1687879</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="comment">// Consider that source compute has 2 member ECMP - compute-1 and compute-2</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="comment">// Compute-1 is chosed in hash is even and Compute-2 is chosen if hash</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="comment">// is add.</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="comment">// On Compute-1, the hash computation uses same 5-tuple and will always</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="comment">// result in even number. As a result, flows from Compute-1 will go to</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="comment">// even-numbered ECMP members and never odd-numbered members.</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="comment">// If Compute-2 happens to have only 2 members, all flows go to ecmp-index</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="comment">// 0 and never to 1</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="comment">// Solution:</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="comment">// We need to ensure that hash computed in Compute-1 and Compute-2 are</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="comment">// different. We also want to have same hash on agent restarts. So, include</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="comment">// vhost-ip also to compute hash</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="keywordflow">if</span> (agent-&gt;<a class="code" href="../../d8/dfe/classAgent.html#ae8ee3a20def9370096d09a536d2f9f9f">params</a>()-&gt;<a class="code" href="../../dc/dd4/classAgentParam.html#adc0f8e645ea4ec3c22a3bb489c88da62">flow_use_rid_in_hash</a>()) {</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        boost::hash_combine(seed, agent-&gt;<a class="code" href="../../d8/dfe/classAgent.html#ac03bc14ab24abd2d4e377709b726c3b2">router_id</a>().to_ulong());</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    }</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/da8/structPktInfo.html#a9281e06ce82d613719895da2c92387fd">family</a> == <a class="code" href="../../de/d6b/classAddress.html#a58d0c167a9c218030c678110e9e69987a1d93db3747cf6c75ab622601c30544a0">Address::INET</a>) {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        <span class="keywordflow">if</span> (ecmp_load_balance.<a class="code" href="../../d1/db0/classEcmpLoadBalance.html#a2611388b5517276d4d9af77b285345de">is_source_ip_set</a>()) {</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            boost::hash_combine(seed, <a class="code" href="../../d5/da8/structPktInfo.html#a6eed2de2e29f912c86902b283e7409c6">ip_saddr</a>.to_v4().to_ulong());</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        }</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        <span class="keywordflow">if</span> (ecmp_load_balance.<a class="code" href="../../d1/db0/classEcmpLoadBalance.html#a7c33cd2865df35bda4871fc3a2fd3dab">is_destination_ip_set</a>()) {</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;            boost::hash_combine(seed, <a class="code" href="../../d5/da8/structPktInfo.html#a3ab06f5a5929302e21be828a77d871b2">ip_daddr</a>.to_v4().to_ulong());</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        }</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d5/da8/structPktInfo.html#a9281e06ce82d613719895da2c92387fd">family</a> == <a class="code" href="../../de/d6b/classAddress.html#a58d0c167a9c218030c678110e9e69987aa474968a53fad182e1b6340dd2eb80fc">Address::INET6</a>) {</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <span class="keywordflow">if</span> (ecmp_load_balance.<a class="code" href="../../d1/db0/classEcmpLoadBalance.html#a2611388b5517276d4d9af77b285345de">is_source_ip_set</a>()) {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;            uint32_t words[4];</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            memcpy(words, <a class="code" href="../../d5/da8/structPktInfo.html#a6eed2de2e29f912c86902b283e7409c6">ip_saddr</a>.to_v6().to_bytes().data(), <span class="keyword">sizeof</span>(words));</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            boost::hash_combine(seed, words[0]);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;            boost::hash_combine(seed, words[1]);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;            boost::hash_combine(seed, words[2]);</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;            boost::hash_combine(seed, words[3]);</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        }</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        <span class="keywordflow">if</span> (ecmp_load_balance.<a class="code" href="../../d1/db0/classEcmpLoadBalance.html#a7c33cd2865df35bda4871fc3a2fd3dab">is_destination_ip_set</a>()) {</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;            uint32_t words[4];</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            memcpy(words, <a class="code" href="../../d5/da8/structPktInfo.html#a3ab06f5a5929302e21be828a77d871b2">ip_daddr</a>.to_v6().to_bytes().data(), <span class="keyword">sizeof</span>(words));</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            boost::hash_combine(seed, words[0]);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            boost::hash_combine(seed, words[1]);</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            boost::hash_combine(seed, words[2]);</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            boost::hash_combine(seed, words[3]);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        }</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        assert(0);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keywordflow">if</span> (ecmp_load_balance.<a class="code" href="../../d1/db0/classEcmpLoadBalance.html#ac2aab623349620e810a5ed75180b8a6a">is_ip_protocol_set</a>()) {</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        boost::hash_combine(seed, <a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a>);</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    }</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keywordflow">if</span> (ecmp_load_balance.<a class="code" href="../../d1/db0/classEcmpLoadBalance.html#aa20589d3174cda9353a3c3e7e3891b49">is_source_port_set</a>()) {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        boost::hash_combine(seed, <a class="code" href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">sport</a>);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    }</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <span class="keywordflow">if</span> (ecmp_load_balance.<a class="code" href="../../d1/db0/classEcmpLoadBalance.html#a49bdff606ffcbc4a5a25cdf3da71a9a9">is_destination_port_set</a>()) {</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        boost::hash_combine(seed, <a class="code" href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">dport</a>);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    }</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="comment">// When only the sport changes by 2, its observed that only the lower 32</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="comment">// bits of hash changes. Just hash combine upper and lower 32 bit numbers</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="comment">// to randomize in case of incremental sport numbers</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    std::size_t <a class="code" href="../../d5/da8/structPktInfo.html#a0721c1c52ab92da5aa5d7fee4a42d324">hash</a> = 0;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    boost::hash_combine(hash, (seed &amp; 0xFFFFFFFF));</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    boost::hash_combine(hash, (seed &gt;&gt; 16));</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d5/da8/structPktInfo.html#a0721c1c52ab92da5aa5d7fee4a42d324">hash</a>;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;}</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;</div>
<div class="line"><a name="l01499"></a><span class="lineno"><a class="line" href="../../d5/da8/structPktInfo.html#a891cd3fba77b433b18b70658395eb7dc"> 1499</a></span>&#160;uint32_t <a class="code" href="../../d5/da8/structPktInfo.html#a891cd3fba77b433b18b70658395eb7dc">PktInfo::GetUdpPayloadLength</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">ip_proto</a> == IPPROTO_UDP) {</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        <span class="keywordflow">return</span> ntohs(<a class="code" href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">transp</a>.udp-&gt;uh_ulen) - <span class="keyword">sizeof</span>(udphdr);</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    }</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;}</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div>
<div class="line"><a name="l01506"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#aa0229bb40fa7ad85f4289257ab1550a0"> 1506</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/d94/classPktHandler.html#aa0229bb40fa7ad85f4289257ab1550a0">PktHandler::AddPktTrace</a>(<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktModuleName</a> module, <a class="code" href="../../db/d26/classPktTrace.html#a8f01b6f2de3e08339e52afa91deb7fab">PktTrace::Direction</a> dir,</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                             <span class="keyword">const</span> <a class="code" href="../../d5/da8/structPktInfo.html">PktInfo</a> *pkt) {</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <a class="code" href="../../d5/d94/classPktHandler.html#aa56e12e1b77b0cfb23304cf9e261091b">pkt_trace_</a>.at(module).AddPktTrace(<a class="code" href="../../db/d26/classPktTrace.html#a8f01b6f2de3e08339e52afa91deb7fabaf28f823e77efd2ce7c08340332eebf02">PktTrace::In</a>, pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a6fa8d862151b7712ede71fe4c5dc3c85">len</a>, pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#a0edd9430bd89502db5df54dc160bb5e1">pkt</a>,</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                                      &amp;pkt-&gt;<a class="code" href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">agent_hdr</a>);</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;}</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div>
<div class="line"><a name="l01512"></a><span class="lineno"><a class="line" href="../../d5/d94/classPktHandler.html#aa0580e8caa3ba13ba8696a1968034cea"> 1512</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/d94/classPktHandler.html#aa0580e8caa3ba13ba8696a1968034cea">PktHandler::Enqueue</a>(<a class="code" href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktModuleName</a> module,</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                         boost::shared_ptr&lt;PktInfo&gt; pkt_info) {</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="keywordflow">if</span> (!(<a class="code" href="../../d5/d94/classPktHandler.html#aad1c6cf849c57ec2e075359a4a3c4e38">proto_list_</a>.at(module)-&gt;Enqueue(pkt_info))) {</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <a class="code" href="../../d5/d94/classPktHandler.html#a088c671feb2ecacc7b0f56ee1e513106">stats_</a>.<a class="code" href="../../dd/d88/structPktHandler_1_1PktStats.html#a82bf97de645ed9bafd501dbd734ce462">PktQThresholdExceeded</a>(module);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;}</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div>
<div class="line"><a name="l01521"></a><span class="lineno"><a class="line" href="../../df/d48/structPktTrace_1_1Pkt.html#a7880fe4fe129cc6e28baee206b10ce3c"> 1521</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/d48/structPktTrace_1_1Pkt.html#a7880fe4fe129cc6e28baee206b10ce3c">PktTrace::Pkt::Copy</a>(<a class="code" href="../../db/d26/classPktTrace.html#a8f01b6f2de3e08339e52afa91deb7fab">Direction</a> d, std::size_t l, uint8_t *msg,</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                         std::size_t pkt_trace_size, <span class="keyword">const</span> <a class="code" href="../../d6/d0d/structAgentHdr.html">AgentHdr</a> *hdr) {</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    uint16_t hdr_len = <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d0d/structAgentHdr.html">AgentHdr</a>);</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <a class="code" href="../../df/d48/structPktTrace_1_1Pkt.html#a94aff53da0833902d5f3a5903db5141a">dir</a> = d;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <a class="code" href="../../df/d48/structPktTrace_1_1Pkt.html#a8eb05f93a6d4c6968e3c0854a9af1195">len</a> = l + hdr_len;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    memcpy(<a class="code" href="../../df/d48/structPktTrace_1_1Pkt.html#a2353685a5c5004102912d441f0dbe37b">pkt</a>, hdr, hdr_len);</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    memcpy(<a class="code" href="../../df/d48/structPktTrace_1_1Pkt.html#a2353685a5c5004102912d441f0dbe37b">pkt</a> + hdr_len, msg, std::min(l, (pkt_trace_size - hdr_len)));</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;}</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;</div>
<div class="line"><a name="l01530"></a><span class="lineno"><a class="line" href="../../db/d26/classPktTrace.html#a5d21d994689ac9afd3280342b0bbaa93"> 1530</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../db/d26/classPktTrace.html#a5d21d994689ac9afd3280342b0bbaa93">PktTrace::AddPktTrace</a>(<a class="code" href="../../db/d26/classPktTrace.html#a8f01b6f2de3e08339e52afa91deb7fab">Direction</a> dir, std::size_t len, uint8_t *msg,</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                           <span class="keyword">const</span> <a class="code" href="../../d6/d0d/structAgentHdr.html">AgentHdr</a> *hdr) {</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../db/d26/classPktTrace.html#ad8811bfb16862308e383be2969d1dabe">num_buffers_</a>) {</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <a class="code" href="../../db/d26/classPktTrace.html#ad02cd98a2a9331a8e207bb0d8b4ca01c">end_</a> = (<a class="code" href="../../db/d26/classPktTrace.html#ad02cd98a2a9331a8e207bb0d8b4ca01c">end_</a> + 1) % <a class="code" href="../../db/d26/classPktTrace.html#ad8811bfb16862308e383be2969d1dabe">num_buffers_</a>;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        <a class="code" href="../../db/d26/classPktTrace.html#a322ad3358bff708d99e6bcf75dd5814f">pkt_buffer_</a>[<a class="code" href="../../db/d26/classPktTrace.html#ad02cd98a2a9331a8e207bb0d8b4ca01c">end_</a>].Copy(dir, len, msg, <a class="code" href="../../db/d26/classPktTrace.html#a505b67de244e4d3315cf67b7689c3ef2">pkt_trace_size_</a>, hdr);</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        <a class="code" href="../../db/d26/classPktTrace.html#a03cc3da35006564e422b533fb72ad637">count_</a> = std::min((<a class="code" href="../../db/d26/classPktTrace.html#a03cc3da35006564e422b533fb72ad637">count_</a> + 1), (uint32_t) <a class="code" href="../../db/d26/classPktTrace.html#ad8811bfb16862308e383be2969d1dabe">num_buffers_</a>);</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    }</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;}</div>
<div class="ttc" id="classAgent_html_a18c4d54957310b7374e8cb9f8be6cf63"><div class="ttname"><a href="../../d8/dfe/classAgent.html#a18c4d54957310b7374e8cb9f8be6cf63">Agent::MeasureQueueDelay</a></div><div class="ttdeci">bool MeasureQueueDelay()</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0e/agent_8cc_source.html#l01135">agent.cc:1135</a></div></div>
<div class="ttc" id="structPktTrace_1_1Pkt_html_a94aff53da0833902d5f3a5903db5141a"><div class="ttname"><a href="../../df/d48/structPktTrace_1_1Pkt.html#a94aff53da0833902d5f3a5903db5141a">PktTrace::Pkt::dir</a></div><div class="ttdeci">Direction dir</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d22/pkt__trace_8h_source.html#l00025">pkt_trace.h:25</a></div></div>
<div class="ttc" id="classVmInterface_html_a5cc9d099287c652b47f28a64fcecb8d6"><div class="ttname"><a href="../../d5/d21/classVmInterface.html#a5cc9d099287c652b47f28a64fcecb8d6">VmInterface::FatFlowIgnoreAddressType</a></div><div class="ttdeci">FatFlowIgnoreAddressType</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d62/vm__interface_8h_source.html#l00433">vm_interface.h:433</a></div></div>
<div class="ttc" id="classPktHandler_html_a770ff0595b2a1eb752f5f54aad85ed26a6f5182892fafb5ab237d01e0b540e76a"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a6f5182892fafb5ab237d01e0b540e76a">PktHandler::MAC_LEARNING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00244">pkt_handler.h:244</a></div></div>
<div class="ttc" id="classBridgeAgentRouteTable_html"><div class="ttname"><a href="../../d8/d2e/classBridgeAgentRouteTable.html">BridgeAgentRouteTable</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d3b/bridge__route_8h_source.html#l00013">bridge_route.h:13</a></div></div>
<div class="ttc" id="structPktInfo_html_a3638ba7e7af141eb2eefc289f7998597"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a3638ba7e7af141eb2eefc289f7998597">PktInfo::dport</a></div><div class="ttdeci">uint32_t dport</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00398">pkt_handler.h:398</a></div></div>
<div class="ttc" id="structPktTrace_1_1Pkt_html_a8eb05f93a6d4c6968e3c0854a9af1195"><div class="ttname"><a href="../../df/d48/structPktTrace_1_1Pkt.html#a8eb05f93a6d4c6968e3c0854a9af1195">PktTrace::Pkt::len</a></div><div class="ttdeci">std::size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d22/pkt__trace_8h_source.html#l00026">pkt_trace.h:26</a></div></div>
<div class="ttc" id="structPktInfo_html_a6eed2de2e29f912c86902b283e7409c6"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a6eed2de2e29f912c86902b283e7409c6">PktInfo::ip_saddr</a></div><div class="ttdeci">IpAddress ip_saddr</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00394">pkt_handler.h:394</a></div></div>
<div class="ttc" id="structAgentHdr_html_aee9a9c979ed73097cea9e1762eb8c8a3abb5b21d6fa7ea8735a4f67d331a7761f"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3abb5b21d6fa7ea8735a4f67d331a7761f">AgentHdr::TRAP_MAC_LEARN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00148">pkt_handler.h:148</a></div></div>
<div class="ttc" id="classPktHandler_html_a7c1b143f05f7acd900f0e1d4185694dd"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a7c1b143f05f7acd900f0e1d4185694dd">PktHandler::PktTraceCallback</a></div><div class="ttdeci">boost::function&lt; void(PktTrace::Pkt &amp;)&gt; PktTraceCallback</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00227">pkt_handler.h:227</a></div></div>
<div class="ttc" id="classPktHandler_html_a66261e744933110998a856d1459cfc41"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a66261e744933110998a856d1459cfc41">PktHandler::IsSegmentHealthCheckPacket</a></div><div class="ttdeci">bool IsSegmentHealthCheckPacket(const PktInfo *pkt_info, const Interface *interface)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00232">pkt_handler.cc:232</a></div></div>
<div class="ttc" id="structAgentHdr_html_aee9a9c979ed73097cea9e1762eb8c8a3ad93e60118252978a72c45b6d8a83cda7"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3ad93e60118252978a72c45b6d8a83cda7">AgentHdr::TRAP_FLOW_ACTION_HOLD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00146">pkt_handler.h:146</a></div></div>
<div class="ttc" id="classInterfaceNH_html_a4372449ea4b16b5d92b3e469953346d8"><div class="ttname"><a href="../../de/d30/classInterfaceNH.html#a4372449ea4b16b5d92b3e469953346d8">InterfaceNH::GetInterface</a></div><div class="ttdeci">const Interface * GetInterface() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01293">nexthop.h:1293</a></div></div>
<div class="ttc" id="classPktHandler_html_a3884910dca29dd35fc0944bbb227334e"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a3884910dca29dd35fc0944bbb227334e">PktHandler::ParseVxlan</a></div><div class="ttdeci">int ParseVxlan(PktInfo *pkt_info, uint8_t *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00880">pkt_handler.cc:880</a></div></div>
<div class="ttc" id="structPktInfo_html_a81538ab2560dc7e284038ad3f5e035d2"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a81538ab2560dc7e284038ad3f5e035d2">PktInfo::AllocPacketBuffer</a></div><div class="ttdeci">void AllocPacketBuffer(Agent *agent, uint32_t module, uint16_t len, uint32_t mdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01410">pkt_handler.cc:1410</a></div></div>
<div class="ttc" id="structPktInfo_html_a9281e06ce82d613719895da2c92387fd"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a9281e06ce82d613719895da2c92387fd">PktInfo::family</a></div><div class="ttdeci">Address::Family family</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00386">pkt_handler.h:386</a></div></div>
<div class="ttc" id="pkt__handler_8h_html_a478f5be6fb4bfb09b235bb50cf806cc9"><div class="ttname"><a href="../../d3/d79/pkt__handler_8h.html#a478f5be6fb4bfb09b235bb50cf806cc9">DHCP_SERVER_PORT</a></div><div class="ttdeci">#define DHCP_SERVER_PORT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00029">pkt_handler.h:29</a></div></div>
<div class="ttc" id="packet__buffer_8h_html_a78def6b5ee9b81aaa6519da4cf9253bb"><div class="ttname"><a href="../../d4/dc5/packet__buffer_8h.html#a78def6b5ee9b81aaa6519da4cf9253bb">PacketBufferPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; PacketBuffer &gt; PacketBufferPtr</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/packet__buffer_8h_source.html#l00018">packet_buffer.h:18</a></div></div>
<div class="ttc" id="classPktHandler_html_a770ff0595b2a1eb752f5f54aad85ed26a686ca81e66d03b10cc7516ffc5c63162"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a686ca81e66d03b10cc7516ffc5c63162">PktHandler::ICMP_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00241">pkt_handler.h:241</a></div></div>
<div class="ttc" id="classEcmpLoadBalance_html_aa20589d3174cda9353a3c3e7e3891b49"><div class="ttname"><a href="../../d1/db0/classEcmpLoadBalance.html#aa20589d3174cda9353a3c3e7e3891b49">EcmpLoadBalance::is_source_port_set</a></div><div class="ttdeci">bool is_source_port_set() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d7d/ecmp__load__balance_8h_source.html#l00146">ecmp_load_balance.h:146</a></div></div>
<div class="ttc" id="structPktInfo_html_a9af3e51b7169506f28e8bda89bcd0bf1"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a9af3e51b7169506f28e8bda89bcd0bf1">PktInfo::is_fat_flow_src_prefix</a></div><div class="ttdeci">bool is_fat_flow_src_prefix</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00414">pkt_handler.h:414</a></div></div>
<div class="ttc" id="structPktStatsType_html_a525d0f71edc19ac0d482b274fdc13866a8e63441a554994188c09fc3911c67433"><div class="ttname"><a href="../../d5/d67/structPktStatsType.html#a525d0f71edc19ac0d482b274fdc13866a8e63441a554994188c09fc3911c67433">PktStatsType::PKT_RX_ENQUEUE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00114">pkt_handler.h:114</a></div></div>
<div class="ttc" id="classPktHandler_html_aa0580e8caa3ba13ba8696a1968034cea"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#aa0580e8caa3ba13ba8696a1968034cea">PktHandler::Enqueue</a></div><div class="ttdeci">void Enqueue(PktModuleName module, boost::shared_ptr&lt; PktInfo &gt; pkt_info)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01512">pkt_handler.cc:1512</a></div></div>
<div class="ttc" id="classPktHandler_html_a50dc12a5515d56cc7eaa24577ab63e60"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a50dc12a5515d56cc7eaa24577ab63e60">PktHandler::ParseEthernetHeader</a></div><div class="ttdeci">int ParseEthernetHeader(PktInfo *pkt_info, uint8_t *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00528">pkt_handler.cc:528</a></div></div>
<div class="ttc" id="classAddress_html_a58d0c167a9c218030c678110e9e69987a1d93db3747cf6c75ab622601c30544a0"><div class="ttname"><a href="../../de/d6b/classAddress.html#a58d0c167a9c218030c678110e9e69987a1d93db3747cf6c75ab622601c30544a0">Address::INET</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9b/address_8h_source.html#l00026">address.h:26</a></div></div>
<div class="ttc" id="classCompositeNH_html_abfeecd1560f13a5cc4641ad39580126f"><div class="ttname"><a href="../../dd/d76/classCompositeNH.html#abfeecd1560f13a5cc4641ad39580126f">CompositeNH::GetFirstLocalEcmpMemberInterface</a></div><div class="ttdeci">const Interface * GetFirstLocalEcmpMemberInterface() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dab/nexthop_8cc_source.html#l01836">nexthop.cc:1836</a></div></div>
<div class="ttc" id="structVmInterface_1_1FatFlowList_html_adac7d614415b749041946a012374bc94"><div class="ttname"><a href="../../d2/d38/structVmInterface_1_1FatFlowList.html#adac7d614415b749041946a012374bc94">VmInterface::FatFlowList::list_</a></div><div class="ttdeci">FatFlowEntrySet list_</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d62/vm__interface_8h_source.html#l01122">vm_interface.h:1122</a></div></div>
<div class="ttc" id="classVmInterface_html_a685793cc3053753bcb248561ab1161c0a544b39b02f30d6b443fefe25c15ca6d4"><div class="ttname"><a href="../../d5/d21/classVmInterface.html#a685793cc3053753bcb248561ab1161c0a544b39b02f30d6b443fefe25c15ca6d4">VmInterface::GATEWAY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d62/vm__interface_8h_source.html#l00404">vm_interface.h:404</a></div></div>
<div class="ttc" id="classInterface_html_aa4e925f921176be2ba014008dadde813"><div class="ttname"><a href="../../d0/dcc/classInterface.html#aa4e925f921176be2ba014008dadde813">Interface::type</a></div><div class="ttdeci">Type type() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/interface_8h_source.html#l00112">interface.h:112</a></div></div>
<div class="ttc" id="structPktInfo_html_aac0515411ab954657696f52a8a46d5fe"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#aac0515411ab954657696f52a8a46d5fe">PktInfo::b_smac</a></div><div class="ttdeci">MacAddress b_smac</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00402">pkt_handler.h:402</a></div></div>
<div class="ttc" id="classAgentStats_html_a32321e2698ee8c2fc079c717921a3511"><div class="ttname"><a href="../../d0/d98/classAgentStats.html#a32321e2698ee8c2fc079c717921a3511">AgentStats::incr_pkt_invalid_ip_pkt</a></div><div class="ttdeci">void incr_pkt_invalid_ip_pkt()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d16/agent__stats_8h_source.html#l00146">agent_stats.h:146</a></div></div>
<div class="ttc" id="pkt__handler_8h_html_a3718f13a4255901a5cd24fb3ad114ba6"><div class="ttname"><a href="../../d3/d79/pkt__handler_8h.html#a3718f13a4255901a5cd24fb3ad114ba6">BFD_ECHO_PORT</a></div><div class="ttdeci">#define BFD_ECHO_PORT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00034">pkt_handler.h:34</a></div></div>
<div class="ttc" id="structAgentHdr_html_a542c76d864fa60bfc5cc62446cd4c142"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#a542c76d864fa60bfc5cc62446cd4c142">AgentHdr::ifindex</a></div><div class="ttdeci">uint32_t ifindex</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00180">pkt_handler.h:180</a></div></div>
<div class="ttc" id="classPktHandler_html_ab5a99acd484c2d1099bfa8e09a074506"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#ab5a99acd484c2d1099bfa8e09a074506">PktHandler::SendMessage</a></div><div class="ttdeci">void SendMessage(PktModuleName mod, InterTaskMsg *msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01054">pkt_handler.cc:1054</a></div></div>
<div class="ttc" id="classEcmpLoadBalance_html_a7c33cd2865df35bda4871fc3a2fd3dab"><div class="ttname"><a href="../../d1/db0/classEcmpLoadBalance.html#a7c33cd2865df35bda4871fc3a2fd3dab">EcmpLoadBalance::is_destination_ip_set</a></div><div class="ttdeci">bool is_destination_ip_set() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d7d/ecmp__load__balance_8h_source.html#l00143">ecmp_load_balance.h:143</a></div></div>
<div class="ttc" id="classAgent_html_ab8529257124b8dcc9273d1d77c26111b"><div class="ttname"><a href="../../d8/dfe/classAgent.html#ab8529257124b8dcc9273d1d77c26111b">Agent::GetInstance</a></div><div class="ttdeci">static Agent * GetInstance()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9e/agent_8h_source.html#l00436">agent.h:436</a></div></div>
<div class="ttc" id="structPktInfo_html_ac71d0eccc1b62c72e8bab70e0b5872e8"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#ac71d0eccc1b62c72e8bab70e0b5872e8">PktInfo::max_pkt_len</a></div><div class="ttdeci">uint16_t max_pkt_len</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00381">pkt_handler.h:381</a></div></div>
<div class="ttc" id="classTaskScheduler_html"><div class="ttname"><a href="../../df/ddc/classTaskScheduler.html">TaskScheduler</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/da4/task_8h_source.html#l00156">task.h:156</a></div></div>
<div class="ttc" id="classPktTrace_html_a8f01b6f2de3e08339e52afa91deb7fab"><div class="ttname"><a href="../../db/d26/classPktTrace.html#a8f01b6f2de3e08339e52afa91deb7fab">PktTrace::Direction</a></div><div class="ttdeci">Direction</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d22/pkt__trace_8h_source.html#l00018">pkt_trace.h:18</a></div></div>
<div class="ttc" id="classVrfEntry_html"><div class="ttname"><a href="../../d2/d3d/classVrfEntry.html">VrfEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d21/vrf_8h_source.html#l00086">vrf.h:86</a></div></div>
<div class="ttc" id="classNextHopTable_html_af380097a60be5a6266180aad98900022"><div class="ttname"><a href="../../df/d45/classNextHopTable.html#af380097a60be5a6266180aad98900022">NextHopTable::FindNextHop</a></div><div class="ttdeci">NextHop * FindNextHop(size_t index)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dab/nexthop_8cc_source.html#l03445">nexthop.cc:3445</a></div></div>
<div class="ttc" id="structPktInfo_html_aa8d254e49c0d126842fa59208310500d"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#aa8d254e49c0d126842fa59208310500d">PktInfo::ip</a></div><div class="ttdeci">struct ip * ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00423">pkt_handler.h:423</a></div></div>
<div class="ttc" id="structAgentHdr_html_aee9a9c979ed73097cea9e1762eb8c8a3af95ea993e71663741f92769696d7630a"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3af95ea993e71663741f92769696d7630a">AgentHdr::TRAP_ZERO_TTL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00144">pkt_handler.h:144</a></div></div>
<div class="ttc" id="structPktInfo_html_aea2bd9b3afb28f7666addcfb4ea5c6cc"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#aea2bd9b3afb28f7666addcfb4ea5c6cc">PktInfo::transp</a></div><div class="ttdeci">union PktInfo::@8 transp</div></div>
<div class="ttc" id="classWorkQueue_html_a6749fce09b480760e1313b900a1938c0"><div class="ttname"><a href="../../d4/d0c/classWorkQueue.html#a6749fce09b480760e1313b900a1938c0">WorkQueue::Shutdown</a></div><div class="ttdeci">void Shutdown(bool delete_entries=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d47/queue__task_8h_source.html#l00152">queue_task.h:152</a></div></div>
<div class="ttc" id="pkt__handler_8cc_html_a3517b6542d72a569bd903923b6413b65"><div class="ttname"><a href="../../df/d76/pkt__handler_8cc.html#a3517b6542d72a569bd903923b6413b65">PKT_TRACE</a></div><div class="ttdeci">#define PKT_TRACE(obj, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00035">pkt_handler.cc:35</a></div></div>
<div class="ttc" id="classPktHandler_html_a770ff0595b2a1eb752f5f54aad85ed26a2615c28e77125c06a1780277b5d611c9"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a2615c28e77125c06a1780277b5d611c9">PktHandler::DHCPV6</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00236">pkt_handler.h:236</a></div></div>
<div class="ttc" id="classPktHandler_html_a73f133f5d0c9a5295495b2068f30a6be"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a73f133f5d0c9a5295495b2068f30a6be">PktHandler::SetOuterIp</a></div><div class="ttdeci">void SetOuterIp(PktInfo *pkt_info, uint8_t *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00513">pkt_handler.cc:513</a></div></div>
<div class="ttc" id="structComposite_html_a4747d68b2bad61ba02a5223f77690d5ea5d96c2170cd40688986f866367f3d94f"><div class="ttname"><a href="../../de/d98/structComposite.html#a4747d68b2bad61ba02a5223f77690d5ea5d96c2170cd40688986f866367f3d94f">Composite::LOCAL_ECMP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01593">nexthop.h:1593</a></div></div>
<div class="ttc" id="classPktTrace_html_a8f01b6f2de3e08339e52afa91deb7faba16f5274796dd53156f532ba06345fb82"><div class="ttname"><a href="../../db/d26/classPktTrace.html#a8f01b6f2de3e08339e52afa91deb7faba16f5274796dd53156f532ba06345fb82">PktTrace::Out</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d22/pkt__trace_8h_source.html#l00020">pkt_trace.h:20</a></div></div>
<div class="ttc" id="classInterface_html_a302160fc71c3eb559ca3c63e4b75f413"><div class="ttname"><a href="../../d0/dcc/classInterface.html#a302160fc71c3eb559ca3c63e4b75f413">Interface::id</a></div><div class="ttdeci">const uint32_t id() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/interface_8h_source.html#l00123">interface.h:123</a></div></div>
<div class="ttc" id="classAgent_html_afc2cbe5f2dc7a47e06cc0b2c291e4f01"><div class="ttname"><a href="../../d8/dfe/classAgent.html#afc2cbe5f2dc7a47e06cc0b2c291e4f01">Agent::nexthop_table</a></div><div class="ttdeci">NextHopTable * nexthop_table() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9e/agent_8h_source.html#l00475">agent.h:475</a></div></div>
<div class="ttc" id="classTunnelType_html_afeaf43c73b054654af0b97ae3a711583"><div class="ttname"><a href="../../d3/d08/classTunnelType.html#afeaf43c73b054654af0b97ae3a711583">TunnelType::SetType</a></div><div class="ttdeci">void SetType(TunnelType::Type type)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l00304">nexthop.h:304</a></div></div>
<div class="ttc" id="structMplsHdr_html"><div class="ttname"><a href="../../d2/db6/structMplsHdr.html">MplsHdr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00079">pkt_handler.h:79</a></div></div>
<div class="ttc" id="classPktHandler_html_a8ca8e09d434dd226b363f80c908a86d7"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a8ca8e09d434dd226b363f80c908a86d7">PktHandler::kMulticastControlWord</a></div><div class="ttdeci">static const uint32_t kMulticastControlWord</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00229">pkt_handler.h:229</a></div></div>
<div class="ttc" id="structPktHandler_1_1PacketBufferEnqueueItem_html"><div class="ttname"><a href="../../df/db3/structPktHandler_1_1PacketBufferEnqueueItem.html">PktHandler::PacketBufferEnqueueItem</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00268">pkt_handler.h:268</a></div></div>
<div class="ttc" id="pkt__handler_8h_html_ab2fd1889bb669d854b61d4a5fee3e3ec"><div class="ttname"><a href="../../d3/d79/pkt__handler_8h.html#ab2fd1889bb669d854b61d4a5fee3e3ec">DHCPV6_SERVER_PORT</a></div><div class="ttdeci">#define DHCPV6_SERVER_PORT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00031">pkt_handler.h:31</a></div></div>
<div class="ttc" id="classAgentStats_html_adf4bcf3965777fa50545ff13520e5bf0"><div class="ttname"><a href="../../d0/d98/classAgentStats.html#adf4bcf3965777fa50545ff13520e5bf0">AgentStats::incr_pkt_exceptions</a></div><div class="ttdeci">void incr_pkt_exceptions()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d16/agent__stats_8h_source.html#l00128">agent_stats.h:128</a></div></div>
<div class="ttc" id="structTunnelInfo_html_ac83d19aa9af7a0b6ce7d600addcca6a4"><div class="ttname"><a href="../../d6/d6b/structTunnelInfo.html#ac83d19aa9af7a0b6ce7d600addcca6a4">TunnelInfo::ip_daddr</a></div><div class="ttdeci">uint32_t ip_daddr</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00216">pkt_handler.h:216</a></div></div>
<div class="ttc" id="structPktInfo_html_ab6434c7699a6c59eb75d4f8833d2aa66"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#ab6434c7699a6c59eb75d4f8833d2aa66">PktInfo::ip_proto</a></div><div class="ttdeci">uint8_t ip_proto</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00396">pkt_handler.h:396</a></div></div>
<div class="ttc" id="flow__table_8h_html"><div class="ttname"><a href="../../d7/d01/flow__table_8h.html">flow_table.h</a></div></div>
<div class="ttc" id="structPktInfo_html_adce6da79b75d42f77d439e7ad2b4dd99"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#adce6da79b75d42f77d439e7ad2b4dd99">PktInfo::module</a></div><div class="ttdeci">PktHandler::PktModuleName module</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00378">pkt_handler.h:378</a></div></div>
<div class="ttc" id="classAgent_html_abbc0825c7dfc8d97dd49c46b8b842352"><div class="ttname"><a href="../../d8/dfe/classAgent.html#abbc0825c7dfc8d97dd49c46b8b842352">Agent::vhost_interface</a></div><div class="ttdeci">const Interface * vhost_interface() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9e/agent_8h_source.html#l00935">agent.h:935</a></div></div>
<div class="ttc" id="classPktHandler_html_a770ff0595b2a1eb752f5f54aad85ed26a435658619a4a080ccfe55462edf90f32"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a435658619a4a080ccfe55462edf90f32">PktHandler::ICMPV6_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00242">pkt_handler.h:242</a></div></div>
<div class="ttc" id="classAddress_html_a58d0c167a9c218030c678110e9e69987aa474968a53fad182e1b6340dd2eb80fc"><div class="ttname"><a href="../../de/d6b/classAddress.html#a58d0c167a9c218030c678110e9e69987aa474968a53fad182e1b6340dd2eb80fc">Address::INET6</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9b/address_8h_source.html#l00027">address.h:27</a></div></div>
<div class="ttc" id="classPktHandler_html_aa22e71944d69f51845c18f88403b34d1"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#aa22e71944d69f51845c18f88403b34d1">PktHandler::ParseUserPkt</a></div><div class="ttdeci">int ParseUserPkt(PktInfo *pkt_info, Interface *intf, PktType::Type &amp;pkt_type, uint8_t *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00919">pkt_handler.cc:919</a></div></div>
<div class="ttc" id="classMplsLabel_html_a120304e249c7b7391d2448a966d21f95"><div class="ttname"><a href="../../df/de8/classMplsLabel.html#a120304e249c7b7391d2448a966d21f95">MplsLabel::nexthop</a></div><div class="ttdeci">const NextHop * nexthop() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d9a/mpls_8h_source.html#l00080">mpls.h:80</a></div></div>
<div class="ttc" id="classInterface_html_aaa22b71198a348ff9f0af382037e3270"><div class="ttname"><a href="../../d0/dcc/classInterface.html#aaa22b71198a348ff9f0af382037e3270">Interface::dns_enabled</a></div><div class="ttdeci">bool dns_enabled() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/interface_8h_source.html#l00126">interface.h:126</a></div></div>
<div class="ttc" id="structVxlanHdr_html_a3c9d226cf3af164d153c898aef6492ba"><div class="ttname"><a href="../../d9/d3c/structVxlanHdr.html#a3c9d226cf3af164d153c898aef6492ba">VxlanHdr::vxlan_id</a></div><div class="ttdeci">uint32_t vxlan_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00092">pkt_handler.h:92</a></div></div>
<div class="ttc" id="classTunnelType_html_a3848db71a84631798eaa36c12369b977afba1693ef52847cfcfd2195e98351f16"><div class="ttname"><a href="../../d3/d08/classTunnelType.html#a3848db71a84631798eaa36c12369b977afba1693ef52847cfcfd2195e98351f16">TunnelType::VXLAN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l00243">nexthop.h:243</a></div></div>
<div class="ttc" id="structAgentHdr_html_aee9a9c979ed73097cea9e1762eb8c8a3a9b9afd835ae7a0b3421f92f12dd991df"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3a9b9afd835ae7a0b3421f92f12dd991df">AgentHdr::TRAP_FLOW_MISS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00137">pkt_handler.h:137</a></div></div>
<div class="ttc" id="address_8h_html_a7055b8d880410aad1e3ba8c041397b6c"><div class="ttname"><a href="../../d9/d9b/address_8h.html#a7055b8d880410aad1e3ba8c041397b6c">IpAddress</a></div><div class="ttdeci">boost::asio::ip::address IpAddress</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9b/address_8h_source.html#l00013">address.h:13</a></div></div>
<div class="ttc" id="classAgent_html_ab6d30c99e876ef87e4d7a752bdcd2be2"><div class="ttname"><a href="../../d8/dfe/classAgent.html#ab6d30c99e876ef87e4d7a752bdcd2be2">Agent::vrrp_mac</a></div><div class="ttdeci">static const MacAddress &amp; vrrp_mac()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9e/agent_8h_source.html#l00439">agent.h:439</a></div></div>
<div class="ttc" id="classTunnelType_html_a9b1ab31bf0bf3d8e704196252696c155"><div class="ttname"><a href="../../d3/d08/classTunnelType.html#a9b1ab31bf0bf3d8e704196252696c155">TunnelType::GetType</a></div><div class="ttdeci">Type GetType() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l00303">nexthop.h:303</a></div></div>
<div class="ttc" id="structPktInfo_html_a6aed8011421e47e8fef0273ab76d2be9"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a6aed8011421e47e8fef0273ab76d2be9">PktInfo::data</a></div><div class="ttdeci">uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00383">pkt_handler.h:383</a></div></div>
<div class="ttc" id="pkt__init_8h_html"><div class="ttname"><a href="../../d2/db3/pkt__init_8h.html">pkt_init.h</a></div></div>
<div class="ttc" id="structTunnelInfo_html_a0db8c0a4a1e39b970fcf8c59d03460d8"><div class="ttname"><a href="../../d6/d6b/structTunnelInfo.html#a0db8c0a4a1e39b970fcf8c59d03460d8">TunnelInfo::eth</a></div><div class="ttdeci">struct ether_header * eth</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00217">pkt_handler.h:217</a></div></div>
<div class="ttc" id="classCompositeNH_html_a6522cb5b04b6a0662d28dfddf8c3ba99"><div class="ttname"><a href="../../dd/d76/classCompositeNH.html#a6522cb5b04b6a0662d28dfddf8c3ba99">CompositeNH::layer2_control_word</a></div><div class="ttdeci">bool layer2_control_word() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01918">nexthop.h:1918</a></div></div>
<div class="ttc" id="classAgent_html_a98ebefc0499e93352429ddc6f94edf6f"><div class="ttname"><a href="../../d8/dfe/classAgent.html#a98ebefc0499e93352429ddc6f94edf6f">Agent::stats</a></div><div class="ttdeci">AgentStats * stats() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0e/agent_8cc_source.html#l00880">agent.cc:880</a></div></div>
<div class="ttc" id="structPktInfo_html_a3bd2813e39e9762613998eebeeb41298"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a3bd2813e39e9762613998eebeeb41298">PktInfo::ip_ff_src_prefix</a></div><div class="ttdeci">IpAddress ip_ff_src_prefix</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00415">pkt_handler.h:415</a></div></div>
<div class="ttc" id="structAgentHdr_html_aee9a9c979ed73097cea9e1762eb8c8a3affceed1c7808f47a4d18c3035c2cca4e"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3affceed1c7808f47a4d18c3035c2cca4e">AgentHdr::TRAP_TOR_CONTROL_PKT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00143">pkt_handler.h:143</a></div></div>
<div class="ttc" id="classDiagTable_html_a9967a8613e283143fe536988c0f99b9d"><div class="ttname"><a href="../../dc/d16/classDiagTable.html#a9967a8613e283143fe536988c0f99b9d">DiagTable::kDiagData</a></div><div class="ttdeci">static const std::string kDiagData</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dd2/diag_8h_source.html#l00107">diag.h:107</a></div></div>
<div class="ttc" id="structTunnelInfo_html_ad485c8c0d02fcbbc77f192d40742b92c"><div class="ttname"><a href="../../d6/d6b/structTunnelInfo.html#ad485c8c0d02fcbbc77f192d40742b92c">TunnelInfo::label</a></div><div class="ttdeci">uint32_t label</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00212">pkt_handler.h:212</a></div></div>
<div class="ttc" id="structPktType_html_a6d97cb2f45ba72589c8defcf6b9ccadbae7d90e4d69f8c599bf0d411e9dccfbb8"><div class="ttname"><a href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadbae7d90e4d69f8c599bf0d411e9dccfbb8">PktType::SCTP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00106">pkt_handler.h:106</a></div></div>
<div class="ttc" id="pkt__handler_8h_html_a504d2569df42a9393272b08ab357ea33"><div class="ttname"><a href="../../d3/d79/pkt__handler_8h.html#a504d2569df42a9393272b08ab357ea33">IANA_MPLS_OVER_UDP_DEST_PORT</a></div><div class="ttdeci">#define IANA_MPLS_OVER_UDP_DEST_PORT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00037">pkt_handler.h:37</a></div></div>
<div class="ttc" id="structPktInfo_html_a09de18bc5de08c1435c39d2de5dca0db"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a09de18bc5de08c1435c39d2de5dca0db">PktInfo::PktInfo</a></div><div class="ttdeci">PktInfo(Agent *agent, uint32_t buff_len, PktHandler::PktModuleName module, uint32_t mdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01365">pkt_handler.cc:1365</a></div></div>
<div class="ttc" id="structPktInfo_html_ad0dd507e60f663284c59c811a58389a7"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#ad0dd507e60f663284c59c811a58389a7">PktInfo::set_len</a></div><div class="ttdeci">void set_len(uint32_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01419">pkt_handler.cc:1419</a></div></div>
<div class="ttc" id="structPktInfo_html"><div class="ttname"><a href="../../d5/da8/structPktInfo.html">PktInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00377">pkt_handler.h:377</a></div></div>
<div class="ttc" id="structPktInfo_html_a1abd34b8ab1a3f6415a551897cb580ed"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a1abd34b8ab1a3f6415a551897cb580ed">PktInfo::dmac</a></div><div class="ttdeci">MacAddress dmac</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00393">pkt_handler.h:393</a></div></div>
<div class="ttc" id="structTunnelInfo_html_a6384a1274c1fb64781543fb090fa0960"><div class="ttname"><a href="../../d6/d6b/structTunnelInfo.html#a6384a1274c1fb64781543fb090fa0960">TunnelInfo::ip_saddr</a></div><div class="ttdeci">uint32_t ip_saddr</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00215">pkt_handler.h:215</a></div></div>
<div class="ttc" id="structAgentHdr_html_aee9a9c979ed73097cea9e1762eb8c8a3a83e2e344eeb4c075f179033b264db1ee"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3a83e2e344eeb4c075f179033b264db1ee">AgentHdr::TRAP_DIAG</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00139">pkt_handler.h:139</a></div></div>
<div class="ttc" id="classPktHandler_html_ae22c44588d24996ffd9cf61509954f14"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#ae22c44588d24996ffd9cf61509954f14">PktHandler::IsToRDevice</a></div><div class="ttdeci">bool IsToRDevice(uint32_t vrf_id, const IpAddress &amp;ip)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01101">pkt_handler.cc:1101</a></div></div>
<div class="ttc" id="structPktInfo_html_a4690470285a966d67e56a42f5f99fb52"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a4690470285a966d67e56a42f5f99fb52">PktInfo::UpdateHeaderPtr</a></div><div class="ttdeci">void UpdateHeaderPtr()</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01424">pkt_handler.cc:1424</a></div></div>
<div class="ttc" id="classAgentDBTable_html_a224ced1237aec89a4fb72dd3b0f5be13"><div class="ttname"><a href="../../db/d09/classAgentDBTable.html#a224ced1237aec89a4fb72dd3b0f5be13">AgentDBTable::FindActiveEntry</a></div><div class="ttdeci">AgentDBEntry * FindActiveEntry(const DBEntry *key)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d3f/agent__db_8cc_source.html#l00110">agent_db.cc:110</a></div></div>
<div class="ttc" id="structPktHandler_1_1PktStats_html_af5e6cd88c360f963267fa99e947bb307"><div class="ttname"><a href="../../dd/d88/structPktHandler_1_1PktStats.html#af5e6cd88c360f963267fa99e947bb307">PktHandler::PktStats::PktSent</a></div><div class="ttdeci">void PktSent(PktModuleName mod)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01326">pkt_handler.cc:1326</a></div></div>
<div class="ttc" id="classAgent_html_a1763098920517b4774b95a4287ac71d0"><div class="ttname"><a href="../../d8/dfe/classAgent.html#a1763098920517b4774b95a4287ac71d0">Agent::interface_table</a></div><div class="ttdeci">InterfaceTable * interface_table() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9e/agent_8h_source.html#l00465">agent.h:465</a></div></div>
<div class="ttc" id="classTunnelNH_html_ab6838feedf038e489355b779bfe2acf5"><div class="ttname"><a href="../../d0/daf/classTunnelNH.html#ab6838feedf038e489355b779bfe2acf5">TunnelNH::GetDip</a></div><div class="ttdeci">const Ip4Address * GetDip() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd8/tunnel__nh_8h_source.html#l00037">tunnel_nh.h:37</a></div></div>
<div class="ttc" id="structPktHandler_1_1PktStats_html_a04f2c7f99b21f1517690548ce2f1aff8"><div class="ttname"><a href="../../dd/d88/structPktHandler_1_1PktStats.html#a04f2c7f99b21f1517690548ce2f1aff8">PktHandler::PktStats::PktRcvd</a></div><div class="ttdeci">void PktRcvd(PktModuleName mod)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01321">pkt_handler.cc:1321</a></div></div>
<div class="ttc" id="classPktModule_html"><div class="ttname"><a href="../../d3/d55/classPktModule.html">PktModule</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db3/pkt__init_8h_source.html#l00018">pkt_init.h:18</a></div></div>
<div class="ttc" id="structGreHdr_html_aaa95e24e748615bbac1c5776efde4cf0"><div class="ttname"><a href="../../d2/d1b/structGreHdr.html#aaa95e24e748615bbac1c5776efde4cf0">GreHdr::protocol</a></div><div class="ttdeci">uint16_t protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00076">pkt_handler.h:76</a></div></div>
<div class="ttc" id="structAgentDiagPktData_html_afeffc307bef6282f6e12131edecb439f"><div class="ttname"><a href="../../dd/da9/structAgentDiagPktData.html#afeffc307bef6282f6e12131edecb439f">AgentDiagPktData::data_</a></div><div class="ttdeci">char data_[8]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dd2/diag_8h_source.html#l00085">diag.h:85</a></div></div>
<div class="ttc" id="pkt__handler_8h_html_ad7d59d1b04d238b6273b44205c0ae8b3"><div class="ttname"><a href="../../d3/d79/pkt__handler_8h.html#ad7d59d1b04d238b6273b44205c0ae8b3">BFD_SINGLEHOP_CONTROL_PORT</a></div><div class="ttdeci">#define BFD_SINGLEHOP_CONTROL_PORT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00033">pkt_handler.h:33</a></div></div>
<div class="ttc" id="classInterfaceNH_html_a9de278ced25b508c010f4d1cdf136745"><div class="ttname"><a href="../../de/d30/classInterfaceNH.html#a9de278ced25b508c010f4d1cdf136745">InterfaceNH::layer2_control_word</a></div><div class="ttdeci">bool layer2_control_word() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01359">nexthop.h:1359</a></div></div>
<div class="ttc" id="structPktInfo_html_a8ed59fa62263d57ae9c6db08458885f2"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a8ed59fa62263d57ae9c6db08458885f2">PktInfo::eth</a></div><div class="ttdeci">struct ether_header * eth</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00420">pkt_handler.h:420</a></div></div>
<div class="ttc" id="classPktHandler_html_a770ff0595b2a1eb752f5f54aad85ed26a4c57cf83e556f72b36832ef761f4d948"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a4c57cf83e556f72b36832ef761f4d948">PktHandler::DIAG</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00240">pkt_handler.h:240</a></div></div>
<div class="ttc" id="structPktType_html_a6d97cb2f45ba72589c8defcf6b9ccadba35ce819a4b8389aab264fa447c3c04cd"><div class="ttname"><a href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba35ce819a4b8389aab264fa447c3c04cd">PktType::INVALID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00097">pkt_handler.h:97</a></div></div>
<div class="ttc" id="classPktModule_html_a874f11abcbbe5f4f6d378838652d0903"><div class="ttname"><a href="../../d3/d55/classPktModule.html#a874f11abcbbe5f4f6d378838652d0903">PktModule::control_interface</a></div><div class="ttdeci">ControlInterface * control_interface() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db3/pkt__init_8h_source.html#l00046">pkt_init.h:46</a></div></div>
<div class="ttc" id="classTunnelType_html_a3848db71a84631798eaa36c12369b977a60fb19b5b806258cb4235c3042a7c8b5"><div class="ttname"><a href="../../d3/d08/classTunnelType.html#a3848db71a84631798eaa36c12369b977a60fb19b5b806258cb4235c3042a7c8b5">TunnelType::MPLS_UDP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l00242">nexthop.h:242</a></div></div>
<div class="ttc" id="tunnel__nh_8h_html"><div class="ttname"><a href="../../df/dd8/tunnel__nh_8h.html">tunnel_nh.h</a></div></div>
<div class="ttc" id="classInterfaceNH_html_aebbd2eec40ab0aca4b97125dbfb2d94d"><div class="ttname"><a href="../../de/d30/classInterfaceNH.html#aebbd2eec40ab0aca4b97125dbfb2d94d">InterfaceNH::IsBridge</a></div><div class="ttdeci">bool IsBridge() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01299">nexthop.h:1299</a></div></div>
<div class="ttc" id="classInterface_html_abb83064a529ab788f6ca5cd8592def91"><div class="ttname"><a href="../../d0/dcc/classInterface.html#abb83064a529ab788f6ca5cd8592def91">Interface::mac</a></div><div class="ttdeci">const MacAddress &amp; mac() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/interface_8h_source.html#l00131">interface.h:131</a></div></div>
<div class="ttc" id="pkt__handler_8h_html"><div class="ttname"><a href="../../d3/d79/pkt__handler_8h.html">pkt_handler.h</a></div></div>
<div class="ttc" id="structPktType_html_a6d97cb2f45ba72589c8defcf6b9ccadba28c9d988e5eca834aad2016b5e7ec126"><div class="ttname"><a href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba28c9d988e5eca834aad2016b5e7ec126">PktType::UDP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00100">pkt_handler.h:100</a></div></div>
<div class="ttc" id="classPktTrace_html_a03cc3da35006564e422b533fb72ad637"><div class="ttname"><a href="../../db/d26/classPktTrace.html#a03cc3da35006564e422b533fb72ad637">PktTrace::count_</a></div><div class="ttdeci">uint32_t count_</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d22/pkt__trace_8h_source.html#l00078">pkt_trace.h:78</a></div></div>
<div class="ttc" id="nexthop_8h_html"><div class="ttname"><a href="../../de/d3f/nexthop_8h.html">nexthop.h</a></div></div>
<div class="ttc" id="address__util_8h_html"><div class="ttname"><a href="../../d1/d95/address__util_8h.html">address_util.h</a></div></div>
<div class="ttc" id="classPktHandler_html_ab7ee36f7e26e1db0d30ba8d73f87e599"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#ab7ee36f7e26e1db0d30ba8d73f87e599">PktHandler::Register</a></div><div class="ttdeci">void Register(PktModuleName type, RcvQueueFunc cb)</div></div>
<div class="ttc" id="structPktInfo_html_ade16e16553f1900a8706351c3d93a146"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#ade16e16553f1900a8706351c3d93a146">PktInfo::icmp6</a></div><div class="ttdeci">struct icmp6_hdr * icmp6</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00429">pkt_handler.h:429</a></div></div>
<div class="ttc" id="classPktHandler_html_ad2d7f1001fb4bf535f88d990e83d7c18"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#ad2d7f1001fb4bf535f88d990e83d7c18">PktHandler::ProcessBfdDataPacket</a></div><div class="ttdeci">bool ProcessBfdDataPacket(boost::shared_ptr&lt; PacketBufferEnqueueItem &gt; item)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00442">pkt_handler.cc:442</a></div></div>
<div class="ttc" id="classAgent_html_a809ef2c3eb911e300fb623d99ea11836"><div class="ttname"><a href="../../d8/dfe/classAgent.html#a809ef2c3eb911e300fb623d99ea11836">Agent::mpls_table</a></div><div class="ttdeci">MplsTable * mpls_table() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9e/agent_8h_source.html#l00510">agent.h:510</a></div></div>
<div class="ttc" id="classPktHandler_html"><div class="ttname"><a href="../../d5/d94/classPktHandler.html">PktHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00224">pkt_handler.h:224</a></div></div>
<div class="ttc" id="classBridgeAgentRouteTable_html_acd29ee6fcce85330dcd810fa2aba06ee"><div class="ttname"><a href="../../d8/d2e/classBridgeAgentRouteTable.html#acd29ee6fcce85330dcd810fa2aba06ee">BridgeAgentRouteTable::FindVmFromDhcpBinding</a></div><div class="ttdeci">const VmInterface * FindVmFromDhcpBinding(const MacAddress &amp;mac)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0e/bridge__route_8cc_source.html#l00293">bridge_route.cc:293</a></div></div>
<div class="ttc" id="classCompositeNH_html"><div class="ttname"><a href="../../dd/d76/classCompositeNH.html">CompositeNH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01775">nexthop.h:1775</a></div></div>
<div class="ttc" id="classInterface_html_a91e7fca6cb9e1462112f1b7103dd9bd9"><div class="ttname"><a href="../../d0/dcc/classInterface.html#a91e7fca6cb9e1462112f1b7103dd9bd9">Interface::IsTunnelEnabled</a></div><div class="ttdeci">bool IsTunnelEnabled() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/interface_8h_source.html#l00109">interface.h:109</a></div></div>
<div class="ttc" id="structPktInfo_html_ab201b710fbcd037a6865a5665e7c5540"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#ab201b710fbcd037a6865a5665e7c5540">PktInfo::l3_label</a></div><div class="ttdeci">bool l3_label</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00408">pkt_handler.h:408</a></div></div>
<div class="ttc" id="classNextHop_html_a0c7a00522d6d540fecb6a2105ae81cfe"><div class="ttname"><a href="../../d4/dec/classNextHop.html#a0c7a00522d6d540fecb6a2105ae81cfe">NextHop::GetType</a></div><div class="ttdeci">Type GetType() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l00405">nexthop.h:405</a></div></div>
<div class="ttc" id="classEcmpLoadBalance_html"><div class="ttname"><a href="../../d1/db0/classEcmpLoadBalance.html">EcmpLoadBalance</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d7d/ecmp__load__balance_8h_source.html#l00023">ecmp_load_balance.h:23</a></div></div>
<div class="ttc" id="structAgentHdr_html_aee9a9c979ed73097cea9e1762eb8c8a3ad25b645581878127a5d53670bc63f794"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3ad25b645581878127a5d53670bc63f794">AgentHdr::TRAP_MAC_IP_LEARNING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00150">pkt_handler.h:150</a></div></div>
<div class="ttc" id="classAgentStats_html_a149b6d9b1572347fc09c407ca18d9760"><div class="ttname"><a href="../../d0/d98/classAgentStats.html#a149b6d9b1572347fc09c407ca18d9760">AgentStats::pkt_drop_due_to_flow_trap</a></div><div class="ttdeci">uint64_t pkt_drop_due_to_flow_trap() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d16/agent__stats_8h_source.html#l00162">agent_stats.h:162</a></div></div>
<div class="ttc" id="classPktHandler_html_aa0229bb40fa7ad85f4289257ab1550a0"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#aa0229bb40fa7ad85f4289257ab1550a0">PktHandler::AddPktTrace</a></div><div class="ttdeci">void AddPktTrace(PktModuleName module, PktTrace::Direction dir, const PktInfo *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01506">pkt_handler.cc:1506</a></div></div>
<div class="ttc" id="classTunnelType_html_a3848db71a84631798eaa36c12369b977af2160a17fa0eb3713c8e06373a5040e0"><div class="ttname"><a href="../../d3/d08/classTunnelType.html#a3848db71a84631798eaa36c12369b977af2160a17fa0eb3713c8e06373a5040e0">TunnelType::MPLS_GRE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l00241">nexthop.h:241</a></div></div>
<div class="ttc" id="structPktInfo_html_ad0cb770575ee100a2495a29734262c83"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#ad0cb770575ee100a2495a29734262c83">PktInfo::packet_buffer_</a></div><div class="ttdeci">PacketBufferPtr packet_buffer_</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00456">pkt_handler.h:456</a></div></div>
<div class="ttc" id="classPktHandler_html_ae46544244f80b3d8b64b069f3b42f407"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#ae46544244f80b3d8b64b069f3b42f407">PktHandler::work_queue_</a></div><div class="ttdeci">PktHandlerQueue work_queue_</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00371">pkt_handler.h:371</a></div></div>
<div class="ttc" id="structGreHdr_html"><div class="ttname"><a href="../../d2/d1b/structGreHdr.html">GreHdr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00071">pkt_handler.h:71</a></div></div>
<div class="ttc" id="classMacAddress_html"><div class="ttname"><a href="../../d3/df5/classMacAddress.html">MacAddress</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d05/mac__address_8h_source.html#l00014">mac_address.h:14</a></div></div>
<div class="ttc" id="classAgentStats_html_a37ce3527fae3a6da0ca1fec196d1bd8a"><div class="ttname"><a href="../../d0/d98/classAgentStats.html#a37ce3527fae3a6da0ca1fec196d1bd8a">AgentStats::incr_pkt_dropped</a></div><div class="ttdeci">void incr_pkt_dropped()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d16/agent__stats_8h_source.html#l00164">agent_stats.h:164</a></div></div>
<div class="ttc" id="classPktHandler_html_af4e822ae7caefed97883db7d64754056"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#af4e822ae7caefed97883db7d64754056">PktHandler::agent</a></div><div class="ttdeci">Agent * agent() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00317">pkt_handler.h:317</a></div></div>
<div class="ttc" id="structPktInfo_html_a643b257105489e165e6a35751abc93c1"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a643b257105489e165e6a35751abc93c1">PktInfo::sport</a></div><div class="ttdeci">uint32_t sport</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00397">pkt_handler.h:397</a></div></div>
<div class="ttc" id="structComposite_html_a4747d68b2bad61ba02a5223f77690d5eaab9ca131307d78aead877bcc68a46288"><div class="ttname"><a href="../../de/d98/structComposite.html#a4747d68b2bad61ba02a5223f77690d5eaab9ca131307d78aead877bcc68a46288">Composite::EVPN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01594">nexthop.h:1594</a></div></div>
<div class="ttc" id="classPktTrace_html_a5d21d994689ac9afd3280342b0bbaa93"><div class="ttname"><a href="../../db/d26/classPktTrace.html#a5d21d994689ac9afd3280342b0bbaa93">PktTrace::AddPktTrace</a></div><div class="ttdeci">void AddPktTrace(Direction dir, std::size_t len, uint8_t *msg, const AgentHdr *hdr)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01530">pkt_handler.cc:1530</a></div></div>
<div class="ttc" id="classPktTrace_html_a322ad3358bff708d99e6bcf75dd5814f"><div class="ttname"><a href="../../db/d26/classPktTrace.html#a322ad3358bff708d99e6bcf75dd5814f">PktTrace::pkt_buffer_</a></div><div class="ttdeci">std::vector&lt; Pkt &gt; pkt_buffer_</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d22/pkt__trace_8h_source.html#l00081">pkt_trace.h:81</a></div></div>
<div class="ttc" id="classAgentParam_html_adc0f8e645ea4ec3c22a3bb489c88da62"><div class="ttname"><a href="../../dc/dd4/classAgentParam.html#adc0f8e645ea4ec3c22a3bb489c88da62">AgentParam::flow_use_rid_in_hash</a></div><div class="ttdeci">bool flow_use_rid_in_hash() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d84/agent__param_8h_source.html#l00434">agent_param.h:434</a></div></div>
<div class="ttc" id="classPktHandler_html_a088c671feb2ecacc7b0f56ee1e513106"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a088c671feb2ecacc7b0f56ee1e513106">PktHandler::stats_</a></div><div class="ttdeci">PktStats stats_</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00365">pkt_handler.h:365</a></div></div>
<div class="ttc" id="structPktInfo_html_a70295e9e145716591036cb911f9f9679"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a70295e9e145716591036cb911f9f9679">PktInfo::tunnel</a></div><div class="ttdeci">TunnelInfo tunnel</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00407">pkt_handler.h:407</a></div></div>
<div class="ttc" id="classPktHandler_html_ae8b0cad66045a0269b50a00f720134ff"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#ae8b0cad66045a0269b50a00f720134ff">PktHandler::IsDHCPPacket</a></div><div class="ttdeci">bool IsDHCPPacket(PktInfo *pkt_info)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01085">pkt_handler.cc:1085</a></div></div>
<div class="ttc" id="classPktTrace_html_a505b67de244e4d3315cf67b7689c3ef2"><div class="ttname"><a href="../../db/d26/classPktTrace.html#a505b67de244e4d3315cf67b7689c3ef2">PktTrace::pkt_trace_size_</a></div><div class="ttdeci">std::size_t pkt_trace_size_</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d22/pkt__trace_8h_source.html#l00080">pkt_trace.h:80</a></div></div>
<div class="ttc" id="classProto_html_a3b0e1a3ecd60473dfd0a69bb7c71f314"><div class="ttname"><a href="../../db/de3/classProto.html#a3b0e1a3ecd60473dfd0a69bb7c71f314">Proto::Enqueue</a></div><div class="ttdeci">virtual bool Enqueue(boost::shared_ptr&lt; PktInfo &gt; msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dfa/controller_2src_2vnsw_2agent_2pkt_2proto_8cc_source.html#l00038">controller/src/vnsw/agent/pkt/proto.cc:38</a></div></div>
<div class="ttc" id="classPktHandler_html_a018bd8003f7dd01e8aa79582f2cedc5a"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a018bd8003f7dd01e8aa79582f2cedc5a">PktHandler::ParseMplsHdr</a></div><div class="ttdeci">int ParseMplsHdr(PktInfo *pkt_info, uint8_t *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00777">pkt_handler.cc:777</a></div></div>
<div class="ttc" id="structsctphdr_html_ad705d320d36799c6de367c16b5e3a8c5"><div class="ttname"><a href="../../d3/d75/structsctphdr.html#ad705d320d36799c6de367c16b5e3a8c5">sctphdr::th_sport</a></div><div class="ttdeci">u_int16_t th_sport</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00122">pkt_handler.h:122</a></div></div>
<div class="ttc" id="classBridgeRouteEntry_html"><div class="ttname"><a href="../../da/dfb/classBridgeRouteEntry.html">BridgeRouteEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d3b/bridge__route_8h_source.html#l00099">bridge_route.h:99</a></div></div>
<div class="ttc" id="classPktHandler_html_a770ff0595b2a1eb752f5f54aad85ed26a702d2d11f6301be930500864558697e4"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a702d2d11f6301be930500864558697e4">PktHandler::INVALID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00232">pkt_handler.h:232</a></div></div>
<div class="ttc" id="pkt__handler_8h_html_afc1644397649e7bc238d7296ed75045d"><div class="ttname"><a href="../../d3/d79/pkt__handler_8h.html#afc1644397649e7bc238d7296ed75045d">VLAN_HDR_LEN</a></div><div class="ttdeci">#define VLAN_HDR_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00049">pkt_handler.h:49</a></div></div>
<div class="ttc" id="structMplsHdr_html_a1dee66bd3a142791f80f8367f7adcdf2"><div class="ttname"><a href="../../d2/db6/structMplsHdr.html#a1dee66bd3a142791f80f8367f7adcdf2">MplsHdr::hdr</a></div><div class="ttdeci">uint32_t hdr</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00083">pkt_handler.h:83</a></div></div>
<div class="ttc" id="classPktHandler_html_a395987d474d0007c24201dfc2d4f89b4"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a395987d474d0007c24201dfc2d4f89b4">PktHandler::SetOuterMac</a></div><div class="ttdeci">void SetOuterMac(PktInfo *pkt_info)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00523">pkt_handler.cc:523</a></div></div>
<div class="ttc" id="classPktHandler_html_aaa875f61462d5bb23f92cd0a053aac0d"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#aaa875f61462d5bb23f92cd0a053aac0d">PktHandler::agent_</a></div><div class="ttdeci">Agent * agent_</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00369">pkt_handler.h:369</a></div></div>
<div class="ttc" id="classBridgeAgentRouteTable_html_a6271f83db49f47976f1bd2482e3ae30c"><div class="ttname"><a href="../../d8/d2e/classBridgeAgentRouteTable.html#a6271f83db49f47976f1bd2482e3ae30c">BridgeAgentRouteTable::FindRoute</a></div><div class="ttdeci">BridgeRouteEntry * FindRoute(const MacAddress &amp;mac)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0e/bridge__route_8cc_source.html#l00072">bridge_route.cc:72</a></div></div>
<div class="ttc" id="structPktInfo_html_a80e7dc1be11679d34710c7ac7cfbeb4f"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a80e7dc1be11679d34710c7ac7cfbeb4f">PktInfo::~PktInfo</a></div><div class="ttdeci">virtual ~PktInfo()</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01399">pkt_handler.cc:1399</a></div></div>
<div class="ttc" id="classVrfTable_html_ab68c6f010ca30d15c33eace6ec7f28b6"><div class="ttname"><a href="../../db/d35/classVrfTable.html#ab68c6f010ca30d15c33eace6ec7f28b6">VrfTable::FindVrfFromId</a></div><div class="ttdeci">VrfEntry * FindVrfFromId(size_t index)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d02/vrf_8cc_source.html#l00884">vrf.cc:884</a></div></div>
<div class="ttc" id="pkt__handler_8h_html_a6771677c2de7aeda8be146d9068290e3"><div class="ttname"><a href="../../d3/d79/pkt__handler_8h.html#a6771677c2de7aeda8be146d9068290e3">VXLAN_UDP_DEST_PORT</a></div><div class="ttdeci">#define VXLAN_UDP_DEST_PORT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00036">pkt_handler.h:36</a></div></div>
<div class="ttc" id="structPktInfo_html_acb2ec48d88f3dff8501e1c11c41898bf"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#acb2ec48d88f3dff8501e1c11c41898bf">PktInfo::ether_type</a></div><div class="ttdeci">uint16_t ether_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00389">pkt_handler.h:389</a></div></div>
<div class="ttc" id="load__balance_8h_html_a1d127017fb298b889f4ba24752d08b8e"><div class="ttname"><a href="../../de/dcb/load__balance_8h.html#a1d127017fb298b889f4ba24752d08b8e">type</a></div><div class="ttdeci">uint8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/load__balance_8h_source.html#l00109">load_balance.h:109</a></div></div>
<div class="ttc" id="classInterface_html_aeff297caef8ced9c6b53c6633be506f2"><div class="ttname"><a href="../../d0/dcc/classInterface.html#aeff297caef8ced9c6b53c6633be506f2">Interface::dhcp_enabled_v6</a></div><div class="ttdeci">bool dhcp_enabled_v6() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/interface_8h_source.html#l00125">interface.h:125</a></div></div>
<div class="ttc" id="classAddress_html"><div class="ttname"><a href="../../de/d6b/classAddress.html">Address</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9b/address_8h_source.html#l00017">address.h:17</a></div></div>
<div class="ttc" id="classPktHandler_html_a09e59c211ee541ee6db0fedd7f3df049"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a09e59c211ee541ee6db0fedd7f3df049">PktHandler::IsManagedTORPacket</a></div><div class="ttdeci">bool IsManagedTORPacket(Interface *intf, PktInfo *pkt_info, PktType::Type &amp;pkt_type, uint8_t *pkt, bool *pkt_ok)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01165">pkt_handler.cc:1165</a></div></div>
<div class="ttc" id="classAgent_html"><div class="ttname"><a href="../../d8/dfe/classAgent.html">Agent</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9e/agent_8h_source.html#l00358">agent.h:358</a></div></div>
<div class="ttc" id="classPktHandler_html_aac1de8e0f22b726a87a3991f0aee1bf1"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#aac1de8e0f22b726a87a3991f0aee1bf1">PktHandler::PktHandler</a></div><div class="ttdeci">PktHandler(Agent *, PktModule *pkt_module)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00057">pkt_handler.cc:57</a></div></div>
<div class="ttc" id="structPktType_html_a6d97cb2f45ba72589c8defcf6b9ccadba942e0faa3993a8390540f56f22ed0dfd"><div class="ttname"><a href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba942e0faa3993a8390540f56f22ed0dfd">PktType::ICMPV6</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00103">pkt_handler.h:103</a></div></div>
<div class="ttc" id="structComposite_html_a4747d68b2bad61ba02a5223f77690d5ea7e44d414dff32ac1db835f49bfaa0a89"><div class="ttname"><a href="../../de/d98/structComposite.html#a4747d68b2bad61ba02a5223f77690d5ea7e44d414dff32ac1db835f49bfaa0a89">Composite::TOR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01595">nexthop.h:1595</a></div></div>
<div class="ttc" id="classInterface_html_ab7c0e976860b4e8d1f14ff6dce82d9ae"><div class="ttname"><a href="../../d0/dcc/classInterface.html#ab7c0e976860b4e8d1f14ff6dce82d9ae">Interface::vrf_id</a></div><div class="ttdeci">uint32_t vrf_id() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d7a/interface_8cc_source.html#l00621">interface.cc:621</a></div></div>
<div class="ttc" id="classAgentStats_html_aa1d390629199ec9dcb7ff4424843c8c7"><div class="ttname"><a href="../../d0/d98/classAgentStats.html#aa1d390629199ec9dcb7ff4424843c8c7">AgentStats::incr_pkt_drop_due_to_decode_error</a></div><div class="ttdeci">void incr_pkt_drop_due_to_decode_error()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d16/agent__stats_8h_source.html#l00155">agent_stats.h:155</a></div></div>
<div class="ttc" id="structAgentHdr_html_aee9a9c979ed73097cea9e1762eb8c8a3a7dc10d3e347355ce79b89c56bb6c8b18"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3a7dc10d3e347355ce79b89c56bb6c8b18">AgentHdr::TRAP_ICMP_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00145">pkt_handler.h:145</a></div></div>
<div class="ttc" id="structPktInfo_html_a6fa8d862151b7712ede71fe4c5dc3c85"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a6fa8d862151b7712ede71fe4c5dc3c85">PktInfo::len</a></div><div class="ttdeci">uint16_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00380">pkt_handler.h:380</a></div></div>
<div class="ttc" id="structPktInfo_html_a5d9d0bce6380c0b13e2ee9a46b555504"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a5d9d0bce6380c0b13e2ee9a46b555504">PktInfo::udp</a></div><div class="ttdeci">struct udphdr * udp</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00427">pkt_handler.h:427</a></div></div>
<div class="ttc" id="classPktHandler_html_a6cc161858b09da22735f55b9ef03e28d"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a6cc161858b09da22735f55b9ef03e28d">PktHandler::~PktHandler</a></div><div class="ttdeci">virtual ~PktHandler()</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00078">pkt_handler.cc:78</a></div></div>
<div class="ttc" id="structsctphdr_html"><div class="ttname"><a href="../../d3/d75/structsctphdr.html">sctphdr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00121">pkt_handler.h:121</a></div></div>
<div class="ttc" id="structAgentHdr_html_aee9a9c979ed73097cea9e1762eb8c8a3a290412c5ecc7974634855681ff774fe7"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3a290412c5ecc7974634855681ff774fe7">AgentHdr::TRAP_MAC_MOVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00149">pkt_handler.h:149</a></div></div>
<div class="ttc" id="structPktInfo_html_a859f1aadf64fad9342375bd71dce2a0a"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a859f1aadf64fad9342375bd71dce2a0a">PktInfo::ttl</a></div><div class="ttdeci">uint32_t ttl</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00399">pkt_handler.h:399</a></div></div>
<div class="ttc" id="classPktHandler_html_a770ff0595b2a1eb752f5f54aad85ed26a8148fafd9dad7090f48ba61e25a24e2e"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a8148fafd9dad7090f48ba61e25a24e2e">PktHandler::ICMPV6</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00239">pkt_handler.h:239</a></div></div>
<div class="ttc" id="classAgentRoute_html_adcd6fd8eed3302495616afe5c8ab10ca"><div class="ttname"><a href="../../d4/d57/classAgentRoute.html#adcd6fd8eed3302495616afe5c8ab10ca">AgentRoute::GetActiveNextHop</a></div><div class="ttdeci">const NextHop * GetActiveNextHop() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/daa/agent__route_8cc_source.html#l00881">agent_route.cc:881</a></div></div>
<div class="ttc" id="structPktInfo_html_a9ce84d4ac75e447a71244cb9101fb976"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a9ce84d4ac75e447a71244cb9101fb976">PktInfo::ip_ff_dst_prefix</a></div><div class="ttdeci">IpAddress ip_ff_dst_prefix</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00417">pkt_handler.h:417</a></div></div>
<div class="ttc" id="address_8h_html_a231be25f722543d7460102bbe5c59f5d"><div class="ttname"><a href="../../d9/d9b/address_8h.html#a231be25f722543d7460102bbe5c59f5d">Ip6Address</a></div><div class="ttdeci">boost::asio::ip::address_v6 Ip6Address</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9b/address_8h_source.html#l00015">address.h:15</a></div></div>
<div class="ttc" id="classAgent_html_ac03bc14ab24abd2d4e377709b726c3b2"><div class="ttname"><a href="../../d8/dfe/classAgent.html#ac03bc14ab24abd2d4e377709b726c3b2">Agent::router_id</a></div><div class="ttdeci">Ip4Address router_id() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9e/agent_8h_source.html#l00666">agent.h:666</a></div></div>
<div class="ttc" id="structPktInfo_html_a0edd9430bd89502db5df54dc160bb5e1"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a0edd9430bd89502db5df54dc160bb5e1">PktInfo::pkt</a></div><div class="ttdeci">uint8_t * pkt</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00379">pkt_handler.h:379</a></div></div>
<div class="ttc" id="classPktHandler_html_a8d2ca1d7adad973774c0e8803b9740bd"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a8d2ca1d7adad973774c0e8803b9740bd">PktHandler::IsBFDHealthCheckPacket</a></div><div class="ttdeci">bool IsBFDHealthCheckPacket(const PktInfo *pkt_info, const Interface *interface)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00219">pkt_handler.cc:219</a></div></div>
<div class="ttc" id="classPktHandler_html_accba384dfaf9321cfb4f7371ee65c963"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#accba384dfaf9321cfb4f7371ee65c963">PktHandler::kMulticastControlWordSize</a></div><div class="ttdeci">static const uint32_t kMulticastControlWordSize</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00230">pkt_handler.h:230</a></div></div>
<div class="ttc" id="structPktInfo_html_ab5fa2d5a5b81ba51585c53c5ccbe3fbd"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#ab5fa2d5a5b81ba51585c53c5ccbe3fbd">PktInfo::tcp_ack</a></div><div class="ttdeci">bool tcp_ack</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00406">pkt_handler.h:406</a></div></div>
<div class="ttc" id="structPktStatsType_html_a525d0f71edc19ac0d482b274fdc13866a3c143d7726883d91959803345798372d"><div class="ttname"><a href="../../d5/d67/structPktStatsType.html#a525d0f71edc19ac0d482b274fdc13866a3c143d7726883d91959803345798372d">PktStatsType::PKT_RX_DROP_STATS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00115">pkt_handler.h:115</a></div></div>
<div class="ttc" id="classPktHandler_html_a95f3b7f291189dd9e70cc93401242658"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a95f3b7f291189dd9e70cc93401242658">PktHandler::ParseMPLSoGRE</a></div><div class="ttdeci">int ParseMPLSoGRE(PktInfo *pkt_info, uint8_t *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00838">pkt_handler.cc:838</a></div></div>
<div class="ttc" id="structTunnelInfo_html_a152c8ed365b2ce0d0f7a061b34b43281"><div class="ttname"><a href="../../d6/d6b/structTunnelInfo.html#a152c8ed365b2ce0d0f7a061b34b43281">TunnelInfo::type</a></div><div class="ttdeci">TunnelType type</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00211">pkt_handler.h:211</a></div></div>
<div class="ttc" id="classPktHandler_html_a770ff0595b2a1eb752f5f54aad85ed26a4b5663f56c7bf149f0c101a235f565c0"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a4b5663f56c7bf149f0c101a235f565c0">PktHandler::MAX_MODULES</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00248">pkt_handler.h:248</a></div></div>
<div class="ttc" id="classMplsLabelKey_html"><div class="ttname"><a href="../../d9/dcb/classMplsLabelKey.html">MplsLabelKey</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d9a/mpls_8h_source.html#l00020">mpls.h:20</a></div></div>
<div class="ttc" id="route__common_8h_html"><div class="ttname"><a href="../../d1/dde/route__common_8h.html">route_common.h</a></div></div>
<div class="ttc" id="structPktInfo_html_a76498bb0d3175427871fc647b94ba17a"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a76498bb0d3175427871fc647b94ba17a">PktInfo::arp</a></div><div class="ttdeci">struct ether_arp * arp</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00422">pkt_handler.h:422</a></div></div>
<div class="ttc" id="classPktTrace_html_a0b7227b964b142e143287cb123a8c357"><div class="ttname"><a href="../../db/d26/classPktTrace.html#a0b7227b964b142e143287cb123a8c357">PktTrace::kPktMaxTraceSize</a></div><div class="ttdeci">static const std::size_t kPktMaxTraceSize</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d22/pkt__trace_8h_source.html#l00014">pkt_trace.h:14</a></div></div>
<div class="ttc" id="classPktTrace_html_ae3e0eef18f4b97745c47db13c3de561f"><div class="ttname"><a href="../../db/d26/classPktTrace.html#ae3e0eef18f4b97745c47db13c3de561f">PktTrace::Iterate</a></div><div class="ttdeci">void Iterate(Cb cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d22/pkt__trace_8h_source.html#l00049">pkt_trace.h:49</a></div></div>
<div class="ttc" id="structPktType_html_a6d97cb2f45ba72589c8defcf6b9ccadba1700208778f79af64c7597d7698fd3f5"><div class="ttname"><a href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba1700208778f79af64c7597d7698fd3f5">PktType::ICMP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00102">pkt_handler.h:102</a></div></div>
<div class="ttc" id="os_8h_html"><div class="ttname"><a href="../../d0/dff/os_8h.html">os.h</a></div></div>
<div class="ttc" id="classInterface_html_ae1235bd5224278a806a0754101e447d5"><div class="ttname"><a href="../../d0/dcc/classInterface.html#ae1235bd5224278a806a0754101e447d5">Interface::dhcp_enabled</a></div><div class="ttdeci">bool dhcp_enabled() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/interface_8h_source.html#l00124">interface.h:124</a></div></div>
<div class="ttc" id="classProto_html"><div class="ttname"><a href="../../db/de3/classProto.html">Proto</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2c/controller_2src_2vnsw_2agent_2pkt_2proto_8h_source.html#l00015">controller/src/vnsw/agent/pkt/proto.h:15</a></div></div>
<div class="ttc" id="classPktHandler_html_a4563e5d1e5fca94bfa6e374ec9e351fe"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a4563e5d1e5fca94bfa6e374ec9e351fe">PktHandler::IsGwPacket</a></div><div class="ttdeci">bool IsGwPacket(const Interface *intf, const IpAddress &amp;dst_ip)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01262">pkt_handler.cc:1262</a></div></div>
<div class="ttc" id="classAgentStats_html_af1a14ad50a8dd3751d094f0c8f0b1187"><div class="ttname"><a href="../../d0/d98/classAgentStats.html#af1a14ad50a8dd3751d094f0c8f0b1187">AgentStats::incr_pkt_drop_due_to_disable_tnl</a></div><div class="ttdeci">void incr_pkt_drop_due_to_disable_tnl()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d16/agent__stats_8h_source.html#l00149">agent_stats.h:149</a></div></div>
<div class="ttc" id="structAgentHdr_html_ac279c0e6b1be3e9073f05188110aab4b"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#ac279c0e6b1be3e9073f05188110aab4b">AgentHdr::vrf</a></div><div class="ttdeci">uint32_t vrf</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00181">pkt_handler.h:181</a></div></div>
<div class="ttc" id="classPktFlowInfo_html_aeb9254d3b8a854c9a37216fee0d99ecb"><div class="ttname"><a href="../../d5/d5e/classPktFlowInfo.html#aeb9254d3b8a854c9a37216fee0d99ecb">PktFlowInfo::ComputeDirection</a></div><div class="ttdeci">static bool ComputeDirection(const Interface *intf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db2/pkt__flow__info_8cc_source.html#l00122">pkt_flow_info.cc:122</a></div></div>
<div class="ttc" id="pkt__handler_8h_html_af0130673e6e4e22530d7cfd5d7886f40"><div class="ttname"><a href="../../d3/d79/pkt__handler_8h.html#af0130673e6e4e22530d7cfd5d7886f40">ETHERTYPE_QINQ</a></div><div class="ttdeci">#define ETHERTYPE_QINQ</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00053">pkt_handler.h:53</a></div></div>
<div class="ttc" id="structInterTaskMsg_html"><div class="ttname"><a href="../../de/d93/structInterTaskMsg.html">InterTaskMsg</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00064">pkt_handler.h:64</a></div></div>
<div class="ttc" id="classVrfEntry_html_ac32cfcd6a11cd0050853c45a682f1464"><div class="ttname"><a href="../../d2/d3d/classVrfEntry.html#ac32cfcd6a11cd0050853c45a682f1464">VrfEntry::GetBridgeRouteTable</a></div><div class="ttdeci">AgentRouteTable * GetBridgeRouteTable() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d02/vrf_8cc_source.html#l00334">vrf.cc:334</a></div></div>
<div class="ttc" id="classVrfNH_html_aa7f7d2758bd8ece8d447eb5bfd6ea8da"><div class="ttname"><a href="../../d8/da7/classVrfNH.html#aa7f7d2758bd8ece8d447eb5bfd6ea8da">VrfNH::bridge_nh</a></div><div class="ttdeci">bool bridge_nh() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01448">nexthop.h:1448</a></div></div>
<div class="ttc" id="classWorkQueue_html_af03022fb8a22a406467c293371b2a5cc"><div class="ttname"><a href="../../d4/d0c/classWorkQueue.html#af03022fb8a22a406467c293371b2a5cc">WorkQueue::set_measure_busy_time</a></div><div class="ttdeci">void set_measure_busy_time(bool val) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d47/queue__task_8h_source.html#l00379">queue_task.h:379</a></div></div>
<div class="ttc" id="classPktHandler_html_a85fdbc6698073189ea5c88a91148f0da"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a85fdbc6698073189ea5c88a91148f0da">PktHandler::IsValidInterface</a></div><div class="ttdeci">bool IsValidInterface(uint32_t ifindex, Interface **interface)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01302">pkt_handler.cc:1302</a></div></div>
<div class="ttc" id="classPktHandler_html_afdd24821da0db51a5c000dc86181c911"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#afdd24821da0db51a5c000dc86181c911">PktHandler::PktTraceIterate</a></div><div class="ttdeci">void PktTraceIterate(PktModuleName mod, PktTraceCallback cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01314">pkt_handler.cc:1314</a></div></div>
<div class="ttc" id="classTunnelNH_html"><div class="ttname"><a href="../../d0/daf/classTunnelNH.html">TunnelNH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd8/tunnel__nh_8h_source.html#l00014">tunnel_nh.h:14</a></div></div>
<div class="ttc" id="classPktTrace_html_ad8811bfb16862308e383be2969d1dabe"><div class="ttname"><a href="../../db/d26/classPktTrace.html#ad8811bfb16862308e383be2969d1dabe">PktTrace::num_buffers_</a></div><div class="ttdeci">std::size_t num_buffers_</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d22/pkt__trace_8h_source.html#l00079">pkt_trace.h:79</a></div></div>
<div class="ttc" id="classPktTrace_html_a8f01b6f2de3e08339e52afa91deb7fabaf28f823e77efd2ce7c08340332eebf02"><div class="ttname"><a href="../../db/d26/classPktTrace.html#a8f01b6f2de3e08339e52afa91deb7fabaf28f823e77efd2ce7c08340332eebf02">PktTrace::In</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d22/pkt__trace_8h_source.html#l00019">pkt_trace.h:19</a></div></div>
<div class="ttc" id="classNextHop_html_a6d58ef6d19818df01ad156b9b6f59fc4ac3e16d2a8d4b0350c93aea2d576542e2"><div class="ttname"><a href="../../d4/dec/classNextHop.html#a6d58ef6d19818df01ad156b9b6f59fc4ac3e16d2a8d4b0350c93aea2d576542e2">NextHop::INTERFACE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l00351">nexthop.h:351</a></div></div>
<div class="ttc" id="pkt__handler_8h_html_acd3e54d24cdaa5f9c3f6440bcfffbe35"><div class="ttname"><a href="../../d3/d79/pkt__handler_8h.html#acd3e54d24cdaa5f9c3f6440bcfffbe35">BFD_MULTIHOP_CONTROL_PORT</a></div><div class="ttdeci">#define BFD_MULTIHOP_CONTROL_PORT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00035">pkt_handler.h:35</a></div></div>
<div class="ttc" id="classPktHandler_html_a981101851eceaed34989aa4d1fdf46c4"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a981101851eceaed34989aa4d1fdf46c4">PktHandler::IsDiagPacket</a></div><div class="ttdeci">bool IsDiagPacket(PktInfo *pkt_info)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01253">pkt_handler.cc:1253</a></div></div>
<div class="ttc" id="classVnEntry_html_a1037b99b37ff98fdbb43f757b0ed528b"><div class="ttname"><a href="../../d8/d00/classVnEntry.html#a1037b99b37ff98fdbb43f757b0ed528b">VnEntry::GetVnIpam</a></div><div class="ttdeci">const std::vector&lt; VnIpam &gt; &amp; GetVnIpam() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d2b/vn_8h_source.html#l00171">vn.h:171</a></div></div>
<div class="ttc" id="classMacAddress_html_a6fb1333e2f0a73a54b04ab3d81876561"><div class="ttname"><a href="../../d3/df5/classMacAddress.html#a6fb1333e2f0a73a54b04ab3d81876561">MacAddress::BroadcastMac</a></div><div class="ttdeci">static const MacAddress &amp; BroadcastMac()</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d05/mac__address_8h_source.html#l00152">mac_address.h:152</a></div></div>
<div class="ttc" id="structPktType_html_a6d97cb2f45ba72589c8defcf6b9ccadba1daf0a0fe1b27e1facfa38c4607ddc1f"><div class="ttname"><a href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba1daf0a0fe1b27e1facfa38c4607ddc1f">PktType::ARP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00098">pkt_handler.h:98</a></div></div>
<div class="ttc" id="classVmInterface_html_ad3409722d31d08b926a0660636083917"><div class="ttname"><a href="../../d5/d21/classVmInterface.html#ad3409722d31d08b926a0660636083917">VmInterface::vn</a></div><div class="ttdeci">const VnEntry * vn() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d62/vm__interface_8h_source.html#l01262">vm_interface.h:1262</a></div></div>
<div class="ttc" id="classEcmpLoadBalance_html_a2611388b5517276d4d9af77b285345de"><div class="ttname"><a href="../../d1/db0/classEcmpLoadBalance.html#a2611388b5517276d4d9af77b285345de">EcmpLoadBalance::is_source_ip_set</a></div><div class="ttdeci">bool is_source_ip_set() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d7d/ecmp__load__balance_8h_source.html#l00140">ecmp_load_balance.h:140</a></div></div>
<div class="ttc" id="classPktHandler_html_a3cd8698f2530bbaa2dd347492dda8c18"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a3cd8698f2530bbaa2dd347492dda8c18">PktHandler::Send</a></div><div class="ttdeci">void Send(const AgentHdr &amp;hdr, const PacketBufferPtr &amp;buff)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00094">pkt_handler.cc:94</a></div></div>
<div class="ttc" id="classPktTrace_html"><div class="ttname"><a href="../../db/d26/classPktTrace.html">PktTrace</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d22/pkt__trace_8h_source.html#l00012">pkt_trace.h:12</a></div></div>
<div class="ttc" id="classInterface_html"><div class="ttname"><a href="../../d0/dcc/classInterface.html">Interface</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/interface_8h_source.html#l00023">interface.h:23</a></div></div>
<div class="ttc" id="classPktHandler_html_a770ff0595b2a1eb752f5f54aad85ed26a27ef3a8980fccb05a5eaa9c85f2b5381"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a27ef3a8980fccb05a5eaa9c85f2b5381">PktHandler::BFD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00245">pkt_handler.h:245</a></div></div>
<div class="ttc" id="classAgent_html_a1aa71c3ba17bdad2992bad37627155cf"><div class="ttname"><a href="../../d8/dfe/classAgent.html#a1aa71c3ba17bdad2992bad37627155cf">Agent::init_done</a></div><div class="ttdeci">bool init_done() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9e/agent_8h_source.html#l01213">agent.h:1213</a></div></div>
<div class="ttc" id="classPktHandler_html_ab75389b995b14046e27951ebe13cc613"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#ab75389b995b14046e27951ebe13cc613">PktHandler::ProcessPacket</a></div><div class="ttdeci">bool ProcessPacket(boost::shared_ptr&lt; PacketBufferEnqueueItem &gt; item)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00426">pkt_handler.cc:426</a></div></div>
<div class="ttc" id="classPktHandler_html_ab76ff6fdbb8faef0342d429ef6c83911"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#ab76ff6fdbb8faef0342d429ef6c83911">PktHandler::ParsePacket</a></div><div class="ttdeci">PktModuleName ParsePacket(const AgentHdr &amp;hdr, PktInfo *pkt_info, uint8_t *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00280">pkt_handler.cc:280</a></div></div>
<div class="ttc" id="classCompositeNH_html_acdc48d0091d35e17b87cc50370a82bbd"><div class="ttname"><a href="../../dd/d76/classCompositeNH.html#acdc48d0091d35e17b87cc50370a82bbd">CompositeNH::composite_nh_type</a></div><div class="ttdeci">COMPOSITETYPE composite_nh_type() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01842">nexthop.h:1842</a></div></div>
<div class="ttc" id="structAgentHdr_html_a755a4601a5bc30acea0c6676acd15701"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#a755a4601a5bc30acea0c6676acd15701">AgentHdr::nh</a></div><div class="ttdeci">uint32_t nh</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00189">pkt_handler.h:189</a></div></div>
<div class="ttc" id="classAgent_html_ae8ee3a20def9370096d09a536d2f9f9f"><div class="ttname"><a href="../../d8/dfe/classAgent.html#ae8ee3a20def9370096d09a536d2f9f9f">Agent::params</a></div><div class="ttdeci">AgentParam * params() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9e/agent_8h_source.html#l01218">agent.h:1218</a></div></div>
<div class="ttc" id="classPktHandler_html_a770ff0595b2a1eb752f5f54aad85ed26a6f33188a1cd8241668f980e455d0ad36"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a6f33188a1cd8241668f980e455d0ad36">PktHandler::IGMP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00246">pkt_handler.h:246</a></div></div>
<div class="ttc" id="flow__proto_8h_html"><div class="ttname"><a href="../../d4/d5c/flow__proto_8h.html">flow_proto.h</a></div></div>
<div class="ttc" id="agent__param_8h_html"><div class="ttname"><a href="../../df/d84/agent__param_8h.html">agent_param.h</a></div></div>
<div class="ttc" id="structPktInfo_html_a1ea3136967b011ba7b21434bf8e9fbeb"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a1ea3136967b011ba7b21434bf8e9fbeb">PktInfo::vrf</a></div><div class="ttdeci">uint32_t vrf</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00391">pkt_handler.h:391</a></div></div>
<div class="ttc" id="classNextHop_html_a6d58ef6d19818df01ad156b9b6f59fc4a210bb844f475218159b9b231168c42af"><div class="ttname"><a href="../../d4/dec/classNextHop.html#a6d58ef6d19818df01ad156b9b6f59fc4a210bb844f475218159b9b231168c42af">NextHop::VLAN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l00355">nexthop.h:355</a></div></div>
<div class="ttc" id="classPktHandler_html_a770ff0595b2a1eb752f5f54aad85ed26a7e0a812f8f37f686b0aa22450a7217e9"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a7e0a812f8f37f686b0aa22450a7217e9">PktHandler::ARP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00234">pkt_handler.h:234</a></div></div>
<div class="ttc" id="diag_8h_html"><div class="ttname"><a href="../../d2/dd2/diag_8h.html">diag.h</a></div></div>
<div class="ttc" id="classVmInterface_html_a9e25daa6ea3d8e4be2d960167b995813"><div class="ttname"><a href="../../d5/d21/classVmInterface.html#a9e25daa6ea3d8e4be2d960167b995813">VmInterface::ExcludeFromFatFlow</a></div><div class="ttdeci">bool ExcludeFromFatFlow(Address::Family family, const IpAddress &amp;sip, const IpAddress &amp;dip) const </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d10/vm__interface__utils_8cc_source.html#l01270">vm_interface_utils.cc:1270</a></div></div>
<div class="ttc" id="address_8h_html_ae475599c70b47996f862faa1f265eaa2"><div class="ttname"><a href="../../d9/d9b/address_8h.html#ae475599c70b47996f862faa1f265eaa2">Ip4Address</a></div><div class="ttdeci">boost::asio::ip::address_v4 Ip4Address</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9b/address_8h_source.html#l00014">address.h:14</a></div></div>
<div class="ttc" id="classPktHandler_html_a7993c9a5bca47688d30b3056e70b87d3"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a7993c9a5bca47688d30b3056e70b87d3">PktHandler::ValidateIpPacket</a></div><div class="ttdeci">bool ValidateIpPacket(PktInfo *pkt_info)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00903">pkt_handler.cc:903</a></div></div>
<div class="ttc" id="structPktType_html_a6d97cb2f45ba72589c8defcf6b9ccadbad56b7425cb4e0085c953056bdb25293b"><div class="ttname"><a href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadbad56b7425cb4e0085c953056bdb25293b">PktType::IGMP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00107">pkt_handler.h:107</a></div></div>
<div class="ttc" id="agent__stats_8h_html"><div class="ttname"><a href="../../d9/d16/agent__stats_8h.html">agent_stats.h</a></div></div>
<div class="ttc" id="classVnEntry_html"><div class="ttname"><a href="../../d8/d00/classVnEntry.html">VnEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d2b/vn_8h_source.html#l00151">vn.h:151</a></div></div>
<div class="ttc" id="classMplsTable_html_a79fe2cd4afb235bf6f40d5f7c9704ece"><div class="ttname"><a href="../../df/dd0/classMplsTable.html#a79fe2cd4afb235bf6f40d5f7c9704ece">MplsTable::kInvalidLabel</a></div><div class="ttdeci">static const uint32_t kInvalidLabel</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d9a/mpls_8h_source.html#l00101">mpls.h:101</a></div></div>
<div class="ttc" id="classAgentStats_html_a0535054967b9a580c163055b8efe9f31"><div class="ttname"><a href="../../d0/d98/classAgentStats.html#a0535054967b9a580c163055b8efe9f31">AgentStats::incr_pkt_fragments_dropped</a></div><div class="ttdeci">void incr_pkt_fragments_dropped()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d16/agent__stats_8h_source.html#l00140">agent_stats.h:140</a></div></div>
<div class="ttc" id="classNextHop_html_a6d58ef6d19818df01ad156b9b6f59fc4aa93fa4b6343548cfcbebe79125545566"><div class="ttname"><a href="../../d4/dec/classNextHop.html#a6d58ef6d19818df01ad156b9b6f59fc4aa93fa4b6343548cfcbebe79125545566">NextHop::COMPOSITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l00354">nexthop.h:354</a></div></div>
<div class="ttc" id="bind__util_8h_html_a9266b48706648ecf0625a3e651095317"><div class="ttname"><a href="../../da/dea/bind__util_8h.html#a9266b48706648ecf0625a3e651095317">DNS_SERVER_PORT</a></div><div class="ttdeci">#define DNS_SERVER_PORT</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dea/bind__util_8h_source.html#l00028">bind_util.h:28</a></div></div>
<div class="ttc" id="classVmInterface_html_a06f4707e09dd3fa51d4c2f92c85c8499"><div class="ttname"><a href="../../d5/d21/classVmInterface.html#a06f4707e09dd3fa51d4c2f92c85c8499">VmInterface::fat_flow_list</a></div><div class="ttdeci">const FatFlowList &amp; fat_flow_list() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d62/vm__interface_8h_source.html#l01428">vm_interface.h:1428</a></div></div>
<div class="ttc" id="classAgent_html_a661b6ae0b81be524aabb25dcefaabd47"><div class="ttname"><a href="../../d8/dfe/classAgent.html#a661b6ae0b81be524aabb25dcefaabd47">Agent::vrf_table</a></div><div class="ttdeci">VrfTable * vrf_table() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9e/agent_8h_source.html#l00485">agent.h:485</a></div></div>
<div class="ttc" id="agent_8cc_html_a6d4f9ef75ed60d04c1d67c58010f6e47"><div class="ttname"><a href="../../d2/d0e/agent_8cc.html#a6d4f9ef75ed60d04c1d67c58010f6e47">AgentBackTrace</a></div><div class="ttdeci">std::string AgentBackTrace(int skip=1)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0e/agent_8cc_source.html#l01186">agent.cc:1186</a></div></div>
<div class="ttc" id="classVmInterface_html"><div class="ttname"><a href="../../d5/d21/classVmInterface.html">VmInterface</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d62/vm__interface_8h_source.html#l00358">vm_interface.h:358</a></div></div>
<div class="ttc" id="control__interface_8h_html"><div class="ttname"><a href="../../d5/d6e/control__interface_8h.html">control_interface.h</a></div></div>
<div class="ttc" id="classCompositeNH_html_a038788b2f2c2ece59f85d142bc11b15c"><div class="ttname"><a href="../../dd/d76/classCompositeNH.html#a038788b2f2c2ece59f85d142bc11b15c">CompositeNH::begin</a></div><div class="ttdeci">ComponentNHList::const_iterator begin() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01807">nexthop.h:1807</a></div></div>
<div class="ttc" id="structAgentHdr_html_aee9a9c979ed73097cea9e1762eb8c8a3acd2cc501e3251055cb416831d661c7aa"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3acd2cc501e3251055cb416831d661c7aa">AgentHdr::TRAP_RESOLVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00136">pkt_handler.h:136</a></div></div>
<div class="ttc" id="classVmInterface_html_ada7ed7a5fb4d53d7260bdbe8f2630e14"><div class="ttname"><a href="../../d5/d21/classVmInterface.html#ada7ed7a5fb4d53d7260bdbe8f2630e14">VmInterface::primary_ip_addr</a></div><div class="ttdeci">const Ip4Address &amp; primary_ip_addr() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d62/vm__interface_8h_source.html#l01264">vm_interface.h:1264</a></div></div>
<div class="ttc" id="structPktInfo_html_ac7f5c3451f8a72cc8446c1de29acbae6"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#ac7f5c3451f8a72cc8446c1de29acbae6">PktInfo::pbb_header</a></div><div class="ttdeci">uint32_t * pbb_header</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00421">pkt_handler.h:421</a></div></div>
<div class="ttc" id="structPktInfo_html_a891cd3fba77b433b18b70658395eb7dc"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a891cd3fba77b433b18b70658395eb7dc">PktInfo::GetUdpPayloadLength</a></div><div class="ttdeci">uint32_t GetUdpPayloadLength() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01499">pkt_handler.cc:1499</a></div></div>
<div class="ttc" id="classInterfaceNH_html"><div class="ttname"><a href="../../de/d30/classInterfaceNH.html">InterfaceNH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01267">nexthop.h:1267</a></div></div>
<div class="ttc" id="pkt__handler_8h_html_a18139a80e36d86414f457b9959f2aba0"><div class="ttname"><a href="../../d3/d79/pkt__handler_8h.html#a18139a80e36d86414f457b9959f2aba0">ETHERTYPE_PBB</a></div><div class="ttdeci">#define ETHERTYPE_PBB</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00054">pkt_handler.h:54</a></div></div>
<div class="ttc" id="structPktInfo_html_ada1ebfb76eaf2f399cd4362c42db647e"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#ada1ebfb76eaf2f399cd4362c42db647e">PktInfo::GetAgentHdr</a></div><div class="ttdeci">const AgentHdr &amp; GetAgentHdr() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01402">pkt_handler.cc:1402</a></div></div>
<div class="ttc" id="classPktHandler_html_a770ff0595b2a1eb752f5f54aad85ed26a5b2afa6c9e384c5b3546911393a71c84"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a5b2afa6c9e384c5b3546911393a71c84">PktHandler::DHCP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00235">pkt_handler.h:235</a></div></div>
<div class="ttc" id="classControlInterface_html_ad28d2c3b76a3433e8de9559fc911fcd9"><div class="ttname"><a href="../../dc/d1d/classControlInterface.html#ad28d2c3b76a3433e8de9559fc911fcd9">ControlInterface::Send</a></div><div class="ttdeci">virtual int Send(const AgentHdr &amp;hdr, const PacketBufferPtr &amp;pkt)=0</div></div>
<div class="ttc" id="classPktHandler_html_a8ca9f552bafd9561df9b5a20e4d2a7b1"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a8ca9f552bafd9561df9b5a20e4d2a7b1">PktHandler::ParseMPLSoUDP</a></div><div class="ttdeci">int ParseMPLSoUDP(PktInfo *pkt_info, uint8_t *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00866">pkt_handler.cc:866</a></div></div>
<div class="ttc" id="classAgentStats_html_a20e3b06263028f637c4e155d259f0781"><div class="ttname"><a href="../../d0/d98/classAgentStats.html#a20e3b06263028f637c4e155d259f0781">AgentStats::incr_pkt_invalid_frm_tor</a></div><div class="ttdeci">void incr_pkt_invalid_frm_tor()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d16/agent__stats_8h_source.html#l00152">agent_stats.h:152</a></div></div>
<div class="ttc" id="classAgentStats_html_ac1459263729bee18dad5c46ea6a2b9bf"><div class="ttname"><a href="../../d0/d98/classAgentStats.html#ac1459263729bee18dad5c46ea6a2b9bf">AgentStats::incr_pkt_invalid_interface</a></div><div class="ttdeci">void incr_pkt_invalid_interface()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d16/agent__stats_8h_source.html#l00134">agent_stats.h:134</a></div></div>
<div class="ttc" id="structPktInfo_html_a35ad00a1209b527bbecc84c355e9eef0"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a35ad00a1209b527bbecc84c355e9eef0">PktInfo::reset_packet_buffer</a></div><div class="ttdeci">void reset_packet_buffer()</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01406">pkt_handler.cc:1406</a></div></div>
<div class="ttc" id="classNextHop_html"><div class="ttname"><a href="../../d4/dec/classNextHop.html">NextHop</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l00340">nexthop.h:340</a></div></div>
<div class="ttc" id="classPktHandler_html_a06bcc951c27d02fbcb4c8154954208d0"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a06bcc951c27d02fbcb4c8154954208d0">PktHandler::IgnoreFragmentedPacket</a></div><div class="ttdeci">bool IgnoreFragmentedPacket(PktInfo *pkt_info)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01064">pkt_handler.cc:1064</a></div></div>
<div class="ttc" id="structPktType_html"><div class="ttname"><a href="../../d8/d9c/structPktType.html">PktType</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00095">pkt_handler.h:95</a></div></div>
<div class="ttc" id="classPktModule_html_a135bd5f128027bdc1a13578b30af85cc"><div class="ttname"><a href="../../d3/d55/classPktModule.html#a135bd5f128027bdc1a13578b30af85cc">PktModule::packet_buffer_manager</a></div><div class="ttdeci">PacketBufferManager * packet_buffer_manager() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db3/pkt__init_8h_source.html#l00033">pkt_init.h:33</a></div></div>
<div class="ttc" id="ecmp__load__balance_8h_html"><div class="ttname"><a href="../../d4/d7d/ecmp__load__balance_8h.html">ecmp_load_balance.h</a></div></div>
<div class="ttc" id="structPktInfo_html_af19bde2a39741c02653d9e6c7f4d43af"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#af19bde2a39741c02653d9e6c7f4d43af">PktInfo::tcp</a></div><div class="ttdeci">struct tcphdr * tcp</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00426">pkt_handler.h:426</a></div></div>
<div class="ttc" id="classInterface_html_a01562cbfcb9c8793a7117b67ee0ce079a726374ecb3fd1af3633980e6fe2d24eb"><div class="ttname"><a href="../../d0/dcc/classInterface.html#a01562cbfcb9c8793a7117b67ee0ce079a726374ecb3fd1af3633980e6fe2d24eb">Interface::PHYSICAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/interface_8h_source.html#l00029">interface.h:29</a></div></div>
<div class="ttc" id="classPktHandler_html_a770ff0595b2a1eb752f5f54aad85ed26a511c55b798be91247fc718d88aee9be2"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a511c55b798be91247fc718d88aee9be2">PktHandler::ICMP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00238">pkt_handler.h:238</a></div></div>
<div class="ttc" id="classVmInterface_html_afb8d38d7515d09435980c6307b316a56"><div class="ttname"><a href="../../d5/d21/classVmInterface.html#afb8d38d7515d09435980c6307b316a56">VmInterface::vmi_type</a></div><div class="ttdeci">VmInterface::VmiType vmi_type() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d62/vm__interface_8h_source.html#l01279">vm_interface.h:1279</a></div></div>
<div class="ttc" id="interface__common_8h_html"><div class="ttname"><a href="../../d3/d31/interface__common_8h.html">interface_common.h</a></div></div>
<div class="ttc" id="structPktInfo_html_a15c8da40fb20b302d0ed43143d45c4e1"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a15c8da40fb20b302d0ed43143d45c4e1">PktInfo::ip6</a></div><div class="ttdeci">struct ip6_hdr * ip6</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00424">pkt_handler.h:424</a></div></div>
<div class="ttc" id="structVxlanHdr_html"><div class="ttname"><a href="../../d9/d3c/structVxlanHdr.html">VxlanHdr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00086">pkt_handler.h:86</a></div></div>
<div class="ttc" id="vrf_8h_html"><div class="ttname"><a href="../../da/d21/vrf_8h.html">vrf.h</a></div></div>
<div class="ttc" id="classPktHandler_html_a73014833ee8846ee22a06178f98a004a"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a73014833ee8846ee22a06178f98a004a">PktHandler::CalculatePortIP</a></div><div class="ttdeci">void CalculatePortIP(PktInfo *pkt_info)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00104">pkt_handler.cc:104</a></div></div>
<div class="ttc" id="classVmInterface_html_a9c0028149535fe16b78d112aee99eeb4"><div class="ttname"><a href="../../d5/d21/classVmInterface.html#a9c0028149535fe16b78d112aee99eeb4">VmInterface::primary_ip6_addr</a></div><div class="ttdeci">const Ip6Address &amp; primary_ip6_addr() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d62/vm__interface_8h_source.html#l01270">vm_interface.h:1270</a></div></div>
<div class="ttc" id="classMplsLabel_html"><div class="ttname"><a href="../../df/de8/classMplsLabel.html">MplsLabel</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d9a/mpls_8h_source.html#l00052">mpls.h:52</a></div></div>
<div class="ttc" id="structPktInfo_html_a508f458d815ed43a04a0b3c6601ab3ba"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a508f458d815ed43a04a0b3c6601ab3ba">PktInfo::icmp</a></div><div class="ttdeci">struct icmp * icmp</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00428">pkt_handler.h:428</a></div></div>
<div class="ttc" id="structPktInfo_html_a8e6f2f0c80abcd030b2ecb4aef49abc2"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a8e6f2f0c80abcd030b2ecb4aef49abc2">PktInfo::is_segment_hc_pkt</a></div><div class="ttdeci">bool is_segment_hc_pkt</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00411">pkt_handler.h:411</a></div></div>
<div class="ttc" id="classPktHandler_html_a770ff0595b2a1eb752f5f54aad85ed26a62b35a24c63c7f5531b5d57fe591270b"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a62b35a24c63c7f5531b5d57fe591270b">PktHandler::DNS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00237">pkt_handler.h:237</a></div></div>
<div class="ttc" id="structPktInfo_html_a6ef73e7d009958107f73525b87729648"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a6ef73e7d009958107f73525b87729648">PktInfo::same_port_number</a></div><div class="ttdeci">bool same_port_number</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00413">pkt_handler.h:413</a></div></div>
<div class="ttc" id="classPacketBufferManager_html_a5022c34278d3c2e42153011c70120324"><div class="ttname"><a href="../../d0/dd9/classPacketBufferManager.html#a5022c34278d3c2e42153011c70120324">PacketBufferManager::Allocate</a></div><div class="ttdeci">PacketBufferPtr Allocate(uint32_t module, uint16_t len, uint32_t mdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dce/packet__buffer_8cc_source.html#l00016">packet_buffer.cc:16</a></div></div>
<div class="ttc" id="classVrfNH_html"><div class="ttname"><a href="../../d8/da7/classVrfNH.html">VrfNH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01426">nexthop.h:1426</a></div></div>
<div class="ttc" id="classControlInterface_html_a651a304463ac9b3849a3d75f96a9050b"><div class="ttname"><a href="../../dc/d1d/classControlInterface.html#a651a304463ac9b3849a3d75f96a9050b">ControlInterface::EncapsulationLength</a></div><div class="ttdeci">virtual uint32_t EncapsulationLength() const =0</div></div>
<div class="ttc" id="structPktType_html_a6d97cb2f45ba72589c8defcf6b9ccadbae0ec25db0749724ab1fc3c6fd8d2ca03"><div class="ttname"><a href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadbae0ec25db0749724ab1fc3c6fd8d2ca03">PktType::TCP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00101">pkt_handler.h:101</a></div></div>
<div class="ttc" id="structPktType_html_a6d97cb2f45ba72589c8defcf6b9ccadba67f7170c8356b1d25e9690f3d0b8358d"><div class="ttname"><a href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba67f7170c8356b1d25e9690f3d0b8358d">PktType::NON_IP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00104">pkt_handler.h:104</a></div></div>
<div class="ttc" id="classMplsLabel_html_a5adca64ae757f9d442b01aab4361fc80"><div class="ttname"><a href="../../df/de8/classMplsLabel.html#a5adca64ae757f9d442b01aab4361fc80">MplsLabel::IsFabricMulticastReservedLabel</a></div><div class="ttdeci">bool IsFabricMulticastReservedLabel() const </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc2/mpls_8cc_source.html#l00135">mpls.cc:135</a></div></div>
<div class="ttc" id="classInterfaceTable_html_a3460257f9b0fa13a0f7104f38d835aa3"><div class="ttname"><a href="../../d2/d73/classInterfaceTable.html#a3460257f9b0fa13a0f7104f38d835aa3">InterfaceTable::FindInterface</a></div><div class="ttdeci">const Interface * FindInterface(size_t index) const </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d7a/interface_8cc_source.html#l00323">interface.cc:323</a></div></div>
<div class="ttc" id="structPktInfo_html_a7437bca732f78c630caf19f2fefb49e6"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a7437bca732f78c630caf19f2fefb49e6">PktInfo::smac</a></div><div class="ttdeci">MacAddress smac</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00392">pkt_handler.h:392</a></div></div>
<div class="ttc" id="logging_8h_html_afa4d5ba62ca08799d69d54104884902a"><div class="ttname"><a href="../../d5/d77/logging_8h.html#afa4d5ba62ca08799d69d54104884902a">LOG</a></div><div class="ttdeci">#define LOG(_Level, _Msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d77/logging_8h_source.html#l00033">logging.h:33</a></div></div>
<div class="ttc" id="structAgentHdr_html"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html">AgentHdr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00127">pkt_handler.h:127</a></div></div>
<div class="ttc" id="structPktInfo_html_a1d124629460052de977cc0496d5b2a1b"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a1d124629460052de977cc0496d5b2a1b">PktInfo::i_sid</a></div><div class="ttdeci">uint32_t i_sid</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00404">pkt_handler.h:404</a></div></div>
<div class="ttc" id="structPktInfo_html_ab7721d4dc87bf0d887397b2810a0d083"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#ab7721d4dc87bf0d887397b2810a0d083">PktInfo::igmp</a></div><div class="ttdeci">struct igmp * igmp</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00431">pkt_handler.h:431</a></div></div>
<div class="ttc" id="packet__buffer_8h_html"><div class="ttname"><a href="../../d4/dc5/packet__buffer_8h.html">packet_buffer.h</a></div></div>
<div class="ttc" id="classPktHandler_html_a3e3d144bdc73a0953eeade164fbb465b"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a3e3d144bdc73a0953eeade164fbb465b">PktHandler::ParseBfdDataPacket</a></div><div class="ttdeci">PktModuleName ParseBfdDataPacket(const AgentHdr &amp;hdr, PktInfo *pkt_info, uint8_t *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00245">pkt_handler.cc:245</a></div></div>
<div class="ttc" id="structPktInfo_html_ac3a8d8745e7c386d2c61593ce1c430f2"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#ac3a8d8745e7c386d2c61593ce1c430f2">PktInfo::b_dmac</a></div><div class="ttdeci">MacAddress b_dmac</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00403">pkt_handler.h:403</a></div></div>
<div class="ttc" id="classVrfNH_html_a7a5ca1f35f8e5ff1c7b8af2eb3fe00fc"><div class="ttname"><a href="../../d8/da7/classVrfNH.html#a7a5ca1f35f8e5ff1c7b8af2eb3fe00fc">VrfNH::layer2_control_word</a></div><div class="ttdeci">bool layer2_control_word() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01461">nexthop.h:1461</a></div></div>
<div class="ttc" id="classVmInterface_html_ac3633d62916d00d278461a5498006d7c"><div class="ttname"><a href="../../d5/d21/classVmInterface.html#ac3633d62916d00d278461a5498006d7c">VmInterface::IsFatFlowPrefixAggregation</a></div><div class="ttdeci">bool IsFatFlowPrefixAggregation(bool ingress, uint8_t protocol, uint16_t *sport, uint16_t *dport, bool *same_port_num, IpAddress *SrcIP, IpAddress *DstIP, bool *is_src_prefix, bool *is_dst_prefix, FatFlowIgnoreAddressType *ignore_addr) const </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d10/vm__interface__utils_8cc_source.html#l01223">vm_interface_utils.cc:1223</a></div></div>
<div class="ttc" id="structPktHandler_1_1PktStats_html_a82bf97de645ed9bafd501dbd734ce462"><div class="ttname"><a href="../../dd/d88/structPktHandler_1_1PktStats.html#a82bf97de645ed9bafd501dbd734ce462">PktHandler::PktStats::PktQThresholdExceeded</a></div><div class="ttdeci">void PktQThresholdExceeded(PktModuleName mod)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01331">pkt_handler.cc:1331</a></div></div>
<div class="ttc" id="structAgentHdr_html_aee9a9c979ed73097cea9e1762eb8c8a3ae817adc4b2f152f1b666c8ca6c3451a9"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3ae817adc4b2f152f1b666c8ca6c3451a9">AgentHdr::TRAP_HANDLE_DF</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00142">pkt_handler.h:142</a></div></div>
<div class="ttc" id="classPktHandler_html_a5e114cd19dfa6c18ad7ac81818277033"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a5e114cd19dfa6c18ad7ac81818277033">PktHandler::bfd_keepalive_proto_</a></div><div class="ttdeci">Proto * bfd_keepalive_proto_</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00363">pkt_handler.h:363</a></div></div>
<div class="ttc" id="classVmInterface_html_ad9a0aaf675e2fcbdc6e80c3219d1ae2d"><div class="ttname"><a href="../../d5/d21/classVmInterface.html#ad9a0aaf675e2fcbdc6e80c3219d1ae2d">VmInterface::IsFatFlowPortBased</a></div><div class="ttdeci">bool IsFatFlowPortBased(uint8_t protocol, uint16_t port, FatFlowIgnoreAddressType *ignore_addr) const </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d10/vm__interface__utils_8cc_source.html#l00809">vm_interface_utils.cc:809</a></div></div>
<div class="ttc" id="classPktHandler_html_aad1c6cf849c57ec2e075359a4a3c4e38"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#aad1c6cf849c57ec2e075359a4a3c4e38">PktHandler::proto_list_</a></div><div class="ttdeci">boost::array&lt; Proto *, MAX_MODULES &gt; proto_list_</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00362">pkt_handler.h:362</a></div></div>
<div class="ttc" id="structPktInfo_html_a3ab06f5a5929302e21be828a77d871b2"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a3ab06f5a5929302e21be828a77d871b2">PktInfo::ip_daddr</a></div><div class="ttdeci">IpAddress ip_daddr</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00395">pkt_handler.h:395</a></div></div>
<div class="ttc" id="agent__cmn_8h_html"><div class="ttname"><a href="../../de/d18/agent__cmn_8h.html">agent_cmn.h</a></div></div>
<div class="ttc" id="structAgentHdr_html_a34bbc005d14e0b0f17e6d146569fbe23"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#a34bbc005d14e0b0f17e6d146569fbe23">AgentHdr::cmd_param</a></div><div class="ttdeci">uint32_t cmd_param</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00183">pkt_handler.h:183</a></div></div>
<div class="ttc" id="classPktHandler_html_a770ff0595b2a1eb752f5f54aad85ed26"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26">PktHandler::PktModuleName</a></div><div class="ttdeci">PktModuleName</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00231">pkt_handler.h:231</a></div></div>
<div class="ttc" id="classAgentStats_html_a704d954054be10ccea3cf69339e7199e"><div class="ttname"><a href="../../d0/d98/classAgentStats.html#a704d954054be10ccea3cf69339e7199e">AgentStats::incr_pkt_drop_due_to_invalid_ethertype</a></div><div class="ttdeci">void incr_pkt_drop_due_to_invalid_ethertype()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d16/agent__stats_8h_source.html#l00158">agent_stats.h:158</a></div></div>
<div class="ttc" id="structPktTrace_1_1Pkt_html_a2353685a5c5004102912d441f0dbe37b"><div class="ttname"><a href="../../df/d48/structPktTrace_1_1Pkt.html#a2353685a5c5004102912d441f0dbe37b">PktTrace::Pkt::pkt</a></div><div class="ttdeci">uint8_t pkt[kPktMaxTraceSize]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d22/pkt__trace_8h_source.html#l00027">pkt_trace.h:27</a></div></div>
<div class="ttc" id="structPktInfo_html_ae13dec3f61d467745911c973103ace0c"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#ae13dec3f61d467745911c973103ace0c">PktInfo::agent_hdr</a></div><div class="ttdeci">AgentHdr agent_hdr</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00388">pkt_handler.h:388</a></div></div>
<div class="ttc" id="classPktTrace_html_ad02cd98a2a9331a8e207bb0d8b4ca01c"><div class="ttname"><a href="../../db/d26/classPktTrace.html#ad02cd98a2a9331a8e207bb0d8b4ca01c">PktTrace::end_</a></div><div class="ttdeci">uint32_t end_</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d22/pkt__trace_8h_source.html#l00077">pkt_trace.h:77</a></div></div>
<div class="ttc" id="classPktHandler_html_aa56e12e1b77b0cfb23304cf9e261091b"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#aa56e12e1b77b0cfb23304cf9e261091b">PktHandler::pkt_trace_</a></div><div class="ttdeci">boost::array&lt; PktTrace, MAX_MODULES &gt; pkt_trace_</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00366">pkt_handler.h:366</a></div></div>
<div class="ttc" id="structAgentHdr_html_aa4e2f8f1cec68832a3ff50c0d61681dd"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#aa4e2f8f1cec68832a3ff50c0d61681dd">AgentHdr::cmd</a></div><div class="ttdeci">uint16_t cmd</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00182">pkt_handler.h:182</a></div></div>
<div class="ttc" id="structPktInfo_html_a4995336bef3636c36eb26b316a4909d2"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a4995336bef3636c36eb26b316a4909d2">PktInfo::is_fat_flow_dst_prefix</a></div><div class="ttdeci">bool is_fat_flow_dst_prefix</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00416">pkt_handler.h:416</a></div></div>
<div class="ttc" id="classPktHandler_html_afb079cbeb881272cb3295d033776d969"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#afb079cbeb881272cb3295d033776d969">PktHandler::EncapHeaderLen</a></div><div class="ttdeci">uint32_t EncapHeaderLen() const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00089">pkt_handler.cc:89</a></div></div>
<div class="ttc" id="classCompositeNH_html_abd357768641b8c1d31e53017135448a6"><div class="ttname"><a href="../../dd/d76/classCompositeNH.html#abd357768641b8c1d31e53017135448a6">CompositeNH::end</a></div><div class="ttdeci">ComponentNHList::const_iterator end() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01811">nexthop.h:1811</a></div></div>
<div class="ttc" id="classPktHandler_html_a0ea013a9befa042f10c1d15c7b3d1dac"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a0ea013a9befa042f10c1d15c7b3d1dac">PktHandler::ParseControlWord</a></div><div class="ttdeci">int ParseControlWord(PktInfo *pkt_info, uint8_t *pkt, const MplsLabel *mpls)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00736">pkt_handler.cc:736</a></div></div>
<div class="ttc" id="structPktInfo_html_ae650c255df1c2a49dedb2f52879c8225"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#ae650c255df1c2a49dedb2f52879c8225">PktInfo::ignore_address</a></div><div class="ttdeci">VmInterface::FatFlowIgnoreAddressType ignore_address</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00412">pkt_handler.h:412</a></div></div>
<div class="ttc" id="classAgent_html_a336b21bbbce890ea37d6e47abaac3900"><div class="ttname"><a href="../../d8/dfe/classAgent.html#a336b21bbbce890ea37d6e47abaac3900">Agent::pkt</a></div><div class="ttdeci">PktModule * pkt() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0e/agent_8cc_source.html#l00964">agent.cc:964</a></div></div>
<div class="ttc" id="classPktHandler_html_a39c8eb9481f19738c0a5ef2e1124ab7d"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a39c8eb9481f19738c0a5ef2e1124ab7d">PktHandler::PktModuleEnqueue</a></div><div class="ttdeci">void PktModuleEnqueue(PktModuleName mod, const AgentHdr &amp;hdr, boost::shared_ptr&lt; PktInfo &gt; pkt_info, uint8_t *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00472">pkt_handler.cc:472</a></div></div>
<div class="ttc" id="classPktHandler_html_a6e58aed3cda30f9f586c2e4e89007f67"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a6e58aed3cda30f9f586c2e4e89007f67">PktHandler::work_queue_bfd_ka_</a></div><div class="ttdeci">PktHandlerQueue work_queue_bfd_ka_</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00372">pkt_handler.h:372</a></div></div>
<div class="ttc" id="classPktHandler_html_a770ff0595b2a1eb752f5f54aad85ed26a5457c47d7cbee5842a46e62c3cd3257d"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a770ff0595b2a1eb752f5f54aad85ed26a5457c47d7cbee5842a46e62c3cd3257d">PktHandler::FLOW</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00233">pkt_handler.h:233</a></div></div>
<div class="ttc" id="structsctphdr_html_a601201aa4b3bc795d1942484329deeb4"><div class="ttname"><a href="../../d3/d75/structsctphdr.html#a601201aa4b3bc795d1942484329deeb4">sctphdr::th_dport</a></div><div class="ttdeci">u_int16_t th_dport</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00123">pkt_handler.h:123</a></div></div>
<div class="ttc" id="classEcmpLoadBalance_html_a49bdff606ffcbc4a5a25cdf3da71a9a9"><div class="ttname"><a href="../../d1/db0/classEcmpLoadBalance.html#a49bdff606ffcbc4a5a25cdf3da71a9a9">EcmpLoadBalance::is_destination_port_set</a></div><div class="ttdeci">bool is_destination_port_set() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d7d/ecmp__load__balance_8h_source.html#l00149">ecmp_load_balance.h:149</a></div></div>
<div class="ttc" id="classPktHandler_html_af73c2241648fa8fe1c226780b2b938e1"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#af73c2241648fa8fe1c226780b2b938e1">PktHandler::ComputeForwardingMode</a></div><div class="ttdeci">bool ComputeForwardingMode(PktInfo *pkt_info, const Interface *intf) const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00490">pkt_handler.cc:490</a></div></div>
<div class="ttc" id="classVlanNH_html_a2a84f33c5405388b8862da7497fb42d4"><div class="ttname"><a href="../../d0/d47/classVlanNH.html#a2a84f33c5405388b8862da7497fb42d4">VlanNH::GetInterface</a></div><div class="ttdeci">const Interface * GetInterface() const </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01543">nexthop.h:1543</a></div></div>
<div class="ttc" id="pkt__handler_8h_html_aa512a5683e8e1e95ed9a4be2249186bb"><div class="ttname"><a href="../../d3/d79/pkt__handler_8h.html#aa512a5683e8e1e95ed9a4be2249186bb">PBB_HEADER_LEN</a></div><div class="ttdeci">#define PBB_HEADER_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00055">pkt_handler.h:55</a></div></div>
<div class="ttc" id="classWorkQueue_html_a1cd8582cc7cdc534693e9278b27b5f41"><div class="ttname"><a href="../../d4/d0c/classWorkQueue.html#a1cd8582cc7cdc534693e9278b27b5f41">WorkQueue::Enqueue</a></div><div class="ttdeci">bool Enqueue(QueueEntryT entry)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d47/queue__task_8h_source.html#l00248">queue_task.h:248</a></div></div>
<div class="ttc" id="structPktTrace_1_1Pkt_html_a7880fe4fe129cc6e28baee206b10ce3c"><div class="ttname"><a href="../../df/d48/structPktTrace_1_1Pkt.html#a7880fe4fe129cc6e28baee206b10ce3c">PktTrace::Pkt::Copy</a></div><div class="ttdeci">void Copy(Direction d, std::size_t l, uint8_t *msg, std::size_t pkt_trace_size, const AgentHdr *hdr)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01521">pkt_handler.cc:1521</a></div></div>
<div class="ttc" id="structPktInfo_html_a0721c1c52ab92da5aa5d7fee4a42d324"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a0721c1c52ab92da5aa5d7fee4a42d324">PktInfo::hash</a></div><div class="ttdeci">std::size_t hash(const Agent *agent, const EcmpLoadBalance &amp;ecmp_has_fields_to_use) const </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01430">pkt_handler.cc:1430</a></div></div>
<div class="ttc" id="structPktInfo_html_a67e30904a9eab1f8993ba3f21bbc5e2e"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#a67e30904a9eab1f8993ba3f21bbc5e2e">PktInfo::icmp_chksum</a></div><div class="ttdeci">uint16_t icmp_chksum</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00400">pkt_handler.h:400</a></div></div>
<div class="ttc" id="structTunnelInfo_html_a372ba294c7924934c0aca4f2a853b0c2"><div class="ttname"><a href="../../d6/d6b/structTunnelInfo.html#a372ba294c7924934c0aca4f2a853b0c2">TunnelInfo::vxlan_id</a></div><div class="ttdeci">uint32_t vxlan_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00213">pkt_handler.h:213</a></div></div>
<div class="ttc" id="classPktHandler_html_af01d4924dbbcf7d0724635ca73e70067"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#af01d4924dbbcf7d0724635ca73e70067">PktHandler::IsFlowPacket</a></div><div class="ttdeci">bool IsFlowPacket(PktInfo *pkt_info)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l01237">pkt_handler.cc:1237</a></div></div>
<div class="ttc" id="pkt__handler_8h_html_a15188cd7f29c35c41850193420f4e537"><div class="ttname"><a href="../../d3/d79/pkt__handler_8h.html#a15188cd7f29c35c41850193420f4e537">MPLS_OVER_UDP_DEST_PORT</a></div><div class="ttdeci">#define MPLS_OVER_UDP_DEST_PORT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00038">pkt_handler.h:38</a></div></div>
<div class="ttc" id="structAgentHdr_html_aee9a9c979ed73097cea9e1762eb8c8a3a555c07bba387daa53b40e095c25d2e07"><div class="ttname"><a href="../../d6/d0d/structAgentHdr.html#aee9a9c979ed73097cea9e1762eb8c8a3a555c07bba387daa53b40e095c25d2e07">AgentHdr::TRAP_ROUTER_ALERT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00147">pkt_handler.h:147</a></div></div>
<div class="ttc" id="classPktHandler_html_a0c24b408a4140d63bbb25f2b10b06c64"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a0c24b408a4140d63bbb25f2b10b06c64">PktHandler::ParseUDPTunnels</a></div><div class="ttdeci">int ParseUDPTunnels(PktInfo *pkt_info, uint8_t *pkt)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00892">pkt_handler.cc:892</a></div></div>
<div class="ttc" id="structPktType_html_a6d97cb2f45ba72589c8defcf6b9ccadb"><div class="ttname"><a href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadb">PktType::Type</a></div><div class="ttdeci">Type</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00096">pkt_handler.h:96</a></div></div>
<div class="ttc" id="structAgentDiagPktData_html"><div class="ttname"><a href="../../dd/da9/structAgentDiagPktData.html">AgentDiagPktData</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dd2/diag_8h_source.html#l00073">diag.h:73</a></div></div>
<div class="ttc" id="globals_8h_html_af8f69ad2e0771a513d2eb7d5198b2a8caef2863a469df3ea6871d640e3669a2f2"><div class="ttname"><a href="../../d5/d87/globals_8h.html#af8f69ad2e0771a513d2eb7d5198b2a8caef2863a469df3ea6871d640e3669a2f2">INVALID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d87/globals_8h_source.html#l00147">globals.h:147</a></div></div>
<div class="ttc" id="classWorkQueue_html_adfdf14c9aec59ed072c3e6447d0d1253"><div class="ttname"><a href="../../d4/d0c/classWorkQueue.html#adfdf14c9aec59ed072c3e6447d0d1253">WorkQueue::set_name</a></div><div class="ttdeci">void set_name(const std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d47/queue__task_8h_source.html#l00307">queue_task.h:307</a></div></div>
<div class="ttc" id="classEcmpLoadBalance_html_ac2aab623349620e810a5ed75180b8a6a"><div class="ttname"><a href="../../d1/db0/classEcmpLoadBalance.html#ac2aab623349620e810a5ed75180b8a6a">EcmpLoadBalance::is_ip_protocol_set</a></div><div class="ttdeci">bool is_ip_protocol_set() const </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d7d/ecmp__load__balance_8h_source.html#l00152">ecmp_load_balance.h:152</a></div></div>
<div class="ttc" id="classPktHandler_html_a980ef2a9eb9a7b57757c84127a512d84"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a980ef2a9eb9a7b57757c84127a512d84">PktHandler::HandleRcvPkt</a></div><div class="ttdeci">void HandleRcvPkt(const AgentHdr &amp;hdr, const PacketBufferPtr &amp;buff)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00411">pkt_handler.cc:411</a></div></div>
<div class="ttc" id="pkt__handler_8h_html_a23dd788b1cd28a0d834c3afefceaa1c1"><div class="ttname"><a href="../../d3/d79/pkt__handler_8h.html#a23dd788b1cd28a0d834c3afefceaa1c1">DHCP_CLIENT_PORT</a></div><div class="ttdeci">#define DHCP_CLIENT_PORT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00030">pkt_handler.h:30</a></div></div>
<div class="ttc" id="classInterface_html_a01562cbfcb9c8793a7117b67ee0ce079a237f863154018d4c85568c225fa4a826"><div class="ttname"><a href="../../d0/dcc/classInterface.html#a01562cbfcb9c8793a7117b67ee0ce079a237f863154018d4c85568c225fa4a826">Interface::VM_INTERFACE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da9/interface_8h_source.html#l00035">interface.h:35</a></div></div>
<div class="ttc" id="classPktHandler_html_a8a1c95720fadfccc29c159b1a4550c39"><div class="ttname"><a href="../../d5/d94/classPktHandler.html#a8a1c95720fadfccc29c159b1a4550c39">PktHandler::ParseIpPacket</a></div><div class="ttdeci">int ParseIpPacket(PktInfo *pkt_info, PktType::Type &amp;pkt_type, uint8_t *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d76/pkt__handler_8cc_source.html#l00555">pkt_handler.cc:555</a></div></div>
<div class="ttc" id="controller_2src_2vnsw_2agent_2pkt_2proto_8h_html"><div class="ttname"><a href="../../d3/d2c/controller_2src_2vnsw_2agent_2pkt_2proto_8h.html">proto.h</a></div></div>
<div class="ttc" id="classVlanNH_html"><div class="ttname"><a href="../../d0/d47/classVlanNH.html">VlanNH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3f/nexthop_8h_source.html#l01527">nexthop.h:1527</a></div></div>
<div class="ttc" id="structTunnelInfo_html_a50c5f3b118ce5fbb8d3e3b672f598ca2"><div class="ttname"><a href="../../d6/d6b/structTunnelInfo.html#a50c5f3b118ce5fbb8d3e3b672f598ca2">TunnelInfo::ip</a></div><div class="ttdeci">struct ip * ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00218">pkt_handler.h:218</a></div></div>
<div class="ttc" id="structPktInfo_html_af8480949e8af30643e3af752fab18eca"><div class="ttname"><a href="../../d5/da8/structPktInfo.html#af8480949e8af30643e3af752fab18eca">PktInfo::sctp</a></div><div class="ttdeci">struct sctphdr * sctp</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00430">pkt_handler.h:430</a></div></div>
<div class="ttc" id="structPktHandler_1_1PktStats_html_a7b5c5c553004d747d8cea587b277b1ea"><div class="ttname"><a href="../../dd/d88/structPktHandler_1_1PktStats.html#a7b5c5c553004d747d8cea587b277b1ea">PktHandler::PktStats::received</a></div><div class="ttdeci">uint32_t received[MAX_MODULES]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00253">pkt_handler.h:253</a></div></div>
<div class="ttc" id="pkt__handler_8h_html_a6802d48c8c3b96baafb23641a82f43a0"><div class="ttname"><a href="../../d3/d79/pkt__handler_8h.html#a6802d48c8c3b96baafb23641a82f43a0">DHCPV6_CLIENT_PORT</a></div><div class="ttdeci">#define DHCPV6_CLIENT_PORT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00032">pkt_handler.h:32</a></div></div>
<div class="ttc" id="structPktType_html_a6d97cb2f45ba72589c8defcf6b9ccadba34d39d0c108081973a0f030402858fb3"><div class="ttname"><a href="../../d8/d9c/structPktType.html#a6d97cb2f45ba72589c8defcf6b9ccadba34d39d0c108081973a0f030402858fb3">PktType::IP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d79/pkt__handler_8h_source.html#l00099">pkt_handler.h:99</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_0a7d39584c34dc4772b798c7b583750f.html">contrail</a></li><li class="navelem"><a class="el" href="../../dir_2a1a0f5bd3fae8c3e47f1701b5222318.html">controller</a></li><li class="navelem"><a class="el" href="../../dir_c5f44869b24dae5488ef95224fa0de41.html">src</a></li><li class="navelem"><a class="el" href="../../dir_e4311bf3a78fbdfcf1e54aa904787447.html">vnsw</a></li><li class="navelem"><a class="el" href="../../dir_1aebb61e8a90561fae5595a02a089af4.html">agent</a></li><li class="navelem"><a class="el" href="../../dir_c60d18eb4d4275d1151fd117067234b4.html">pkt</a></li><li class="navelem"><a class="el" href="../../df/d76/pkt__handler_8cc.html">pkt_handler.cc</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
